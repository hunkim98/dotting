import { Meta } from "@storybook/addon-docs";
import Code from "./assets/code-brackets.svg";
import Colors from "./assets/colors.svg";
import Comments from "./assets/comments.svg";
import Direction from "./assets/direction.svg";
import Flow from "./assets/flow.svg";
import Plugin from "./assets/plugin.svg";
import Repo from "./assets/repo.svg";
import StackAlt from "./assets/stackalt.svg";
import Dotting from "../src/components/Dotting";
import {
  Clear,
  ColorPixels,
  DownloadImage,
  SetIndicatorPixels,
  UndoRedo,
  SetData,
  GridChange,
  SetLayers,
} from "./useDottingComponents";

<Meta title="Hooks/useDotting" />

<style>
  {`
  .subheading {
    --mediumdark: '#999999';
    font-weight: 900;
    font-size: 13px;
    color: #999;
    letter-spacing: 6px;
    line-height: 24px;
    text-transform: uppercase;
    margin-bottom: 12px;
    margin-top: 40px;
    font-family: 'Nunito Sans', 'Helvetica Neue', Helvetica, Arial, sans-serif;
  }

  .link-list {
    display: grid;
    grid-template-columns: 1fr;
    grid-template-rows: 1fr 1fr;
    row-gap: 10px;
  }

  @media (min-width: 620px) {
    .link-list {
      row-gap: 20px;
      column-gap: 20px;
      grid-template-columns: 1fr 1fr;
    }
  }

  @media all and (-ms-high-contrast:none) {
  .link-list {
      display: -ms-grid;
      -ms-grid-columns: 1fr 1fr;
      -ms-grid-rows: 1fr 1fr;
    }
  }

  .link-item {
    display: block;
    padding: 20px 30px 20px 15px;
    border: 1px solid #00000010;
    border-radius: 5px;
    transition: background 150ms ease-out, border 150ms ease-out, transform 150ms ease-out;
    color: #333333;
    display: flex;
    align-items: flex-start;
  }

  .link-item:hover {
    border-color: #1EA7FD50;
    transform: translate3d(0, -3px, 0);
    box-shadow: rgba(0, 0, 0, 0.08) 0 3px 10px 0;
  }

  .link-item:active {
    border-color: #1EA7FD;
    transform: translate3d(0, 0, 0);
  }

  .link-item strong {
    font-weight: 700;
    display: block;
    margin-bottom: 2px;
  }
  
  .link-item img {
    height: 40px;
    width: 40px;
    margin-right: 15px;
    flex: none;
  }

  .link-item span {
    font-size: 14px;
    line-height: 20px;
  }

  .tip {
    display: inline-block;
    border-radius: 1em;
    font-size: 11px;
    line-height: 12px;
    font-weight: 700;
    background: #E7FDD8;
    color: #66BF3C;
    padding: 4px 12px;
    margin-right: 10px;
    vertical-align: top;
  }

  .tip-wrapper {
    font-size: 13px;
    line-height: 20px;
    margin-top: 40px;
    margin-bottom: 40px;
  }

  .tip-wrapper code {
    font-size: 12px;
    display: inline-block;
  }
  
table {
  width: 100%;
  border-collapse: collapse;
  border: 1px solid #cccccc;
  margin: 15px auto;
  margin-bottom: 80px;
  background: white;
  color: #333333;
  font-family: "Nunito Sans",-apple-system,".SFNSText-Regular","San Francisco",BlinkMacSystemFont,"Segoe UI","Helvetica Neue",Helvetica,Arial,sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
}

thead {
  border-bottom: 1px solid #cccccc;
}

table .css-1p8ieni {
  margin: 0;
}

h4 {
  margin-top: 15px;
}

th {
  background: steelblue;
  height: 54px;
  width: 25%;
  font-weight: lighter;
  text-shadow: 0 1px 0 #38678f;
  color: white;
  border: 1px solid black;
  box-shadow: inset 0px 1px 2px #cccccc;
  transition: all 0.2s;
}
tr {
  border-bottom: 1px solid #cccccc;
}
tr:last-child {
  border-bottom: 0px;
}
td {
  border-right: 1px solid #cccccc;
  padding: 10px;
  transition: all 0.2s;
  font-size: 14px;
}
td:first-child {
  font-size: 12px;
  font-family: monospace

}
td:last-child {
  border-right: 0px;
}
td.selected {
  background: #d7e4ef;
  z-index: ;
}
td input {
  font-size: 14px;
  background: none;
  outline: none;
  border: 0;
  display: table-cell;
  height: 100%;
  width: 100%;
}
td input:focus {
  box-shadow: 0 1px 0 steelblue;
  color: steelblue;
}
::-moz-selection {
  background: steelblue;
  color: white;
}
::selection {
  background: steelblue;
  color: white;
}
`}
</style>

# `useDotting`

With `useDotting`, you can manipulate the `Dotting` canvas directly.
You can color pixels, change grid size, set data, and so on.

#### Callbacks provided by `useDotting`

<table>
  <thead>
    <tr>
      <td></td>
      <td>
        <strong>Description</strong>
      </td>
      <td>
        <strong>Parameters</strong>
      </td>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>`downloadImage`</td>
      <td>Allows you to download the pixel image</td>
      <td>
        `ImageDownloadOptions` For more information about the parameters, please refer to
        <u onClick={() => {
          const el = document.getElementById("section1");
          if (el) {
            el.scrollIntoView({ behavior: "smooth" });
          }
        }} style={{cursor: "pointer"}}>section 1</u>.
      </td>
    </tr>
    <tr>
      <td>`clear`</td>
      <td>Allows you to clear the canvas</td>
      <td></td>
    </tr>
    <tr>
      <td>`colorPixels`</td>
      <td>
        Allows you to color pixels on specific indices. If the index provided is 
        not in the grid, the grid first extends its grid and then colors it
      </td>
      <td>
        `Array<PixelModifyItem>`. For more information about the type, please refer to 
        <u onClick={() => {
          const el = document.getElementById("section2");
          if (el) {
            el.scrollIntoView({ behavior: "smooth" });
          }
        }} style={{cursor: "pointer"}}>section 2</u>.
      </td>
    </tr>
    <tr>
      <td>`erasePixels`</td>
      <td>
        Allows you to erase pixels on specific indices. If the index provided is
        not in the grid, that data is ignored
      </td>
      <td>`Array<{rowIndex: number; columnIndex: number}>`</td>
    </tr>
    <tr>
      <td>`setIndicatorPixels`</td>
      <td>
        Allows you to set the indicator pixels. If the index provided is not in
        the grid, that data is ignored
      </td>
      <td>
        `Array<PixelModifyItem>` For more information about the type, please refer to
        <u onClick={() => {
          const el = document.getElementById("section5");
          if (el) {
            el.scrollIntoView({ behavior: "smooth" });
          }
        }} style={{cursor: "pointer"}}>section 5</u>.
      </td>
    </tr>
    <tr>
      <td>`undo`</td>
      <td>
        Allows you to undo the last action
      </td>
      <td></td>
    </tr>
    <tr>
      <td>`redo`</td>
      <td>
        Allows you to redo the last action
      </td>
      <td></td>
    </tr>
    <tr>
      <td>`setData`</td>
      <td>
        Allows you to set the data of the pixel canvas. (The 2d array should be a square array)
      </td>
      <td>
        `Array<PixelModifyItem>` For more information about the type, please refer to 
        <u onClick={() => {
          const el = document.getElementById("section7");
          if (el) {
            el.scrollIntoView({ behavior: "smooth" });
          }
        }} style={{cursor: "pointer"}}>section 7</u>.
      </td>
    </tr>
    <tr>
      <td>`addGridIndices`</td>
      <td>
        Allows you to add grid indices to the grid.
      </td>
      <td>
        `AddGridIndicesParams`. For more information about the type, please refer to 
        <u onClick={() => {
          const el = document.getElementById("section3");
          if (el) {
            el.scrollIntoView({ behavior: "smooth" });
          }
        }} style={{cursor: "pointer"}}>section 3</u>.
      </td>
    </tr>
    <tr>
      <td>`deleteGridIndices`</td>
      <td>
        Allows you to delete grid indices to the grid.
      </td>
      <td>
        `DeleteGridIndicesParams`. For more information about the type, please refer to
        <u onClick={() => {
          const el = document.getElementById("section3");
          if (el) {
            el.scrollIntoView({ behavior: "smooth" });
          }
        }} style={{cursor: "pointer"}}>section 3</u>.
      </td>
    </tr>
    <tr>
    <td>`setLayers`</td>
      <td>
        Allows you to set layers. You must provide an array of `LayerProps` to this method.
      </td>
      <td>
        `Array<LayerProps>`. For more information about the type, Please refer to
        <u onClick={() => {
          const el = document.getElementById("section8");
          if (el) {
            el.scrollIntoView({ behavior: "smooth" });
          }
        }} style={{cursor: "pointer"}}>section 8</u>.
      </td>
    </tr>

  </tbody>
</table>

### Examples

<div id="section1"></div>
#### 1. Download Image Example `downloadImage`

With `downloadImage(options?: ImageDownloadOptions)` method, you can download the image of the grid. The parameter that you can pass to the callback is `ImageDownloadOptions`.
The `ImageDownloadOptions` type is defined as follows:

```ts
export interface ImageDownloadOptions {
  isGridVisible?: boolean;
}
```

<DownloadImage />

<div id="section2"></div>
#### 2. Change Pixel Color Example `colorPixels`, `erasePixels`

With `colorPixels(data: PixelModifyData)` method, you can change the color of specific pixels.
The `PixelModifyData` type is defined as follows:

```ts
export type PixelModifyData = Array<PixelModifyItem>;

export interface PixelModifyItem {
  rowIndex: number;
  columnIndex: number;
  color: string;
}
```

By passing an array of `PixelModifyItem` you are able to color the pixels.
If the rowIndex and columnIndex of the pixel is not in the grid, the grid
first extends its grid and then colors it.

You can also erase pixels using `erasePixels` method. The `erasePixels(data: Array<{rowIndex: number; columnIndex: number}>)` method
takes an array of `{rowIndex: number; columnIndex: number}` as a parameter. If the rowIndex and
columnIndex of the pixel is not in the grid, that data is ignored.

<ColorPixels />

<div id="section3"></div>
#### 3. Grid Change Example `addGridIndices`,`deleteGridIndices`

With `addGridIndices(params: AddGridIndicesParams)` method, you can add grid indices to the grid.
The `AddGridIndicesParams` type is defined as follows:

```ts
export type AddGridIndicesParams = {
  rowIndices: Array<number>;
  columnIndices: Array<number>;
  data?: Array<PixelModifyItem>;
  layerId?: string;
  isLocalChange?: boolean;
};
```

By passing an array of `rowIndices` and `columnIndices` you are able to add grid indices to the grid.

With `deleteGridIndices(params: DeleteGridIndicesParams)` method, you can delete grid indices to the grid.
The `DeleteGridIndicesParams` type is defined as follows:

```ts
export type DeleteGridIndicesParams = {
  rowIndices: Array<number>;
  columnIndices: Array<number>;
  layerId?: string;
  isLocalChange?: boolean;
};
```

<GridChange />

<div id="section4"></div>
#### 4. Clear Example `clear`

With `clear()` method, you can clear all the pixels in the grid.

<Clear />

<div id="section5"></div>
#### 5. Set Indicator Pixels `setIndicatorPixels`

With `setIndicatorPixels(data: Array<PixelModifyItem>)` method, you can set the indicator pixels. The indicator pixels are
the pixels that are shwon as indicators in the grid. Their opacity is lower than the real pixel data.
They do not affect the data of the grid.

By the way, if you want to initially have the indicator pixels before the canvas mounts,
you need to pass the `initIndicatorData` prop to the `Dotting` component.
The data type of the `initIndicatorData` is the `Array<PixelModifyItem>`.

PixelModifyItem is defined as follows:

```ts
export interface PixelModifyItem {
  rowIndex: number;
  columnIndex: number;
  color: string;
}
```

<SetIndicatorPixels />

<div id="section6"></div>
#### 6. Undo and Redo Example `undo`, `redo`

With `undo()` and `redo()` methods, you can undo and redo the last action.

<UndoRedo />

<div id="section7"></div>
#### 7. SetData Example `setData`

With `setData(data: Array<Array<PixelModifyItem>>)`, you can set the data of the pixel canvas. You must pass a 2d array of `PixelModifyItem` to this method.
The type of `PixelModifyItem` is defined as follows:

```ts
export interface PixelModifyItem {
  rowIndex: number;
  columnIndex: number;
  color: string;
}
```

The 2d array should be a square array.

<SetData />

<div id="section8"></div>
#### 8. SetLayers Example `setLayers`

With `setLayers(data: Array<LayerProps>)`, you can set the layers of the pixel canvas. You must pass an array of `LayerProps` to this method.
The `LayerProps` type is defined as follows:

```ts
export interface LayerProps {
  id: string;
  data: Array<Array<PixelModifyItem>>;
}
```

By passing an array of `LayerProps` you are able to set the layers of the pixel canvas.
The type of `PixelModifyItem` is defined as follows:

```ts
export interface PixelModifyItem {
  rowIndex: number;
  columnIndex: number;
  color: string;
}
```

<SetLayers />

<div className="subheading">Example Source Codes</div>

<div className="link-list">

<a
  className="link-item"
  href="https://github.com/hunkim98/dotting/tree/main/stories/useDottingComponents"
  target="_blank"
>
  <img src={StackAlt} alt="Build" />
  <span>
    <strong>Github Source Code</strong>
    View the source code and contribute to the project!
  </span>
</a>

</div>

<div className="tip-wrapper">
  {/* <span className="tip">Tip</span>Edit the Markdown in{" "}
  <code>src/stories/Introduction.stories.mdx</code> */}
</div>
```
