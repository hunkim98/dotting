(self.webpackChunkdotting=self.webpackChunkdotting||[]).push([[179],{"./.storybook/preview.js-generated-config-entry.js":(__unused_webpack_module,__unused_webpack___webpack_exports__,__webpack_require__)=>{"use strict";var preview_namespaceObject={};__webpack_require__.r(preview_namespaceObject),__webpack_require__.d(preview_namespaceObject,{__namedExportsOrder:()=>__namedExportsOrder,parameters:()=>parameters});__webpack_require__("./node_modules/core-js/modules/es.object.keys.js"),__webpack_require__("./node_modules/core-js/modules/es.symbol.js"),__webpack_require__("./node_modules/core-js/modules/es.array.filter.js"),__webpack_require__("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),__webpack_require__("./node_modules/core-js/modules/es.array.for-each.js"),__webpack_require__("./node_modules/core-js/modules/web.dom-collections.for-each.js"),__webpack_require__("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),__webpack_require__("./node_modules/core-js/modules/es.object.define-properties.js"),__webpack_require__("./node_modules/core-js/modules/es.object.define-property.js");var ClientApi=__webpack_require__("./node_modules/@storybook/client-api/dist/esm/ClientApi.js"),parameters={actions:{argTypesRegex:"^on[A-Z].*"},controls:{matchers:{color:/(background|color)$/i,date:/Date$/}},options:{storySort:{order:["Introduction","Customization","Components","Hooks","Hooks/Setup","Hooks/useDotting"]}}},__namedExportsOrder=["parameters"];function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}Object.keys(preview_namespaceObject).forEach((function(key){var value=preview_namespaceObject[key];switch(key){case"args":return(0,ClientApi.uc)(value);case"argTypes":return(0,ClientApi.v9)(value);case"decorators":return value.forEach((function(decorator){return(0,ClientApi.$9)(decorator,!1)}));case"loaders":return value.forEach((function(loader){return(0,ClientApi.HZ)(loader,!1)}));case"parameters":return(0,ClientApi.h1)(function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}({},value),!1);case"argTypesEnhancers":return value.forEach((function(enhancer){return(0,ClientApi.My)(enhancer)}));case"argsEnhancers":return value.forEach((function(enhancer){return(0,ClientApi._C)(enhancer)}));case"render":return(0,ClientApi.$P)(value);case"globals":case"globalTypes":var v={};return v[key]=value,(0,ClientApi.h1)(v,!1);case"__namedExportsOrder":case"decorateStory":case"renderToDOM":return null;default:return console.log(key+" was not supported :( !")}}))},"./stories/Dotting.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Dotting:()=>Dotting,__namedExportsOrder:()=>__namedExportsOrder,default:()=>Dotting_stories});var objectSpread2=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),react=__webpack_require__("./node_modules/react/index.js");__webpack_require__("./node_modules/core-js/modules/es.object.keys.js"),__webpack_require__("./node_modules/core-js/modules/es.array.filter.js"),__webpack_require__("./node_modules/core-js/modules/es.object.values.js"),__webpack_require__("./node_modules/core-js/modules/es.symbol.js"),__webpack_require__("./node_modules/core-js/modules/es.symbol.description.js");function generateComponentControl(_ref){var description=_ref.description,defaultValue=_ref.defaultValue;return{description,control:{disable:_ref.disable},defaultValue,table:_ref.table}}var config=__webpack_require__("./src/components/Canvas/config.ts"),types=__webpack_require__("./src/components/Canvas/types.ts"),components_Dotting=__webpack_require__("./src/components/Dotting.tsx"),DottingComponentArgTypes={width:generateComponentControl({description:"The width of the canvas. When you assign a string to width, it should be a valid CSS length value such as `100%`.",defaultValue:300,disable:!1}),height:generateComponentControl({description:"The height of the canvas. When you assign a string to height, it should be a valid CSS length value such as `100%`.",defaultValue:300,disable:!1}),style:generateComponentControl({description:"The style object for the canvas",disable:!0}),gridStrokeColor:generateComponentControl({description:"The stroke color of the grid",disable:!1}),gridStrokeWidth:generateComponentControl({defaultValue:1,description:"The stroke width of the grid",disable:!1}),isGridVisible:generateComponentControl({defaultValue:!0,description:"If set to `true` the grid lines will be visible",disable:!1}),backgroundColor:generateComponentControl({defaultValue:"#c9c9c9",description:"The background color of the canvas.",disable:!1}),initLayers:generateComponentControl({description:"The initial layers that you want to draw on the canvas.     If nothing is passed, there will be 1 default layer, and its id will be 'layer1'",disable:!0}),isPanZoomable:generateComponentControl({description:"If set to `true` the canvas will be pan and zoomable",defaultValue:!0,disable:!1}),isGridFixed:generateComponentControl({defaultValue:!1,description:"If set to `true` the grid will not be extendable",disable:!1}),brushTool:function generateComponentControlForEnum(_ref2){var description=_ref2.description,defaultValue=_ref2.defaultValue,enumProp=_ref2.enumProp,disable=_ref2.disable;return{description,mapping:enumProp,options:Object.keys(enumProp),control:{type:"select",labels:Object.values(enumProp),disable},defaultValue}}({defaultValue:types.G3.DOT,description:"The brush tool is for changing the brush tool",enumProp:types.G3,disable:!1}),brushColor:generateComponentControl({defaultValue:"#FF0000",description:"The brush color for drawing the grid.      You can make a `useState` for tracking brushColor       You can also use `useBrush` hook to change the brush color later.",disable:!1}),indicatorData:generateComponentControl({description:"The indicator data that you want to draw on the canvas.",disable:!0}),isInteractionApplicable:generateComponentControl({defaultValue:!0,description:"If set to `true` the interaction will be applicable.    If set to `false` the interaction will be disabled",disable:!1}),isDrawingEnabled:generateComponentControl({defaultValue:!0,description:"If set to `true` the drawing will be enabled.      If set to `false` the drawing will be disabled",disable:!1}),gridSquareLength:generateComponentControl({defaultValue:config.IA,description:"The length of the grid square.",disable:!1}),defaultPixelColor:generateComponentControl({defaultValue:config.vP,description:"The default pixel color.",disable:!1}),minScale:generateComponentControl({defaultValue:config.Vb,description:"The minimum scale of the canvas.",disable:!1}),maxScale:generateComponentControl({defaultValue:config.G6,description:"The maximum scale of the canvas.",disable:!1}),initAutoScale:generateComponentControl({defaultValue:!1,description:"Wheter to initially auto scale the canvas to fit the grids inside the canvas",disable:!1}),resizeUnit:generateComponentControl({defaultValue:1,description:"The unit of the resize",disable:!1}),maxColumnCount:generateComponentControl({defaultValue:void 0,description:"The maximum column count of the canvas. Must be greater than ".concat(config.tj),disable:!1}),maxRowCount:generateComponentControl({defaultValue:void 0,description:"The maximum row count of the canvas. Must be greater than ".concat(config.tj),disable:!1}),minColumnCount:generateComponentControl({defaultValue:config.tj,description:"The minimum column count of the canvas. Must be greater or equal to ".concat(config.tj),disable:!1}),minRowCount:generateComponentControl({defaultValue:config.tj,description:"The minimum row count of the canvas. Must be greater or equal to ".concat(config.tj),disable:!1})};const Dotting_stories={title:"Components/Dotting",component:components_Dotting.Z,parameters:{docs:{description:{component:"A component that allows you to draw pixels on canvas.         You must set the width and height of the canvas if you want to use it.         You can also set the initial data of the canvas.         You can also set the initial brush color if you want to.          The canvas is pan and zoomable by default.            The canvas grids are visible by default.           You can also set the initial indicator data of the canvas."}}},argTypes:DottingComponentArgTypes};var Dotting=function Dotting(args){return react.createElement(components_Dotting.Z,{width:args.width,height:args.height,style:void 0,gridStrokeColor:args.gridStrokeColor,gridStrokeWidth:args.gridStrokeWidth,isGridVisible:args.isGridVisible,backgroundColor:args.backgroundColor,isPanZoomable:args.isPanZoomable,isGridFixed:args.isGridFixed,brushColor:args.brushColor,brushTool:args.brushTool,indicatorData:[],isInteractionApplicable:args.isInteractionApplicable,isDrawingEnabled:args.isDrawingEnabled,gridSquareLength:args.gridSquareLength,defaultPixelColor:args.defaultPixelColor,minScale:args.minScale,maxScale:args.maxScale,initAutoScale:args.initAutoScale,resizeUnit:args.resizeUnit,maxColumnCount:args.maxColumnCount,maxRowCount:args.maxRowCount,minColumnCount:args.minColumnCount,minRowCount:args.minRowCount})};Dotting.parameters=(0,objectSpread2.Z)({storySource:{source:"(args: DottingProps) => {\n  return (\n    <DottingComponent\n      width={args.width}\n      height={args.height}\n      style={undefined}\n      gridStrokeColor={args.gridStrokeColor}\n      gridStrokeWidth={args.gridStrokeWidth}\n      isGridVisible={args.isGridVisible}\n      // backgroundMode={args.backgroundMode}\n      backgroundColor={args.backgroundColor}\n      isPanZoomable={args.isPanZoomable}\n      isGridFixed={args.isGridFixed}\n      brushColor={args.brushColor}\n      brushTool={args.brushTool}\n      indicatorData={[]}\n      isInteractionApplicable={args.isInteractionApplicable}\n      isDrawingEnabled={args.isDrawingEnabled}\n      gridSquareLength={args.gridSquareLength}\n      defaultPixelColor={args.defaultPixelColor}\n      minScale={args.minScale}\n      maxScale={args.maxScale}\n      initAutoScale={args.initAutoScale}\n      resizeUnit={args.resizeUnit}\n      maxColumnCount={args.maxColumnCount}\n      maxRowCount={args.maxRowCount}\n      minColumnCount={args.minColumnCount}\n      minRowCount={args.minRowCount}\n    />\n  );\n}"}},Dotting.parameters);var __namedExportsOrder=["Dotting"]},"./src/components/Canvas/config.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{BN:()=>DefaultExtendArrowPadding,G6:()=>DefaultMaxScale,IA:()=>DefaultGridSquareLength,L2:()=>DefaultButtonHeight,Ni:()=>ExtensionGuideCircleRadius,Om:()=>MouseMode,Qz:()=>DefaultButtonMargin,Tf:()=>InteractionEdgeTouchingRange,Vb:()=>DefaultMinScale,X1:()=>MaxImageBitMapSideLength,XM:()=>DefaultBackgroundColor,Xp:()=>DashedLineOffsetFromPixelCanvas,eL:()=>DefaultPanZoom,fA:()=>InteractionExtensionAllowanceRatio,lC:()=>DefaultPixelDataDimensions,pr:()=>ButtonDirection,s9:()=>CurrentDeviceUserId,tj:()=>MinColumnOrRowCount,uF:()=>DefaultZoomSensitivity,vP:()=>DefaultPixelColor,xH:()=>GridMinimumScale});var ButtonDirection,DefaultPanZoom={scale:1,offset:{x:0,y:0}},DefaultGridSquareLength=20,DefaultButtonHeight=30,DefaultButtonMargin=DefaultButtonHeight/2,MaxImageBitMapSideLength=2500;!function(ButtonDirection){ButtonDirection.TOP="TOP",ButtonDirection.BOTTOM="BOTTOM",ButtonDirection.LEFT="LEFT",ButtonDirection.RIGHT="RIGHT",ButtonDirection.TOPLEFT="TOPLEFT",ButtonDirection.TOPRIGHT="TOPRIGHT",ButtonDirection.BOTTOMLEFT="BOTTOMLEFT",ButtonDirection.BOTTOMRIGHT="BOTTOMRIGHT"}(ButtonDirection||(ButtonDirection={}));var MouseMode,DefaultPixelDataDimensions={columnCount:10,rowCount:10};!function(MouseMode){MouseMode.PANNING="PANNING",MouseMode.PINCHZOOMING="PINCHZOOMING",MouseMode.EXTENDING="EXTENDING",MouseMode.DRAWING="DRAWING",MouseMode.NULL="NULL"}(MouseMode||(MouseMode={}));var DefaultZoomSensitivity=200,DefaultMaxScale=1.5,DefaultMinScale=.3,CurrentDeviceUserId="current-device-user-id",InteractionExtensionAllowanceRatio=2,InteractionEdgeTouchingRange=6,DashedLineOffsetFromPixelCanvas=15,ExtensionGuideCircleRadius=3,DefaultExtendArrowPadding=2,DefaultBackgroundColor="#999999",DefaultPixelColor="#ffffff",GridMinimumScale=.2,MinColumnOrRowCount=2},"./src/components/Canvas/types.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";var CanvasEvents,BrushTool,BRUSH_PATTERN_ELEMENT;__webpack_require__.d(__webpack_exports__,{G3:()=>BrushTool,a3:()=>BRUSH_PATTERN_ELEMENT,v8:()=>CanvasEvents}),function(CanvasEvents){CanvasEvents.DATA_CHANGE="dataChange",CanvasEvents.GRID_CHANGE="gridChange",CanvasEvents.STROKE_END="strokeEnd",CanvasEvents.BRUSH_CHANGE="brushChange",CanvasEvents.HOVER_PIXEL_CHANGE="hoverPixelChange",CanvasEvents.LAYER_CHANGE="layerChange",CanvasEvents.CANVAS_INFO_CHANGE="canvasInfoChange"}(CanvasEvents||(CanvasEvents={})),function(BrushTool){BrushTool.DOT="DOT",BrushTool.ERASER="ERASER",BrushTool.PAINT_BUCKET="PAINT_BUCKET",BrushTool.SELECT="SELECT",BrushTool.NONE="NONE"}(BrushTool||(BrushTool={})),function(BRUSH_PATTERN_ELEMENT){BRUSH_PATTERN_ELEMENT[BRUSH_PATTERN_ELEMENT.FILL=1]="FILL",BRUSH_PATTERN_ELEMENT[BRUSH_PATTERN_ELEMENT.EMPTY=0]="EMPTY"}(BRUSH_PATTERN_ELEMENT||(BRUSH_PATTERN_ELEMENT={}))},"./src/components/Dotting.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>components_Dotting});__webpack_require__("./node_modules/core-js/modules/es.array.for-each.js"),__webpack_require__("./node_modules/core-js/modules/web.dom-collections.for-each.js"),__webpack_require__("./node_modules/core-js/modules/es.array.concat.js"),__webpack_require__("./node_modules/core-js/modules/es.array.filter.js");var objectSpread2=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),toConsumableArray=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),slicedToArray=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),react=__webpack_require__("./node_modules/react/index.js"),config=__webpack_require__("./src/components/Canvas/config.ts"),createForOfIteratorHelper=(__webpack_require__("./node_modules/core-js/modules/es.array.map.js"),__webpack_require__("./node_modules/core-js/modules/es.function.bind.js"),__webpack_require__("./node_modules/core-js/modules/es.array.splice.js"),__webpack_require__("./node_modules/core-js/modules/es.map.js"),__webpack_require__("./node_modules/core-js/modules/es.object.to-string.js"),__webpack_require__("./node_modules/core-js/modules/es.string.iterator.js"),__webpack_require__("./node_modules/core-js/modules/es.array.iterator.js"),__webpack_require__("./node_modules/core-js/modules/web.dom-collections.iterator.js"),__webpack_require__("./node_modules/core-js/modules/es.object.entries.js"),__webpack_require__("./node_modules/core-js/modules/es.array.from.js"),__webpack_require__("./node_modules/core-js/modules/es.array.sort.js"),__webpack_require__("./node_modules/core-js/modules/web.timers.js"),__webpack_require__("./node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js")),classCallCheck=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),createClass=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/createClass.js"),inherits=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/inherits.js"),createSuper=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/createSuper.js"),DottingError=(__webpack_require__("./node_modules/core-js/modules/es.array.find.js"),__webpack_require__("./node_modules/core-js/modules/es.array.find-index.js"),__webpack_require__("./node_modules/core-js/modules/es.array.reduce.js"),__webpack_require__("./node_modules/core-js/modules/es.array.reverse.js"),__webpack_require__("./node_modules/core-js/modules/es.array.slice.js"),__webpack_require__("./node_modules/core-js/modules/es.set.js"),__webpack_require__("./node_modules/core-js/modules/es.function.name.js"),function(_Error){(0,inherits.Z)(DottingError,_Error);var _super=(0,createSuper.Z)(DottingError);function DottingError(message){var _this;return(0,classCallCheck.Z)(this,DottingError),(_this=_super.call(this,message)).name="DottingError",_this}return(0,createClass.Z)(DottingError)}((0,__webpack_require__("./node_modules/@babel/runtime/helpers/esm/wrapNativeSuper.js").Z)(Error))),DuplicateLayerIdError=function(_DottingError){(0,inherits.Z)(DuplicateLayerIdError,_DottingError);var _super2=(0,createSuper.Z)(DuplicateLayerIdError);function DuplicateLayerIdError(layerId){var _this2;return(0,classCallCheck.Z)(this,DuplicateLayerIdError),(_this2=_super2.call(this,"Duplicate layer id ".concat(layerId,". Please make sure all layer ids are unique."))).name="DuplicateLayerIdError",_this2}return(0,createClass.Z)(DuplicateLayerIdError)}(DottingError),InvalidSquareDataError=function(_DottingError2){(0,inherits.Z)(InvalidSquareDataError,_DottingError2);var _super3=(0,createSuper.Z)(InvalidSquareDataError);function InvalidSquareDataError(layerId){var _this3;(0,classCallCheck.Z)(this,InvalidSquareDataError);var message=layerId?" for layer ".concat(layerId):"";return(_this3=_super3.call(this,"Invalid square data".concat(message,". Please make sure all data have the same row and column count."))).name="InvalidSquareDataError",_this3}return(0,createClass.Z)(InvalidSquareDataError)}(DottingError),InvalidDataDimensionsError=function(_DottingError3){(0,inherits.Z)(InvalidDataDimensionsError,_DottingError3);var _super4=(0,createSuper.Z)(InvalidDataDimensionsError);function InvalidDataDimensionsError(layerId){var _this4;(0,classCallCheck.Z)(this,InvalidDataDimensionsError);var message=layerId?" for layer ".concat(layerId):"";return(_this4=_super4.call(this,"Invalid data dimensions".concat(message,". Please make sure all data have the same dimensions."))).name="InvalidDataDimensionsError",_this4}return(0,createClass.Z)(InvalidDataDimensionsError)}(DottingError),InvalidDataIndicesError=function(_DottingError4){(0,inherits.Z)(InvalidDataIndicesError,_DottingError4);var _super5=(0,createSuper.Z)(InvalidDataIndicesError);function InvalidDataIndicesError(layerId){var _this5;(0,classCallCheck.Z)(this,InvalidDataIndicesError);var message=layerId?" for layer ".concat(layerId):"";return(_this5=_super5.call(this,"Invalid data indices".concat(message,". Please make sure all data have the same topRowIndex and leftColumnIndex."))).name="InvalidDataIndicesError",_this5}return(0,createClass.Z)(InvalidDataIndicesError)}(DottingError),UnspecifiedLayerIdError=function(_DottingError5){(0,inherits.Z)(UnspecifiedLayerIdError,_DottingError5);var _super6=(0,createSuper.Z)(UnspecifiedLayerIdError);function UnspecifiedLayerIdError(){var _this6;return(0,classCallCheck.Z)(this,UnspecifiedLayerIdError),(_this6=_super6.call(this,"Layer id has not been specified")).name="UnspecifiedLayerIdError",_this6}return(0,createClass.Z)(UnspecifiedLayerIdError)}(DottingError),LayerNotFoundError=function(_DottingError7){(0,inherits.Z)(LayerNotFoundError,_DottingError7);var _super8=(0,createSuper.Z)(LayerNotFoundError);function LayerNotFoundError(layerId){var _this8;return(0,classCallCheck.Z)(this,LayerNotFoundError),(_this8=_super8.call(this,"Layer ".concat(layerId," not found."))).name="LayerNotFoundError",_this8}return(0,createClass.Z)(LayerNotFoundError)}(DottingError),UnrecognizedDownloadOptionError=function(_DottingError8){(0,inherits.Z)(UnrecognizedDownloadOptionError,_DottingError8);var _super9=(0,createSuper.Z)(UnrecognizedDownloadOptionError);function UnrecognizedDownloadOptionError(){var _this9;return(0,classCallCheck.Z)(this,UnrecognizedDownloadOptionError),(_this9=_super9.call(this,"Unrecognized download option.")).name="UnrecognizedDownloadOptionError",_this9}return(0,createClass.Z)(UnrecognizedDownloadOptionError)}(DottingError),NoDataToMakeSvgError=function(_DottingError9){(0,inherits.Z)(NoDataToMakeSvgError,_DottingError9);var _super10=(0,createSuper.Z)(NoDataToMakeSvgError);function NoDataToMakeSvgError(){var _this10;return(0,classCallCheck.Z)(this,NoDataToMakeSvgError),(_this10=_super10.call(this,"No data to make svg.")).name="NoDataToMakeSvgError",_this10}return(0,createClass.Z)(NoDataToMakeSvgError)}(DottingError),convertCartesianToScreen=function convertCartesianToScreen(canvas,cartesianCoord,dpr){return{x:cartesianCoord.x+canvas.width/dpr/2,y:cartesianCoord.y+canvas.height/dpr/2}};function diffPoints(p1,p2){return{x:p1.x-p2.x,y:p1.y-p2.y}}function addPoints(p1,p2){return{x:p1.x+p2.x,y:p1.y+p2.y}}function getScreenPoint(point,panZoom){var offset=panZoom.offset,scale=panZoom.scale;return{x:Math.floor(point.x*scale+offset.x),y:Math.floor(point.y*scale+offset.y)}}function getWorldPoint(point,panZoom){var offset=panZoom.offset,scale=panZoom.scale;return{x:(point.x-offset.x)/scale,y:(point.y-offset.y)/scale}}function lerpRanges(value,range1Start,range1End,range2Start,range2End){return range2Start+(range2End-range2Start)*((value-range1Start)/(range1End-range1Start))}var getPointFromTouchyEvent=function getPointFromTouchyEvent(evt,element,panZoom){var originY,originX,offsetX,offsetY;if(window.TouchEvent&&evt instanceof TouchEvent){for(var isCanvasTouchIncluded=!1,firstCanvasTouchIndex=0,i=0;i<evt.touches.length;i++){if(evt.touches.item(i).target instanceof HTMLCanvasElement){isCanvasTouchIncluded=!0,firstCanvasTouchIndex=i;break}}return getPointFromTouch(isCanvasTouchIncluded?evt.touches[firstCanvasTouchIndex]:evt.touches[0],element,panZoom)}return originY=evt.clientY,originX=evt.clientX,offsetX=evt.offsetX,offsetY=evt.offsetY,originY+=window.scrollY,originX+=window.scrollX,{y:originY-panZoom.offset.y,x:originX-panZoom.offset.x,offsetX,offsetY}},getPointFromTouch=function getPointFromTouch(touch,element,panZoom){var r=element.getBoundingClientRect(),originY=touch.clientY,originX=touch.clientX,offsetX=touch.clientX-r.left,offsetY=touch.clientY-r.top;return{x:originX-panZoom.offset.x,y:originY-panZoom.offset.y,offsetX,offsetY}},calculateNewPanZoomFromPinchZoom=function calculateNewPanZoomFromPinchZoom(evt,element,panZoom,zoomSensitivity,prevPinchZoomDiff,minScale,maxScale){if(evt.preventDefault(),window.TouchEvent&&evt instanceof TouchEvent){var touchCount=evt.touches.length;if(touchCount<2)return;for(var canvasTouchEventIndexes=[],i=0;i<touchCount;i++){evt.touches.item(i).target instanceof HTMLCanvasElement&&canvasTouchEventIndexes.push(i)}if(2!==canvasTouchEventIndexes.length)return;var firstTouch=evt.touches[canvasTouchEventIndexes[0]],secondTouch=evt.touches[canvasTouchEventIndexes[1]],pinchZoomCurrentDiff=Math.abs(firstTouch.clientX-secondTouch.clientX)+Math.abs(firstTouch.clientY-secondTouch.clientY),firstTouchPoint=getPointFromTouch(firstTouch,element,panZoom),secondTouchPoint=getPointFromTouch(secondTouch,element,panZoom),touchCenterPos={x:(firstTouchPoint.offsetX+secondTouchPoint.offsetX)/2,y:(firstTouchPoint.offsetY+secondTouchPoint.offsetY)/2};if(!prevPinchZoomDiff)return{pinchZoomDiff:pinchZoomCurrentDiff,panZoom};var zoom=1-2*(prevPinchZoomDiff-pinchZoomCurrentDiff)/(2*zoomSensitivity),newScale=panZoom.scale*zoom;if(minScale>newScale||newScale>maxScale)return;var scaleOffset=diffPoints(touchCenterPos,getScreenPoint(getWorldPoint(touchCenterPos,{scale:panZoom.scale,offset:panZoom.offset}),{scale:newScale,offset:panZoom.offset}));return{pinchZoomDiff:pinchZoomCurrentDiff,panZoom:{scale:newScale,offset:addPoints(panZoom.offset,scaleOffset)}}}return null},getMouseCartCoord=function getMouseCartCoord(evt,element,panZoom,dpr){evt.preventDefault();var point=getPointFromTouchyEvent(evt,element,panZoom);return diffPoints(getWorldPoint({x:point.offsetX,y:point.offsetY},panZoom),{x:element.width/dpr/2,y:element.height/dpr/2})},getCenterCartCoordFromTwoTouches=function getCenterCartCoordFromTwoTouches(evt,element,panZoom,dpr){if(evt.preventDefault(),evt.touches&&evt.touches.length<2)return null;if(evt.touches.length>2)return null;var touch1=evt.touches[0],touch2=evt.touches[1],touch1Point=getPointFromTouch(touch1,element,panZoom),touch2Point=getPointFromTouch(touch2,element,panZoom);return diffPoints(getWorldPoint({x:(touch1Point.offsetX+touch2Point.offsetX)/2,y:(touch1Point.offsetY+touch2Point.offsetY)/2},panZoom),{x:element.width/dpr/2,y:element.height/dpr/2})},getPixelIndexFromMouseCartCoord=function getPixelIndexFromMouseCartCoord(mouseCartCoord,sortedRowIndices,sortedColumnIndices,gridSquareLength){var leftTopPoint_x=sortedColumnIndices[0]*gridSquareLength,leftTopPoint_y=sortedRowIndices[0]*gridSquareLength;if(mouseCartCoord.x>leftTopPoint_x&&mouseCartCoord.x<leftTopPoint_x+sortedColumnIndices.length*gridSquareLength&&mouseCartCoord.y>leftTopPoint_y&&mouseCartCoord.y<leftTopPoint_y+sortedRowIndices.length*gridSquareLength){var rowOffset=Math.floor((mouseCartCoord.y-leftTopPoint_y)/gridSquareLength),columnOffset=Math.floor((mouseCartCoord.x-leftTopPoint_x)/gridSquareLength);return{rowIndex:sortedRowIndices[rowOffset],columnIndex:sortedColumnIndices[columnOffset]}}return null},getIsPointInsideRegion=function getIsPointInsideRegion(point,area){var _getAreaTopLeftAndBot=getAreaTopLeftAndBottomRight(area),areaTopLeftPos=_getAreaTopLeftAndBot.areaTopLeftPos,areaBottomRightPos=_getAreaTopLeftAndBot.areaBottomRightPos;return point.x>=areaTopLeftPos.x&&point.x<=areaBottomRightPos.x&&point.y>=areaTopLeftPos.y&&point.y<=areaBottomRightPos.y},getAreaTopLeftAndBottomRight=function getAreaTopLeftAndBottomRight(area){var isAreaFromLeftToRight=area.startWorldPos.x<area.endWorldPos.x,isAreaFromTopToBottom=area.startWorldPos.y<area.endWorldPos.y;return{areaTopLeftPos:{x:isAreaFromLeftToRight?area.startWorldPos.x:area.endWorldPos.x,y:isAreaFromTopToBottom?area.startWorldPos.y:area.endWorldPos.y},areaBottomRightPos:{x:isAreaFromLeftToRight?area.endWorldPos.x:area.startWorldPos.x,y:isAreaFromTopToBottom?area.endWorldPos.y:area.startWorldPos.y}}},convertWorldPosAreaToPixelGridArea=function convertWorldPosAreaToPixelGridArea(selectingArea,rowCount,columnCount,gridSquareLength,rowKeysInOrder,columnKeysInOrder){var leftColumnIndex=columnKeysInOrder[0],topRowIndex=rowKeysInOrder[0],_getAreaTopLeftAndBot3=getAreaTopLeftAndBottomRight(selectingArea),areaTopLeftPos=_getAreaTopLeftAndBot3.areaTopLeftPos,areaBottomRightPos=_getAreaTopLeftAndBot3.areaBottomRightPos,pixelGridLeftTopPoint={x:leftColumnIndex*gridSquareLength,y:topRowIndex*gridSquareLength},selectedRegionTopLeft={x:0,y:0},selectedRegionBottomRight={x:0,y:0},selectedAreaLeftOffsetAmount=areaTopLeftPos.x-pixelGridLeftTopPoint.x;if(selectedAreaLeftOffsetAmount<0)selectedRegionTopLeft.x=pixelGridLeftTopPoint.x;else{if(selectedAreaLeftOffsetAmount>columnCount*gridSquareLength)return null;selectedRegionTopLeft.x=pixelGridLeftTopPoint.x+Math.floor(selectedAreaLeftOffsetAmount/gridSquareLength)*gridSquareLength}var selectedAreaTopOffsetAmount=areaTopLeftPos.y-pixelGridLeftTopPoint.y;if(selectedAreaTopOffsetAmount<0)selectedRegionTopLeft.y=pixelGridLeftTopPoint.y;else{if(selectedAreaTopOffsetAmount>rowCount*gridSquareLength)return null;selectedRegionTopLeft.y=pixelGridLeftTopPoint.y+Math.floor(selectedAreaTopOffsetAmount/gridSquareLength)*gridSquareLength}var selectedAreaRightOffsetAmount=areaBottomRightPos.x-(pixelGridLeftTopPoint.x+columnCount*gridSquareLength);if(selectedAreaRightOffsetAmount>0)selectedRegionBottomRight.x=pixelGridLeftTopPoint.x+columnCount*gridSquareLength;else{if(selectedAreaRightOffsetAmount<-columnCount*gridSquareLength)return null;selectedRegionBottomRight.x=pixelGridLeftTopPoint.x+columnCount*gridSquareLength+Math.ceil(selectedAreaRightOffsetAmount/gridSquareLength)*gridSquareLength}var selectedAreaBottomOffsetAmount=areaBottomRightPos.y-(pixelGridLeftTopPoint.y+rowCount*gridSquareLength);if(selectedAreaBottomOffsetAmount>0)selectedRegionBottomRight.y=pixelGridLeftTopPoint.y+rowCount*gridSquareLength;else{if(selectedAreaBottomOffsetAmount<-rowCount*gridSquareLength)return null;selectedRegionBottomRight.y=pixelGridLeftTopPoint.y+rowCount*gridSquareLength+Math.ceil(selectedAreaBottomOffsetAmount/gridSquareLength)*gridSquareLength}for(var relativeTopLeftRowIndex=Math.floor((selectedRegionTopLeft.y-pixelGridLeftTopPoint.y)/gridSquareLength),relativeTopLeftColumnIndex=Math.floor((selectedRegionTopLeft.x-pixelGridLeftTopPoint.x)/gridSquareLength),relativeBottomRightRowIndex=Math.floor((selectedRegionBottomRight.y-pixelGridLeftTopPoint.y)/gridSquareLength),relativeBottomRightColumnIndex=Math.floor((selectedRegionBottomRight.x-pixelGridLeftTopPoint.x)/gridSquareLength),includedPixelsIndices=[],i=relativeTopLeftRowIndex;i<relativeBottomRightRowIndex;i++)for(var j=relativeTopLeftColumnIndex;j<relativeBottomRightColumnIndex;j++)includedPixelsIndices.push({rowIndex:rowKeysInOrder[i],columnIndex:columnKeysInOrder[j]});return{startWorldPos:selectedRegionTopLeft,endWorldPos:selectedRegionBottomRight,includedPixelsIndices}},returnScrollOffsetFromMouseOffset=function returnScrollOffsetFromMouseOffset(mouseOffset,panZoom,newScale){var scaleOffset=diffPoints(mouseOffset,getScreenPoint(getWorldPoint(mouseOffset,panZoom),{scale:newScale,offset:panZoom.offset}));return addPoints(panZoom.offset,scaleOffset)},getOverlappingPixelIndicesForModifiedPixels=function getOverlappingPixelIndicesForModifiedPixels(originalPixels,originPixelIndex,modifyPixelWidthRatio,modifyPixelHeightRatio,gridSquareLength){if(modifyPixelHeightRatio<0||modifyPixelWidthRatio<0)throw new Error("modifyPixelHeightRatio and modifyPixelWidthRatio should be positive");if(gridSquareLength<0)throw new Error("gridSquareLength should be positive");var _step,pixelsToColor=[],_iterator=(0,createForOfIteratorHelper.Z)(originalPixels);try{for(_iterator.s();!(_step=_iterator.n()).done;)for(var item=_step.value,pixelDistanceFromOrigin={rowOffset:item.rowIndex-originPixelIndex.rowIndex,columnOffset:item.columnIndex-originPixelIndex.columnIndex},pixelWordPosOffset={x:pixelDistanceFromOrigin.columnOffset*gridSquareLength,y:pixelDistanceFromOrigin.rowOffset*gridSquareLength},cornerWorldPos={topLeft:{x:pixelWordPosOffset.x*modifyPixelWidthRatio,y:pixelWordPosOffset.y*modifyPixelHeightRatio},topRight:{x:(pixelWordPosOffset.x+gridSquareLength)*modifyPixelWidthRatio,y:pixelWordPosOffset.y*modifyPixelHeightRatio},bottomLeft:{x:pixelWordPosOffset.x*modifyPixelWidthRatio,y:(pixelWordPosOffset.y+gridSquareLength)*modifyPixelHeightRatio},bottomRight:{x:(pixelWordPosOffset.x+gridSquareLength)*modifyPixelWidthRatio,y:(pixelWordPosOffset.y+gridSquareLength)*modifyPixelHeightRatio}},i=cornerWorldPos.topLeft.x;i<cornerWorldPos.topRight.x;i+=gridSquareLength)for(var j=cornerWorldPos.topLeft.y;j<cornerWorldPos.bottomLeft.y;j+=gridSquareLength){var pixelIndex={rowIndex:Math.round(originPixelIndex.rowIndex+Math.floor(j/gridSquareLength)),columnIndex:Math.round(originPixelIndex.columnIndex+Math.floor(i/gridSquareLength)),color:item.color,previousColor:item.previousColor};pixelsToColor.push(pixelIndex)}}catch(err){_iterator.e(err)}finally{_iterator.f()}return pixelsToColor},getGridIndicesFromData=function getGridIndicesFromData(data){var allRowKeys=Array.from(data.keys()),allColumnKeys=Array.from(data.get(allRowKeys[0]).keys()),currentTopIndex=Math.min.apply(Math,allRowKeys),currentLeftIndex=Math.min.apply(Math,allColumnKeys);return{topRowIndex:currentTopIndex,bottomRowIndex:Math.max.apply(Math,allRowKeys),leftColumnIndex:currentLeftIndex,rightColumnIndex:Math.max.apply(Math,allColumnKeys)}},getRowKeysFromData=function getRowKeysFromData(data){return Array.from(data.keys()).sort((function(a,b){return a-b}))},getColumnKeysFromData=function getColumnKeysFromData(data){var allRowKeys=getRowKeysFromData(data);return Array.from(data.get(allRowKeys[0]).keys()).sort((function(a,b){return a-b}))},getColumnCountFromData=function getColumnCountFromData(data){return 0===data.size?0:data.entries().next().value[1].size},getRowCountFromData=function getRowCountFromData(data){return data.size},extractColoredPixelsFromRow=function extractColoredPixelsFromRow(data,rowIndex){var rowPixelsMap=data.get(rowIndex),pixelModifyItems=[];return Array.from(rowPixelsMap.entries()).forEach((function(columnData){var _columnData=(0,slicedToArray.Z)(columnData,2),key=_columnData[0],pixel=_columnData[1];pixel.color&&pixelModifyItems.push({color:pixel.color,rowIndex,columnIndex:key})})),pixelModifyItems},extractColoredPixelsFromColumn=function extractColoredPixelsFromColumn(data,columnIndex){var pixelModifyItems=[];return Array.from(data.entries()).map((function(rowData){var rowIndex=rowData[0],row=rowData[1];row.get(columnIndex).color&&pixelModifyItems.push({rowIndex,columnIndex,color:row.get(columnIndex).color})})),pixelModifyItems},validateSquareArray=function validateSquareArray(data){var dataRowCount=data.length,columnCount=0,rowCount=dataRowCount,isDataValid=!0;if(dataRowCount<2)isDataValid=!1;else{var dataColumnCount=data[0].length;if(columnCount=dataColumnCount,dataColumnCount<2)isDataValid=!1;else for(var i=0;i<dataRowCount;i++)if(data[i].length!==dataColumnCount){isDataValid=!1;break}}return{isDataValid,columnCount,rowCount}},createRowKeyOrderMapfromData=function createRowKeyOrderMapfromData(data){var sortedRowKeys=getRowKeysFromData(data).sort((function(a,b){return a-b})),minRowKey=sortedRowKeys[0],rowKeyOrderMap=new Map;return sortedRowKeys.forEach((function(key,index){rowKeyOrderMap.set(key,index)})),{rowKeyOrderMap,minRowKey}},createColumnKeyOrderMapfromData=function createColumnKeyOrderMapfromData(data){var sortedColumnKeys=getColumnKeysFromData(data).sort((function(a,b){return a-b})),minColumnKey=sortedColumnKeys[0],columnKeyOrderMap=new Map;return sortedColumnKeys.forEach((function(key,index){columnKeyOrderMap.set(key,index)})),{columnKeyOrderMap,minColumnKey}},getInBetweenPixelIndicesfromCoords=function getInBetweenPixelIndicesfromCoords(previousCoord,currentCoord,gridSquareLength,data){if(!previousCoord||!currentCoord)return[];if(Math.abs(currentCoord.x-previousCoord.x)>=gridSquareLength||Math.abs(currentCoord.y-previousCoord.y)>=gridSquareLength){getGridIndicesFromData(data);var _getAllGridIndicesSor=function getAllGridIndicesSorted(data){var allRowKeys=Array.from(data.keys()),allColumnKeys=Array.from(data.get(allRowKeys[0]).keys());return{rowIndices:allRowKeys.sort((function(a,b){return a-b})),columnIndices:allColumnKeys.sort((function(a,b){return a-b}))}}(data),rowIndices=_getAllGridIndicesSor.rowIndices,columnIndices=_getAllGridIndicesSor.columnIndices,pixelIndex=getPixelIndexFromMouseCartCoord(currentCoord,rowIndices,columnIndices,gridSquareLength),previousIndex=getPixelIndexFromMouseCartCoord(previousCoord,rowIndices,columnIndices,gridSquareLength);if(!previousIndex||!pixelIndex)return;if(Math.abs(pixelIndex.columnIndex-previousIndex.columnIndex)>=1||Math.abs(pixelIndex.rowIndex-previousIndex.rowIndex)>=1){var missingIndices=function getBressenhamIndices(x1,y1,x2,y2){var startPosition={x1,y1},endPosition_x2=x2,endPosition_y2=y2,width=x2-x1,height=y2-y1,isGradualSlope=Math.abs(width)>=Math.abs(height),directionX=width>=0?1:-1,directionY=height>=0?1:-1,fw=directionX*width,fh=directionY*height,f=isGradualSlope?2*fh-fw:2*fw-fh,f1=isGradualSlope?2*fh:2*fw,f2=isGradualSlope?2*(fh-fw):2*(fw-fh),x=startPosition.x1,y=startPosition.y1,missingPoints=[];if(isGradualSlope)for(;x!=endPosition_x2;)missingPoints.push({rowIndex:x,columnIndex:y}),f<0?f+=f1:(f+=f2,y+=directionY),x+=directionX;else for(;y!=endPosition_y2;)missingPoints.push({rowIndex:x,columnIndex:y}),f<0?f+=f1:(f+=f2,x+=directionX),y+=directionY;return missingPoints}(previousIndex.rowIndex,previousIndex.columnIndex,pixelIndex.rowIndex,pixelIndex.columnIndex);if(missingIndices.length>0)return missingIndices}}},validateLayers=function validateLayers(layers){if(!layers)throw new Error("No layer provided");if(0===layers.length)throw new Error("initLayers should not be empty. Please provide at least one layer.");var layerIdSet=new Set,measuredColumnCount=null,measuredRowCount=null,measuredTopRowIndex=null,measuredLeftColumnIndex=null;return layers.forEach((function(layer){if(layerIdSet.has(layer.id))throw new DuplicateLayerIdError(layer.id);layerIdSet.add(layer.id);var _validateSquareArray=validateSquareArray(layer.data),isDataValid=_validateSquareArray.isDataValid,columnCount=_validateSquareArray.columnCount,rowCount=_validateSquareArray.rowCount;if(null!==measuredColumnCount&&null!==measuredRowCount){if(measuredColumnCount!==columnCount||measuredRowCount!==rowCount)throw new InvalidDataDimensionsError(layer.id)}else measuredColumnCount=columnCount,measuredRowCount=rowCount;if(!isDataValid)throw new InvalidSquareDataError(layer.id);null!=measuredLeftColumnIndex&&null!=measuredTopRowIndex||(measuredLeftColumnIndex=layer.data[0][0].columnIndex,measuredTopRowIndex=layer.data[0][0].rowIndex);var topRowIndex=layer.data[0][0].rowIndex,leftColumnIndex=layer.data[0][0].columnIndex;if(topRowIndex!==measuredTopRowIndex)throw new InvalidDataIndicesError(layer.id);if(leftColumnIndex!==measuredLeftColumnIndex)throw new InvalidDataIndicesError(layer.id)})),!0},BaseLayer=function(){function BaseLayer(_ref){var canvas=_ref.canvas;(0,classCallCheck.Z)(this,BaseLayer),this.ctx=void 0,this.element=void 0,this.clonedElement=void 0,this.dpr=void 0,this.panZoom=config.eL,this.width=void 0,this.height=void 0,this.criterionDataForRendering=void 0,this.rowKeyOrderMap=new Map,this.columnKeyOrderMap=new Map,this.topRowIndex=0,this.leftColumnIndex=0,this.ctx=canvas.getContext("2d"),this.element=canvas}return(0,createClass.Z)(BaseLayer,[{key:"getContext",value:function getContext(){return this.ctx}},{key:"getElement",value:function getElement(){return this.element}},{key:"getRowKeyOrderMap",value:function getRowKeyOrderMap(){return this.rowKeyOrderMap}},{key:"getColumnKeyOrderMap",value:function getColumnKeyOrderMap(){return this.columnKeyOrderMap}},{key:"setPanZoom",value:function setPanZoom(panZoom){this.panZoom=panZoom}},{key:"setCriterionDataForRendering",value:function setCriterionDataForRendering(criterionDataForRendering){this.criterionDataForRendering=criterionDataForRendering;var _createRowKeyOrderMap=createRowKeyOrderMapfromData(criterionDataForRendering),rowKeyOrderMap=_createRowKeyOrderMap.rowKeyOrderMap,minRowKey=_createRowKeyOrderMap.minRowKey,_createColumnKeyOrder=createColumnKeyOrderMapfromData(criterionDataForRendering),columnKeyOrderMap=_createColumnKeyOrder.columnKeyOrderMap,minColumnKey=_createColumnKeyOrder.minColumnKey;this.rowKeyOrderMap=rowKeyOrderMap,this.columnKeyOrderMap=columnKeyOrderMap,this.topRowIndex=minRowKey,this.leftColumnIndex=minColumnKey}},{key:"scale",value:function scale(x,y){this.ctx.scale(x,y)}},{key:"setWidth",value:function setWidth(width,devicePixelRatio){this.width=width,this.element.width=devicePixelRatio?width*devicePixelRatio:width,this.element.style.width="".concat(width,"px")}},{key:"setHeight",value:function setHeight(height,devicePixelRatio){this.height=height,this.element.height=devicePixelRatio?height*devicePixelRatio:height,this.element.style.height="".concat(height,"px")}},{key:"setDpr",value:function setDpr(dpr){this.dpr=dpr}},{key:"getWidth",value:function getWidth(){return this.width}},{key:"getHeight",value:function getHeight(){return this.height}},{key:"setSize",value:function setSize(width,height,devicePixelRatio){this.setWidth(width,devicePixelRatio),this.setHeight(height,devicePixelRatio),this.dpr=devicePixelRatio||this.dpr}},{key:"setTopRowIndex",value:function setTopRowIndex(topRowIndex){this.topRowIndex=topRowIndex}},{key:"setLeftColumnIndex",value:function setLeftColumnIndex(leftColumnIndex){this.leftColumnIndex=leftColumnIndex}},{key:"getTopRowIndex",value:function getTopRowIndex(){return this.topRowIndex}},{key:"getLeftColumnIndex",value:function getLeftColumnIndex(){return this.leftColumnIndex}}]),BaseLayer}(),DottingDataLayer=function(_Observable){(0,inherits.Z)(DottingDataLayer,_Observable);var _super=(0,createSuper.Z)(DottingDataLayer);function DottingDataLayer(_ref){var _this,data=_ref.data,id=_ref.id;(0,classCallCheck.Z)(this,DottingDataLayer),(_this=_super.call(this)).data=void 0,_this.id=void 0,_this.isVisible=!0,_this.rowKeys=void 0,_this.columnKeys=void 0,_this.getColumnKeysFromData=function(){var allRowKeys=Array.from(_this.data.keys());return Array.from(_this.data.get(allRowKeys[0]).keys())},_this.addRowToData=function(rowIndex){var columnKeys=_this.columnKeys;if(_this.data.has(rowIndex))return null;_this.data.set(rowIndex,new Map),_this.rowKeys.add(rowIndex);var _step,_iterator=(0,createForOfIteratorHelper.Z)(columnKeys);try{for(_iterator.s();!(_step=_iterator.n()).done;){var i=_step.value;_this.data.get(rowIndex).set(i,{color:""})}}catch(err){_iterator.e(err)}finally{_iterator.f()}return _this.notify(_this.getData()),rowIndex},_this.addColumnToData=function(columnIndex){var validColumnIndex=null;return _this.data.forEach((function(row){row.has(columnIndex)||(validColumnIndex=columnIndex,row.set(columnIndex,{color:""}))})),_this.notify(_this.getData()),_this.columnKeys.add(columnIndex),validColumnIndex},_this.getCopiedData=function(){var copiedData=new Map;return _this.data.forEach((function(row,rowIndex){copiedData.set(rowIndex,new Map),row.forEach((function(column,columnIndex){copiedData.get(rowIndex).set(columnIndex,(0,objectSpread2.Z)({},column))}))})),copiedData};var isDataValid=validateSquareArray(data).isDataValid,leftColumnIndex=data[0][0].columnIndex,topRowIndex=data[0][0].rowIndex;if(!isDataValid)throw new Error("Data is not valid");_this.data=new Map,_this.id=id;for(var i=0;i<data.length;i++){_this.data.set(topRowIndex+i,new Map);for(var j=0;j<data[i].length;j++)_this.data.get(topRowIndex+i).set(leftColumnIndex+j,{color:data[i][j].color})}return _this.rowKeys=new Set(_this.data.keys()),_this.columnKeys=new Set(_this.data.get(topRowIndex).keys()),_this}return(0,createClass.Z)(DottingDataLayer,[{key:"getDataInfo",value:function getDataInfo(){return{gridIndices:getGridIndicesFromData(this.data),columnCount:getColumnCountFromData(this.data),rowCount:getRowCountFromData(this.data)}}},{key:"getId",value:function getId(){return this.id}},{key:"deleteRowOfData",value:function deleteRowOfData(rowIndex){var validRowIndex;if(!this.data.has(rowIndex))throw new Error("Row does not exist");return validRowIndex=rowIndex,this.data.delete(rowIndex),this.rowKeys.delete(rowIndex),this.notify(this.getData()),validRowIndex}},{key:"deleteColumnOfData",value:function deleteColumnOfData(columnIndex){var validColumnIndex=null;return this.data.forEach((function(row){if(!row.has(columnIndex))throw new Error("Column does not exist");validColumnIndex=columnIndex,row.delete(columnIndex)})),this.columnKeys.delete(columnIndex),this.notify(this.getData()),validColumnIndex}},{key:"clearData",value:function clearData(){for(var previousPixels=[],newPixels=[],rowKeys=Array.from(this.data.keys()),columnKeys=Array.from(this.data.get(rowKeys[0]).keys()),_i=0,_rowKeys=rowKeys;_i<_rowKeys.length;_i++){var _step2,i=_rowKeys[_i],_iterator2=(0,createForOfIteratorHelper.Z)(columnKeys);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var j=_step2.value;previousPixels.push({rowIndex:i,columnIndex:j,color:this.data.get(i).get(j).color}),newPixels.push({rowIndex:i,columnIndex:j,color:""}),this.data.get(i).set(j,{color:""})}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}}return this.notify(this.getData()),{previousPixels,newPixels}}},{key:"setData",value:function setData(data){this.data=data,this.rowKeys=new Set(data.keys()),this.columnKeys=new Set(data.get(Array.from(data.keys())[0]).keys()),this.notify(this.getData())}},{key:"setIsVisible",value:function setIsVisible(isVisible){this.isVisible=isVisible}},{key:"getData",value:function getData(){return this.data}},{key:"getIsVisible",value:function getIsVisible(){return this.isVisible}},{key:"getDataArray",value:function getDataArray(){var data=[];return(0,toConsumableArray.Z)(this.data.entries()).forEach((function(_ref2){var _ref3=(0,slicedToArray.Z)(_ref2,2),rowIndex=_ref3[0],row=_ref3[1],rowData=[];(0,toConsumableArray.Z)(row.entries()).forEach((function(_ref4){var _ref5=(0,slicedToArray.Z)(_ref4,2),columnIndex=_ref5[0],column=_ref5[1];rowData.push({rowIndex,columnIndex,color:column.color})})),data.push(rowData)})),data}}]),DottingDataLayer}(function(){function Observable(){(0,classCallCheck.Z)(this,Observable),this.observers=[]}return(0,createClass.Z)(Observable,[{key:"subscribe",value:function subscribe(observer){this.observers.push(observer)}},{key:"unsubscribe",value:function unsubscribe(observer){this.observers=this.observers.filter((function(obs){return obs!==observer}))}},{key:"notify",value:function notify(data){this.observers.forEach((function(observer){return observer.update(data)}))}}]),Observable}()),DataLayer=function(_BaseLayer){(0,inherits.Z)(DataLayer,_BaseLayer);var _super=(0,createSuper.Z)(DataLayer);function DataLayer(_ref){var _this,canvas=_ref.canvas,layers=_ref.layers;if((0,classCallCheck.Z)(this,DataLayer),(_this=_super.call(this,{canvas})).gridSquareLength=config.IA,_this.layers=void 0,_this.currentLayer=void 0,_this.defaultPixelColor=config.vP,_this.capturedImageBitmap=null,_this.capturedImageBitmapScale=1,_this.offscreenCanvas=null,layers){var topRowIndex=layers[0].data[0][0].rowIndex,leftColumnIndex=layers[0].data[0][0].columnIndex;_this.setTopRowIndex(topRowIndex),_this.setLeftColumnIndex(leftColumnIndex),_this.layers=layers.map((function(layer){return new DottingDataLayer({data:layer.data,id:layer.id})}))}else{_this.setTopRowIndex(0),_this.setLeftColumnIndex(0);var defaultNestedArray=[],rowCount=config.lC.rowCount,columnCount=config.lC.columnCount;_this.offscreenCanvas=new OffscreenCanvas(columnCount*_this.gridSquareLength,rowCount*_this.gridSquareLength);for(var i=0;i<rowCount;i++){defaultNestedArray.push([]);for(var j=0;j<columnCount;j++)defaultNestedArray[i].push({color:"",rowIndex:i,columnIndex:j})}_this.layers=[new DottingDataLayer({data:defaultNestedArray,id:"layer1"})]}return _this.currentLayer=_this.layers[0],_this}return(0,createClass.Z)(DataLayer,[{key:"getColumnCount",value:function getColumnCount(){return getColumnCountFromData(this.getData())}},{key:"getRowCount",value:function getRowCount(){return getRowCountFromData(this.getData())}},{key:"getGridIndices",value:function getGridIndices(){return getGridIndicesFromData(this.getData())}},{key:"getDimensions",value:function getDimensions(){return{columnCount:this.getColumnCount(),rowCount:this.getRowCount()}}},{key:"getData",value:function getData(){return this.currentLayer.getData()}},{key:"getLayer",value:function getLayer(layerId){var layer=this.layers.find((function(layer){return layer.getId()===layerId}));return layer||null}},{key:"getLayerIndex",value:function getLayerIndex(layerId){return this.layers.findIndex((function(layer){return layer.getId()===layerId}))}},{key:"getLayers",value:function getLayers(){return this.layers}},{key:"createLayer",value:function createLayer(layerId,data){if(this.getLayer(layerId))throw new Error("Layer already exists");var currentLayerInfo=this.currentLayer.getDataInfo();if(data){var _validateSquareArray=validateSquareArray(data),isDataValid=_validateSquareArray.isDataValid,rowCount=_validateSquareArray.rowCount,columnCount=_validateSquareArray.columnCount,leftColumnIndex=data[0][0].columnIndex,topRowIndex=data[0][0].rowIndex;if(!isDataValid)throw new Error("Data is not square");if(leftColumnIndex!==currentLayerInfo.gridIndices.leftColumnIndex||topRowIndex!==currentLayerInfo.gridIndices.topRowIndex)throw new Error("Data grid indice differs from current layer");if(rowCount!==currentLayerInfo.rowCount||columnCount!==currentLayerInfo.columnCount)throw new Error("Data dimensions differs from current layer");return new DottingDataLayer({data,id:layerId})}for(var emptyArray=[],i=0;i<currentLayerInfo.rowCount;i++){emptyArray.push([]);for(var j=0;j<currentLayerInfo.columnCount;j++)emptyArray[i].push({rowIndex:currentLayerInfo.gridIndices.topRowIndex+i,columnIndex:currentLayerInfo.gridIndices.leftColumnIndex+j,color:""})}return new DottingDataLayer({data:emptyArray,id:layerId})}},{key:"getCopiedData",value:function getCopiedData(){var copiedMap=new Map;return Array.from(this.getData().entries()).forEach((function(_ref2){var _ref3=(0,slicedToArray.Z)(_ref2,2),rowIndex=_ref3[0],row=_ref3[1],copiedRow=new Map;Array.from(row.entries()).forEach((function(_ref4){var _ref5=(0,slicedToArray.Z)(_ref4,2),columnIndex=_ref5[0],pixelData=_ref5[1];copiedRow.set(columnIndex,(0,objectSpread2.Z)({},pixelData))})),copiedMap.set(rowIndex,copiedRow)})),copiedMap}},{key:"getCurrentLayer",value:function getCurrentLayer(){return this.currentLayer}},{key:"hideLayer",value:function hideLayer(layerId){var layer=this.getLayer(layerId);if(!layer)throw new Error("Layer not found");layer.setIsVisible(!1)}},{key:"showLayer",value:function showLayer(layerId){var layer=this.getLayer(layerId);if(!layer)throw new Error("Layer not found");layer.setIsVisible(!0)}},{key:"isolateLayer",value:function isolateLayer(layerId){var layer=this.getLayer(layerId);if(!layer)throw new Error("Layer not found");this.layers.forEach((function(layer){return layer.setIsVisible(!1)})),layer.setIsVisible(!0)}},{key:"showAllLayers",value:function showAllLayers(){this.layers.forEach((function(layer){return layer.setIsVisible(!0)}))}},{key:"reorderLayersByIds",value:function reorderLayersByIds(layerIds){var _this2=this,newLayers=[];layerIds.forEach((function(layerId){var layer=_this2.getLayer(layerId);if(!layer)throw new Error("Layer not found");newLayers.push(layer)})),this.layers=newLayers}},{key:"setCurrentLayer",value:function setCurrentLayer(layerId){var layer=this.layers.find((function(layer){return layer.getId()===layerId}));if(!layer)throw new Error("Layer not found");this.currentLayer=layer}},{key:"setData",value:function setData(data,layerId){if(void 0===layerId){if(this.layers.length>1)throw new Error("Must specify layerId when there are multiple layers");this.currentLayer.setData(data)}else{var layer=this.layers.find((function(layer){return layer.getId()===layerId}));if(!layer)throw new Error("Layer not found");layer.setData(data)}}},{key:"setLayers",value:function setLayers(layers){this.layers=[];var topRowIndex=layers[0].data[0][0].rowIndex,leftColumnIndex=layers[0].data[0][0].columnIndex;this.setTopRowIndex(topRowIndex),this.setLeftColumnIndex(leftColumnIndex),this.layers=layers.map((function(layer){return new DottingDataLayer({data:layer.data,id:layer.id})}))}},{key:"setGridSquareLength",value:function setGridSquareLength(length){this.gridSquareLength=length}},{key:"setDefaultPixelColor",value:function setDefaultPixelColor(color){this.defaultPixelColor=color}},{key:"getCapturedImageBitmap",value:function getCapturedImageBitmap(){return this.capturedImageBitmap}},{key:"updatePixelColors",value:function updatePixelColors(data,layerId){if(!layerId&&this.layers.length>1)throw new Error("Must specify layerId when there are multiple layers");var layer=layerId?this.getLayer(layerId):this.currentLayer,modifiedPixels=[];if(!layer)throw new Error("Layer not found");var _step,_iterator=(0,createForOfIteratorHelper.Z)(data);try{for(_iterator.s();!(_step=_iterator.n()).done;){var item=_step.value,rowIndex=item.rowIndex,columnIndex=item.columnIndex,color=item.color;layer.getData().get(rowIndex)&&layer.getData().get(rowIndex).get(columnIndex)&&(modifiedPixels.push({rowIndex,columnIndex,color,previousColor:layer.getData().get(rowIndex).get(columnIndex).color}),layer.getData().get(rowIndex).set(columnIndex,{color}))}}catch(err){_iterator.e(err)}finally{_iterator.f()}return modifiedPixels}},{key:"colorPixels",value:function colorPixels(data,layerId){if(!layerId&&this.layers.length>1)throw new Error("Must specify layerId when there are multiple layers");var layer=layerId?this.getLayer(layerId):this.currentLayer;if(!layer)throw new Error("Layer not found");var rowIndices=data.map((function(change){return change.rowIndex})),columnIndices=data.map((function(change){return change.columnIndex})),minRowIndex=Math.min.apply(Math,(0,toConsumableArray.Z)(rowIndices)),maxRowIndex=Math.max.apply(Math,(0,toConsumableArray.Z)(rowIndices)),minColumnIndex=Math.min.apply(Math,(0,toConsumableArray.Z)(columnIndices)),maxColumnIndex=Math.max.apply(Math,(0,toConsumableArray.Z)(columnIndices)),currentCanvasIndices=this.getGridIndices(),totalAddedRowIndices=[],totalAddedColumnIndices=[];if(minRowIndex<currentCanvasIndices.topRowIndex){var amount=currentCanvasIndices.topRowIndex-minRowIndex,addedRowIndices=Array.from(new Array(amount),(function(_,i){return currentCanvasIndices.topRowIndex-i-1}));totalAddedRowIndices.push.apply(totalAddedRowIndices,addedRowIndices)}if(maxRowIndex>currentCanvasIndices.bottomRowIndex){var _amount=maxRowIndex-currentCanvasIndices.bottomRowIndex,_addedRowIndices=Array.from(new Array(_amount),(function(_,i){return currentCanvasIndices.bottomRowIndex+i+1}));totalAddedRowIndices.push.apply(totalAddedRowIndices,_addedRowIndices)}if(minColumnIndex<currentCanvasIndices.leftColumnIndex){var _amount2=currentCanvasIndices.leftColumnIndex-minColumnIndex,addedColumnIndices=Array.from(new Array(_amount2),(function(_,i){return currentCanvasIndices.leftColumnIndex-i-1}));totalAddedColumnIndices.push.apply(totalAddedColumnIndices,addedColumnIndices)}if(maxColumnIndex>currentCanvasIndices.rightColumnIndex){var _amount3=maxColumnIndex-currentCanvasIndices.rightColumnIndex,_addedColumnIndices=Array.from(new Array(_amount3),(function(_,i){return currentCanvasIndices.rightColumnIndex+i+1}));totalAddedColumnIndices.push.apply(totalAddedColumnIndices,_addedColumnIndices)}(totalAddedRowIndices.length>0||totalAddedColumnIndices.length>0)&&this.addGridIndices({rowIndicesToAdd:totalAddedRowIndices,columnIndicesToAdd:totalAddedColumnIndices});var _step2,dataForAction=[],_iterator2=(0,createForOfIteratorHelper.Z)(data);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var change=_step2.value,previousColor=layer.getData().get(change.rowIndex).get(change.columnIndex).color,color=change.color;layer.getData().get(change.rowIndex).set(change.columnIndex,{color:change.color}),dataForAction.push((0,objectSpread2.Z)((0,objectSpread2.Z)({},change),{},{color,previousColor}))}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}return{dataForAction,totalAddedColumnIndices,totalAddedRowIndices}}},{key:"erasePixels",value:function erasePixels(data,layerId){if(!layerId&&this.layers.length>1)throw new Error("Must specify layerId when there are multiple layers");var layer=layerId?this.getLayer(layerId):this.getCurrentLayer();if(!layer)throw new Error("Cannot find layer");var _step3,dataForAction=[],_iterator3=(0,createForOfIteratorHelper.Z)(data);try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var change=_step3.value,previousColor=layer.getData().get(change.rowIndex).get(change.columnIndex).color;layer.getData().get(change.rowIndex).set(change.columnIndex,{color:""}),dataForAction.push((0,objectSpread2.Z)((0,objectSpread2.Z)({},change),{},{color:"",previousColor}))}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}return{dataForAction}}},{key:"addRow",value:function addRow(rowIndex){var validRowIndex=null;return this.layers.forEach((function(layer){validRowIndex=layer.addRowToData(rowIndex)})),{validRowIndex}}},{key:"addColumn",value:function addColumn(columnIndex){var validColumnIndex=null;return this.layers.forEach((function(layer){validColumnIndex=layer.addColumnToData(columnIndex)})),{validColumnIndex}}},{key:"deleteRow",value:function deleteRow(rowIndex){var validRowIndex=null;if(!this.getData().has(rowIndex))return{swipedPixels:[],validRowIndex};var swipedPixels=extractColoredPixelsFromRow(this.getData(),rowIndex);return this.layers.forEach((function(layer){validRowIndex=layer.deleteRowOfData(rowIndex)})),{swipedPixels,validRowIndex}}},{key:"deleteColumn",value:function deleteColumn(columnIndex){var validColumnIndex=null,firstRowKey=this.getData().keys().next().value;if(!this.getData().get(firstRowKey).has(columnIndex))return{swipedPixels:[],validColumnIndex};var swipedPixels=extractColoredPixelsFromColumn(this.getData(),columnIndex);return this.layers.forEach((function(layer){validColumnIndex=layer.deleteColumnOfData(columnIndex)})),{swipedPixels,validColumnIndex}}},{key:"addGridIndices",value:function addGridIndices(_ref6){var _step4,rowIndicesToAdd=_ref6.rowIndicesToAdd,columnIndicesToAdd=_ref6.columnIndicesToAdd,validRowIndices=[],validColumnIndices=[],_iterator4=(0,createForOfIteratorHelper.Z)(rowIndicesToAdd);try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var rowIndex=_step4.value,validRowIndex=this.addRow(rowIndex).validRowIndex;null!==validRowIndex&&validRowIndices.push(validRowIndex)}}catch(err){_iterator4.e(err)}finally{_iterator4.f()}var _step5,_iterator5=(0,createForOfIteratorHelper.Z)(columnIndicesToAdd);try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){var columnIndex=_step5.value,validColumnIndex=this.addColumn(columnIndex).validColumnIndex;null!==validColumnIndex&&validColumnIndices.push(validColumnIndex)}}catch(err){_iterator5.e(err)}finally{_iterator5.f()}return{validRowIndices,validColumnIndices}}},{key:"clear",value:function clear(){var clearedPixels=[];return this.layers.forEach((function(layer){var newPixels=layer.clearData().newPixels;clearedPixels.push({layerId:layer.getId(),data:newPixels})})),clearedPixels}},{key:"deleteGridIndices",value:function deleteGridIndices(_ref7){var _step6,rowIndicesToDelete=_ref7.rowIndicesToDelete,columnIndicesToDelete=_ref7.columnIndicesToDelete,validRowIndices=[],validColumnIndices=[],swipedPixels=[],_iterator6=(0,createForOfIteratorHelper.Z)(rowIndicesToDelete);try{for(_iterator6.s();!(_step6=_iterator6.n()).done;){var rowIndex=_step6.value,_this$deleteRow=this.deleteRow(rowIndex),swipedPixelsFromRow=_this$deleteRow.swipedPixels,validRowIndex=_this$deleteRow.validRowIndex;swipedPixels.push.apply(swipedPixels,(0,toConsumableArray.Z)(swipedPixelsFromRow)),null!==validRowIndex&&validRowIndices.push(validRowIndex)}}catch(err){_iterator6.e(err)}finally{_iterator6.f()}var _step7,_iterator7=(0,createForOfIteratorHelper.Z)(columnIndicesToDelete);try{for(_iterator7.s();!(_step7=_iterator7.n()).done;){var columnIndex=_step7.value,_this$deleteColumn=this.deleteColumn(columnIndex),swipedPixelsFromColumn=_this$deleteColumn.swipedPixels,validColumnIndex=_this$deleteColumn.validColumnIndex;swipedPixels.push.apply(swipedPixels,(0,toConsumableArray.Z)(swipedPixelsFromColumn)),null!==validColumnIndex&&validColumnIndices.push(validColumnIndex)}}catch(err){_iterator7.e(err)}finally{_iterator7.f()}return{swipedPixels,validColumnIndices,validRowIndices}}},{key:"updateCapturedImageBitmap",value:function updateCapturedImageBitmap(){var _this3=this,capturedPanZoomValue={offset:(0,objectSpread2.Z)({},this.panZoom.offset),scale:this.panZoom.scale},squareLength=this.gridSquareLength*this.panZoom.scale,allRowKeys=getRowKeysFromData(this.getData()),allColumnKeys=getColumnKeysFromData(this.getData()),imageWidth=allColumnKeys.length*squareLength,imageHeight=allRowKeys.length*squareLength;imageWidth>config.X1&&(squareLength=config.X1/allColumnKeys.length,capturedPanZoomValue.scale=squareLength/this.gridSquareLength),imageHeight>config.X1&&(squareLength=config.X1/allRowKeys.length,capturedPanZoomValue.scale=squareLength/this.gridSquareLength);var width=this.dpr?allColumnKeys.length*squareLength*this.dpr:allColumnKeys.length*squareLength,height=this.dpr?allRowKeys.length*squareLength*this.dpr:allRowKeys.length*squareLength,canvas=new OffscreenCanvas(width,height),fakeCtx=canvas.getContext("2d");if(!fakeCtx)throw new Error("Cannot get context");this.defaultPixelColor&&(fakeCtx.save(),fakeCtx.fillStyle=this.defaultPixelColor,fakeCtx.fillRect(0,0,squareLength*allColumnKeys.length*this.dpr,squareLength*allRowKeys.length*this.dpr),fakeCtx.restore()),fakeCtx.save();var _step8,_iterator8=(0,createForOfIteratorHelper.Z)(allRowKeys);try{for(_iterator8.s();!(_step8=_iterator8.n()).done;){var _step9,i=_step8.value,_iterator9=(0,createForOfIteratorHelper.Z)(allColumnKeys);try{var _loop=function _loop(){var j=_step9.value,rowIndex=i,columnIndex=j,relativeRowIndex=_this3.rowKeyOrderMap.get(rowIndex),relativeColumnIndex=_this3.columnKeyOrderMap.get(columnIndex);if(void 0===relativeRowIndex||void 0===relativeColumnIndex)return"continue";var color=_this3.layers.slice().reverse().reduce((function(acc,layer){var _layer$getData$get,_layer$getData$get$ge;if(!1===layer.getIsVisible())return acc;var layerColor=null===(_layer$getData$get=layer.getData().get(rowIndex))||void 0===_layer$getData$get||null===(_layer$getData$get$ge=_layer$getData$get.get(columnIndex))||void 0===_layer$getData$get$ge?void 0:_layer$getData$get$ge.color;return layerColor||acc}),"");if(!color)return"continue";fakeCtx.fillStyle=color,fakeCtx.fillRect(relativeColumnIndex*squareLength*_this3.dpr,relativeRowIndex*squareLength*_this3.dpr,squareLength*_this3.dpr,squareLength*_this3.dpr)};for(_iterator9.s();!(_step9=_iterator9.n()).done;)_loop()}catch(err){_iterator9.e(err)}finally{_iterator9.f()}}}catch(err){_iterator8.e(err)}finally{_iterator8.f()}fakeCtx.restore(),this.capturedImageBitmapScale=capturedPanZoomValue.scale,this.capturedImageBitmap=canvas.transferToImageBitmap()}},{key:"render",value:function render(){var _this4=this,ctx=this.ctx,squareLength=this.gridSquareLength*this.panZoom.scale,allRowKeys=getRowKeysFromData(this.getData()),allColumnKeys=getColumnKeysFromData(this.getData()),leftTopPoint={x:this.leftColumnIndex*this.gridSquareLength,y:this.topRowIndex*this.gridSquareLength};ctx.clearRect(0,0,this.width,this.height);var correctedLeftTopScreenPoint=getScreenPoint(convertCartesianToScreen(this.element,leftTopPoint,this.dpr),this.panZoom);this.defaultPixelColor&&(ctx.save(),ctx.fillStyle=this.defaultPixelColor,ctx.fillRect(correctedLeftTopScreenPoint.x,correctedLeftTopScreenPoint.y,squareLength*allColumnKeys.length,squareLength*allRowKeys.length),ctx.restore()),ctx.save();var _step10,_iterator10=(0,createForOfIteratorHelper.Z)(allRowKeys);try{for(_iterator10.s();!(_step10=_iterator10.n()).done;){var _step11,i=_step10.value,_iterator11=(0,createForOfIteratorHelper.Z)(allColumnKeys);try{var _loop2=function _loop2(){var j=_step11.value,rowIndex=i,columnIndex=j,relativeRowIndex=_this4.rowKeyOrderMap.get(rowIndex),relativeColumnIndex=_this4.columnKeyOrderMap.get(columnIndex);if(void 0===relativeRowIndex||void 0===relativeColumnIndex)return"continue";var color=_this4.layers.slice().reverse().reduce((function(acc,layer){var _layer$getData$get2,_layer$getData$get2$g;if(!1===layer.getIsVisible())return acc;var layerColor=null===(_layer$getData$get2=layer.getData().get(rowIndex))||void 0===_layer$getData$get2||null===(_layer$getData$get2$g=_layer$getData$get2.get(columnIndex))||void 0===_layer$getData$get2$g?void 0:_layer$getData$get2$g.color;return layerColor||acc}),"");if(!color)return"continue";ctx.fillStyle=color,ctx.fillRect(relativeColumnIndex*squareLength+correctedLeftTopScreenPoint.x,relativeRowIndex*squareLength+correctedLeftTopScreenPoint.y,squareLength,squareLength)};for(_iterator11.s();!(_step11=_iterator11.n()).done;)_loop2()}catch(err){_iterator11.e(err)}finally{_iterator11.f()}}}catch(err){_iterator10.e(err)}finally{_iterator10.f()}return ctx.restore(),{rowKeys:allRowKeys,columnKeys:allColumnKeys}}},{key:"renderImageBitmap",value:function renderImageBitmap(){if(!this.capturedImageBitmap)throw new Error("Captured image data is null");var leftTopPoint={x:this.leftColumnIndex*this.gridSquareLength,y:this.topRowIndex*this.gridSquareLength},correctedLeftTopScreenPoint=getScreenPoint(convertCartesianToScreen(this.element,leftTopPoint,this.dpr),this.panZoom),newScale=this.panZoom.scale/this.capturedImageBitmapScale,newWidth=this.capturedImageBitmap.width/this.dpr*newScale,newHeight=this.capturedImageBitmap.height/this.dpr*newScale;this.ctx.save(),this.ctx.clearRect(0,0,this.width,this.height),this.ctx.drawImage(this.capturedImageBitmap,correctedLeftTopScreenPoint.x,correctedLeftTopScreenPoint.y,newWidth,newHeight),this.ctx.restore()}}]),DataLayer}(BaseLayer),drawArrowHead=(__webpack_require__("./node_modules/core-js/modules/es.array.fill.js"),function drawArrowHead(ctx,x,y,radians,scale,arrowWidth){ctx.save(),ctx.beginPath(),ctx.translate(x,y),ctx.rotate(radians),ctx.moveTo(0,0),ctx.lineTo(arrowWidth/2*scale,5*scale),ctx.lineTo(-arrowWidth/2*scale,5*scale),ctx.closePath(),ctx.fillStyle="#000000",ctx.fill(),ctx.restore(),ctx.save(),ctx.beginPath(),ctx.translate(x,y),ctx.rotate(radians),ctx.moveTo(0,0),ctx.lineTo(0,8*scale),ctx.stroke(),ctx.closePath(),ctx.fillStyle="#000000",ctx.fill(),ctx.restore()}),drawExtendButton=function drawExtendButton(ctx,leftTopPos,color,buttonWidth,buttonHeight,scale){ctx.save(),ctx.fillStyle=color,ctx.fillRect(leftTopPos.x,leftTopPos.y,buttonWidth*scale,buttonHeight*scale),ctx.restore()},drawRect=function drawRect(ctx,leftTopPosX,leftTopPosY,width,height,fillStyle,strokeStyle,lineWidth){ctx.save(),ctx.beginPath(),ctx.rect(leftTopPosX,leftTopPosY,width,height),ctx.fillStyle=fillStyle,ctx.lineWidth=lineWidth,ctx.fill(),ctx.strokeStyle=strokeStyle,ctx.stroke(),ctx.restore()},GridLayer=function(_BaseLayer){(0,inherits.Z)(GridLayer,_BaseLayer);var _super=(0,createSuper.Z)(GridLayer);function GridLayer(_ref){var _this,columnCount=_ref.columnCount,rowCount=_ref.rowCount,canvas=_ref.canvas;return(0,classCallCheck.Z)(this,GridLayer),(_this=_super.call(this,{canvas})).columnCount=void 0,_this.rowCount=void 0,_this.isGridVisible=!0,_this.isGridFixed=!1,_this.gridStrokeColor=void 0,_this.gridStrokeWidth=void 0,_this.gridSquareLength=config.IA,_this.buttonHeight=config.L2,_this.buttonMargin=config.Qz,_this.extendArrowPadding=config.BN,_this.hoveredButton=null,_this.topButtonDimensions={x:0,y:0,width:0,height:0},_this.bottomButtonDimensions={x:0,y:0,width:0,height:0},_this.leftButtonDimensions={x:0,y:0,width:0,height:0},_this.rightButtonDimensions={x:0,y:0,width:0,height:0},_this.topLeftButtonDimensions={x:0,y:0,width:0,height:0},_this.topRightButtonDimensions={x:0,y:0,width:0,height:0},_this.bottomLeftButtonDimensions={x:0,y:0,width:0,height:0},_this.bottomRightButtonDimensions={x:0,y:0,width:0,height:0},_this.columnCount=columnCount,_this.rowCount=rowCount,_this.ctx=canvas.getContext("2d"),_this.element=canvas,_this}return(0,createClass.Z)(GridLayer,[{key:"setColumnCount",value:function setColumnCount(columnCount){this.columnCount=columnCount}},{key:"setRowCount",value:function setRowCount(rowCount){this.rowCount=rowCount}},{key:"setIsGridVisible",value:function setIsGridVisible(isGridVisible){void 0!==isGridVisible&&(this.isGridVisible=isGridVisible)}},{key:"getIsGridVisible",value:function getIsGridVisible(){return this.isGridVisible}},{key:"setIsGridFixed",value:function setIsGridFixed(isGridFixed){void 0!==isGridFixed&&(this.isGridFixed=isGridFixed)}},{key:"getIsGridFixed",value:function getIsGridFixed(){return this.isGridFixed}},{key:"getHoveredButton",value:function getHoveredButton(){return this.hoveredButton}},{key:"setGridStrokeColor",value:function setGridStrokeColor(gridStrokeColor){""===gridStrokeColor&&void 0===gridStrokeColor||(this.gridStrokeColor=gridStrokeColor)}},{key:"setGridSquareLength",value:function setGridSquareLength(gridSquareLength){this.gridSquareLength=gridSquareLength}},{key:"getGridStrokeColor",value:function getGridStrokeColor(){return this.gridStrokeColor}},{key:"setGridStrokeWidth",value:function setGridStrokeWidth(gridStrokeWidth){0===gridStrokeWidth&&void 0===gridStrokeWidth||(this.gridStrokeWidth=gridStrokeWidth)}},{key:"getGridStrokeWidth",value:function getGridStrokeWidth(){return this.gridStrokeWidth}},{key:"setHoveredButton",value:function setHoveredButton(hoveredButton){this.hoveredButton=hoveredButton}},{key:"getButtonsDimensions",value:function getButtonsDimensions(){return{top:this.topButtonDimensions,bottom:this.bottomButtonDimensions,left:this.leftButtonDimensions,right:this.rightButtonDimensions,topLeft:this.topLeftButtonDimensions,topRight:this.topRightButtonDimensions,bottomLeft:this.bottomLeftButtonDimensions,bottomRight:this.bottomRightButtonDimensions}}},{key:"findLeftTopPosForButton",value:function findLeftTopPosForButton(direction,buttonWidth,buttonHeight,gridLeftTopWorldPos){var gridsWidth=this.gridSquareLength*this.columnCount,gridsHeight=this.gridSquareLength*this.rowCount,buttonPos={x:gridLeftTopWorldPos.x,y:gridLeftTopWorldPos.y};if(direction===config.pr.LEFT)buttonPos.x+=-this.buttonMargin-buttonWidth/2;else if(direction===config.pr.RIGHT)buttonPos.x+=gridsWidth+this.buttonMargin-buttonWidth/2;else if(direction===config.pr.TOP)buttonPos.y+=-this.buttonMargin-buttonHeight/2;else if(direction===config.pr.BOTTOM)buttonPos.y+=gridsHeight+this.buttonMargin-buttonHeight/2;else if(direction===config.pr.TOPLEFT)buttonPos.x+=-this.buttonMargin-buttonWidth/2,buttonPos.y+=-this.buttonMargin-buttonHeight/2;else if(direction===config.pr.TOPRIGHT)buttonPos.x+=gridsWidth+this.buttonMargin-buttonWidth/2,buttonPos.y+=-this.buttonMargin-buttonHeight/2;else if(direction===config.pr.BOTTOMLEFT)buttonPos.x+=-this.buttonMargin-buttonWidth/2,buttonPos.y+=gridsHeight+this.buttonMargin-buttonHeight/2;else{if(direction!==config.pr.BOTTOMRIGHT)throw new Error("Invalid button direction");buttonPos.x+=gridsWidth+this.buttonMargin-buttonWidth/2,buttonPos.y+=gridsHeight+this.buttonMargin-buttonHeight/2}return{worldPos:buttonPos,screenPos:getScreenPoint(convertCartesianToScreen(this.element,buttonPos,this.dpr),this.panZoom)}}},{key:"drawRightButton",value:function drawRightButton(color,gridTopLeftCornerPos){var width=this.buttonHeight,height=this.rowCount*this.gridSquareLength,_this$findLeftTopPosF=this.findLeftTopPosForButton(config.pr.RIGHT,width,height,gridTopLeftCornerPos),screenPos=_this$findLeftTopPosF.screenPos,worldPos=_this$findLeftTopPosF.worldPos;this.rightButtonDimensions={x:worldPos.x,y:worldPos.y,width,height},drawExtendButton(this.ctx,screenPos,color,width,height,this.panZoom.scale),drawArrowHead(this.ctx,screenPos.x+this.extendArrowPadding*this.panZoom.scale,screenPos.y+height*this.panZoom.scale/2,-Math.PI/2,this.panZoom.scale,5),drawArrowHead(this.ctx,screenPos.x+(width-this.extendArrowPadding)*this.panZoom.scale,screenPos.y+height*this.panZoom.scale/2,Math.PI/2,this.panZoom.scale,5)}},{key:"drawLeftButton",value:function drawLeftButton(color,gridTopLeftCornerPos){var width=this.buttonHeight,height=this.rowCount*this.gridSquareLength,_this$findLeftTopPosF2=this.findLeftTopPosForButton(config.pr.LEFT,width,height,gridTopLeftCornerPos),screenPos=_this$findLeftTopPosF2.screenPos,worldPos=_this$findLeftTopPosF2.worldPos;this.leftButtonDimensions={x:worldPos.x,y:worldPos.y,width,height},drawExtendButton(this.ctx,screenPos,color,width,height,this.panZoom.scale),drawArrowHead(this.ctx,screenPos.x+this.extendArrowPadding*this.panZoom.scale,screenPos.y+height*this.panZoom.scale/2,-Math.PI/2,this.panZoom.scale,5),drawArrowHead(this.ctx,screenPos.x+(width-this.extendArrowPadding)*this.panZoom.scale,screenPos.y+height*this.panZoom.scale/2,Math.PI/2,this.panZoom.scale,5)}},{key:"drawTopButton",value:function drawTopButton(color,gridTopLeftCornerPos){var width=this.columnCount*this.gridSquareLength,height=this.buttonHeight,_this$findLeftTopPosF3=this.findLeftTopPosForButton(config.pr.TOP,width,height,gridTopLeftCornerPos),screenPos=_this$findLeftTopPosF3.screenPos,worldPos=_this$findLeftTopPosF3.worldPos;this.topButtonDimensions={x:worldPos.x,y:worldPos.y,width,height},drawExtendButton(this.ctx,screenPos,color,width,height,this.panZoom.scale),drawArrowHead(this.ctx,screenPos.x+width*this.panZoom.scale/2,screenPos.y+this.extendArrowPadding*this.panZoom.scale,2*Math.PI,this.panZoom.scale,5),drawArrowHead(this.ctx,screenPos.x+width*this.panZoom.scale/2,screenPos.y+(height-this.extendArrowPadding)*this.panZoom.scale,Math.PI,this.panZoom.scale,5)}},{key:"drawBottomButton",value:function drawBottomButton(color,gridTopLeftCornerPos){var width=this.columnCount*this.gridSquareLength,height=this.buttonHeight,_this$findLeftTopPosF4=this.findLeftTopPosForButton(config.pr.BOTTOM,width,height,gridTopLeftCornerPos),screenPos=_this$findLeftTopPosF4.screenPos,worldPos=_this$findLeftTopPosF4.worldPos;this.bottomButtonDimensions={x:worldPos.x,y:worldPos.y,width,height},drawExtendButton(this.ctx,screenPos,color,width,height,this.panZoom.scale),drawArrowHead(this.ctx,screenPos.x+width*this.panZoom.scale/2,screenPos.y+this.extendArrowPadding*this.panZoom.scale,2*Math.PI,this.panZoom.scale,5),drawArrowHead(this.ctx,screenPos.x+width*this.panZoom.scale/2,screenPos.y+(height-this.extendArrowPadding)*this.panZoom.scale,Math.PI,this.panZoom.scale,5)}},{key:"drawDiagonalButtons",value:function drawDiagonalButtons(color,direction,gridTopLeftCornerPos){var height=this.buttonHeight,width=this.buttonHeight,_this$findLeftTopPosF5=this.findLeftTopPosForButton(direction,width,height,gridTopLeftCornerPos),screenPos=_this$findLeftTopPosF5.screenPos,worldPos=_this$findLeftTopPosF5.worldPos;switch(drawExtendButton(this.ctx,screenPos,color,width,height,this.panZoom.scale),drawArrowHead(this.ctx,direction===config.pr.TOPLEFT||direction===config.pr.BOTTOMRIGHT?screenPos.x+this.extendArrowPadding*Math.sqrt(2)*this.panZoom.scale:screenPos.x+(width-this.extendArrowPadding*Math.sqrt(2))*this.panZoom.scale,screenPos.y+this.extendArrowPadding*Math.sqrt(2)*this.panZoom.scale,direction===config.pr.TOPLEFT||direction===config.pr.BOTTOMRIGHT?-1*Math.PI/4:1*Math.PI/4,this.panZoom.scale,5),drawArrowHead(this.ctx,direction===config.pr.TOPLEFT||direction===config.pr.BOTTOMRIGHT?screenPos.x+(width-this.extendArrowPadding*Math.sqrt(2))*this.panZoom.scale:screenPos.x+this.extendArrowPadding*Math.sqrt(2)*this.panZoom.scale,screenPos.y+(height-this.extendArrowPadding*Math.sqrt(2))*this.panZoom.scale,direction===config.pr.TOPLEFT||direction===config.pr.BOTTOMRIGHT?3*Math.PI/4:-3*Math.PI/4,this.panZoom.scale,5),direction){case config.pr.TOPLEFT:this.topLeftButtonDimensions={x:worldPos.x,y:worldPos.y,width,height};break;case config.pr.TOPRIGHT:this.topRightButtonDimensions={x:worldPos.x,y:worldPos.y,width,height};break;case config.pr.BOTTOMLEFT:this.bottomLeftButtonDimensions={x:worldPos.x,y:worldPos.y,width,height};break;case config.pr.BOTTOMRIGHT:this.bottomRightButtonDimensions={x:worldPos.x,y:worldPos.y,width,height}}}},{key:"drawSurroundingDashedLines",value:function drawSurroundingDashedLines(correctedLefTopScreenPoint){var offsetFromPixelCanvas=config.Xp*this.panZoom.scale,ctx=this.ctx;ctx.save();var dash=5*this.panZoom.scale,gap=5*this.panZoom.scale;ctx.setLineDash([dash,gap]),ctx.strokeStyle="#333333",ctx.lineWidth=1;var squareLength=this.gridSquareLength*this.panZoom.scale;ctx.beginPath(),ctx.moveTo(correctedLefTopScreenPoint.x-offsetFromPixelCanvas,correctedLefTopScreenPoint.y-offsetFromPixelCanvas),ctx.lineTo(correctedLefTopScreenPoint.x+this.columnCount*squareLength+offsetFromPixelCanvas,correctedLefTopScreenPoint.y-offsetFromPixelCanvas),ctx.lineTo(correctedLefTopScreenPoint.x+this.columnCount*squareLength+offsetFromPixelCanvas,correctedLefTopScreenPoint.y+this.rowCount*squareLength+offsetFromPixelCanvas),ctx.lineTo(correctedLefTopScreenPoint.x-offsetFromPixelCanvas,correctedLefTopScreenPoint.y+this.rowCount*squareLength+offsetFromPixelCanvas),ctx.lineTo(correctedLefTopScreenPoint.x-offsetFromPixelCanvas,correctedLefTopScreenPoint.y-offsetFromPixelCanvas),ctx.stroke(),ctx.restore()}},{key:"drawCircleButtonAlongDashedLine",value:function drawCircleButtonAlongDashedLine(correctedLefTopScreenPoint){var offsetFromPixelCanvas=config.Xp*this.panZoom.scale,ctx=this.ctx,squareLength=this.gridSquareLength*this.panZoom.scale,leftTopCorner={x:correctedLefTopScreenPoint.x-offsetFromPixelCanvas,y:correctedLefTopScreenPoint.y-offsetFromPixelCanvas},radius=config.Ni*this.panZoom.scale;[leftTopCorner,{x:correctedLefTopScreenPoint.x+this.columnCount*squareLength/2,y:correctedLefTopScreenPoint.y-offsetFromPixelCanvas},{x:correctedLefTopScreenPoint.x+this.columnCount*squareLength+offsetFromPixelCanvas,y:correctedLefTopScreenPoint.y-offsetFromPixelCanvas},{x:correctedLefTopScreenPoint.x+this.columnCount*squareLength+offsetFromPixelCanvas,y:correctedLefTopScreenPoint.y+this.rowCount*squareLength/2},{x:correctedLefTopScreenPoint.x+this.columnCount*squareLength+offsetFromPixelCanvas,y:correctedLefTopScreenPoint.y+this.rowCount*squareLength+offsetFromPixelCanvas},{x:correctedLefTopScreenPoint.x+this.columnCount*squareLength/2,y:correctedLefTopScreenPoint.y+this.rowCount*squareLength+offsetFromPixelCanvas},{x:correctedLefTopScreenPoint.x-offsetFromPixelCanvas,y:correctedLefTopScreenPoint.y+this.rowCount*squareLength+offsetFromPixelCanvas},{x:correctedLefTopScreenPoint.x-offsetFromPixelCanvas,y:correctedLefTopScreenPoint.y+this.rowCount*squareLength/2}].forEach((function(position){return function drawCircle(ctx,center,radius,fillStyle,strokeStyle,strokeWidth){ctx.save(),ctx.beginPath(),ctx.arc(center.x,center.y,radius,0,2*Math.PI),ctx.fillStyle=fillStyle,ctx.fill(),ctx.lineWidth=strokeWidth,ctx.strokeStyle=strokeStyle,ctx.stroke(),ctx.restore()}(ctx,position,radius,"#ffffff","#5A7FF7",1)}))}},{key:"drawButtons",value:function drawButtons(gridTopLeftCornerPos){var _this2=this;this.drawTopButton(this.hoveredButton===config.pr.TOP?"rgba(50,50,50,0.4)":"transparent",gridTopLeftCornerPos),this.drawBottomButton(this.hoveredButton===config.pr.BOTTOM?"rgba(50,50,50,0.4)":"transparent",gridTopLeftCornerPos),this.drawLeftButton(this.hoveredButton===config.pr.LEFT?"rgba(50,50,50,0.4)":"transparent",gridTopLeftCornerPos),this.drawRightButton(this.hoveredButton===config.pr.RIGHT?"rgba(50,50,50,0.4)":"transparent",gridTopLeftCornerPos),[config.pr.TOPLEFT,config.pr.TOPRIGHT,config.pr.BOTTOMLEFT,config.pr.BOTTOMRIGHT].forEach((function(direction){return _this2.drawDiagonalButtons(_this2.hoveredButton===direction?"rgba(50,50,50,0.4)":"transparent",direction,gridTopLeftCornerPos)}))}},{key:"renderSelection",value:function renderSelection(area){var ctx=this.ctx,startWorldPos=area.startWorldPos,endWorldPos=area.endWorldPos,convertedStartWorldPos=convertCartesianToScreen(this.element,startWorldPos,this.dpr),convertedEndWorldPos=convertCartesianToScreen(this.element,endWorldPos,this.dpr),startScreenPos=getScreenPoint(convertedStartWorldPos,this.panZoom),endScreenPos=getScreenPoint(convertedEndWorldPos,this.panZoom);ctx.save(),ctx.beginPath(),ctx.moveTo(startScreenPos.x,startScreenPos.y),ctx.lineTo(endScreenPos.x,startScreenPos.y),ctx.lineTo(endScreenPos.x,endScreenPos.y),ctx.lineTo(startScreenPos.x,endScreenPos.y),ctx.lineTo(startScreenPos.x,startScreenPos.y),ctx.closePath(),ctx.strokeStyle="#fc933c",ctx.lineWidth=5,ctx.stroke(),ctx.restore()}},{key:"render",value:function render(){var ctx=this.ctx;ctx.clearRect(0,0,this.width,this.height);var squareLength=this.gridSquareLength*this.panZoom.scale,leftTopPoint={x:this.leftColumnIndex*this.gridSquareLength,y:this.topRowIndex*this.gridSquareLength},correctedScreenPoint=getScreenPoint(convertCartesianToScreen(this.element,leftTopPoint,this.dpr),this.panZoom);if(this.isGridFixed||(this.drawButtons(leftTopPoint),this.drawSurroundingDashedLines(correctedScreenPoint),this.drawCircleButtonAlongDashedLine(correctedScreenPoint)),this.isGridVisible){ctx.save(),ctx.lineWidth=this.gridStrokeWidth,ctx.strokeStyle=this.gridStrokeColor;for(var i=0;i<=this.columnCount;i++)0!==i&&i!==this.columnCount||(ctx.beginPath(),ctx.moveTo(correctedScreenPoint.x+i*squareLength,correctedScreenPoint.y-this.gridStrokeWidth/2),ctx.lineTo(correctedScreenPoint.x+i*squareLength,correctedScreenPoint.y+this.rowCount*squareLength+this.gridStrokeWidth/2),ctx.stroke(),ctx.closePath()),ctx.beginPath(),ctx.moveTo(correctedScreenPoint.x+i*squareLength,correctedScreenPoint.y),ctx.lineTo(correctedScreenPoint.x+i*squareLength,correctedScreenPoint.y+this.rowCount*squareLength),ctx.stroke(),ctx.closePath();for(var j=0;j<=this.rowCount;j++)0!==j&&j!==this.rowCount||(ctx.beginPath(),ctx.moveTo(correctedScreenPoint.x-this.gridStrokeWidth/2,correctedScreenPoint.y+j*squareLength),ctx.lineTo(correctedScreenPoint.x+this.columnCount*squareLength+this.gridStrokeWidth/2,correctedScreenPoint.y+j*squareLength),ctx.stroke(),ctx.closePath()),ctx.beginPath(),ctx.moveTo(correctedScreenPoint.x,correctedScreenPoint.y+j*squareLength),ctx.lineTo(correctedScreenPoint.x+this.columnCount*squareLength,correctedScreenPoint.y+j*squareLength),ctx.stroke(),ctx.closePath();ctx.restore()}}}]),GridLayer}(BaseLayer),types=(__webpack_require__("./node_modules/core-js/modules/es.array.is-array.js"),__webpack_require__("./src/components/Canvas/types.ts"));__webpack_require__("./node_modules/core-js/modules/es.string.split.js"),__webpack_require__("./node_modules/core-js/modules/es.regexp.exec.js"),__webpack_require__("./node_modules/core-js/modules/es.parse-int.js");function generatePixelId(rowIndex,columnIndex){return"".concat(rowIndex,"*").concat(columnIndex)}var ActionType,PixelChangeRecords=function(){function PixelChangeRecords(){(0,classCallCheck.Z)(this,PixelChangeRecords),this.rawChanges=void 0,this.effectiveChangesMap=void 0,this.rawChanges=[],this.effectiveChangesMap=new Map}return(0,createClass.Z)(PixelChangeRecords,[{key:"record",value:function record(pixel){if(this.rawChanges.length>0){var mostRecentRawChange=this.rawChanges[this.rawChanges.length-1];mostRecentRawChange.rowIndex===pixel.rowIndex&&mostRecentRawChange.columnIndex===pixel.columnIndex&&mostRecentRawChange.color===pixel.color&&mostRecentRawChange.previousColor===pixel.previousColor||this.rawChanges.push(pixel)}else this.rawChanges.push(pixel);var rowIndex=pixel.rowIndex,columnIndex=pixel.columnIndex,color=pixel.color,previousColor=pixel.previousColor,pixelId=generatePixelId(rowIndex,columnIndex);if(this.effectiveChangesMap.has(pixelId)){var originalPreviousColor=this.effectiveChangesMap.get(pixelId).previousColor;this.effectiveChangesMap.set(pixelId,{color,previousColor:originalPreviousColor})}else this.effectiveChangesMap.set(pixelId,{color,previousColor})}},{key:"reset",value:function reset(){this.rawChanges=[],this.effectiveChangesMap=new Map}},{key:"getIsChanged",value:function getIsChanged(){return this.effectiveChangesMap.size>0}},{key:"getRawChanges",value:function getRawChanges(){return this.rawChanges}},{key:"getEffectiveChanges",value:function getEffectiveChanges(){var result=[];return this.effectiveChangesMap.forEach((function(item,pixelId){var _parsePixelId=function parsePixelId(pixelId){var _pixelId$split=pixelId.split("*"),_pixelId$split2=(0,slicedToArray.Z)(_pixelId$split,2),rowIndex=_pixelId$split2[0],columnIndex=_pixelId$split2[1];return{rowIndex:parseInt(rowIndex),columnIndex:parseInt(columnIndex)}}(pixelId),rowIndex=_parsePixelId.rowIndex,columnIndex=_parsePixelId.columnIndex;result.push({rowIndex,columnIndex,color:item.color,previousColor:item.previousColor})})),result}}]),PixelChangeRecords}(),InteractionLayer=function(_BaseLayer){(0,inherits.Z)(InteractionLayer,_BaseLayer);var _super=(0,createSuper.Z)(InteractionLayer);function InteractionLayer(_ref){var _this,columnCount=_ref.columnCount,rowCount=_ref.rowCount,canvas=_ref.canvas;return(0,classCallCheck.Z)(this,InteractionLayer),(_this=_super.call(this,{canvas})).strokedPixelRecords=new Map,_this.erasedPixelRecords=new Map,_this.tempStrokedPixels=[],_this.indicatorPixels=[],_this.dataLayerRowCount=void 0,_this.dataLayerColumnCount=void 0,_this.backgroundColor=config.XM,_this.defaultPixelColor=config.vP,_this.backgroundMode="color",_this.selectingArea=null,_this.brushPattern=[[types.a3.FILL]],_this.selectedArea=null,_this.directionToExtendSelectedArea=null,_this.movingSelectedArea=null,_this.movingSelectedPixels=null,_this.extendingSelectedArea=null,_this.extendingSelectedPixels=[],_this.capturedBaseExtendingSelectedArea=null,_this.capturedBaseExtendingSelectedAreaPixels=null,_this.selectedAreaPixels=null,_this.capturedData=null,_this.capturedDataOriginalIndices=null,_this.hoveredPixel=null,_this.gridSquareLength=config.IA,_this.dataLayerColumnCount=columnCount,_this.dataLayerRowCount=rowCount,_this}return(0,createClass.Z)(InteractionLayer,[{key:"getCapturedData",value:function getCapturedData(){return this.capturedData}},{key:"getDirectionToExtendSelectedArea",value:function getDirectionToExtendSelectedArea(){return this.directionToExtendSelectedArea}},{key:"getCapturedDataOriginalIndices",value:function getCapturedDataOriginalIndices(){return this.capturedDataOriginalIndices}},{key:"getBrushPattern",value:function getBrushPattern(){return this.brushPattern}},{key:"setBrushPattern",value:function setBrushPattern(pattern){this.brushPattern=pattern}},{key:"setGridSquareLength",value:function setGridSquareLength(length){this.gridSquareLength=length}},{key:"setDefaultPixelColor",value:function setDefaultPixelColor(color){this.defaultPixelColor=color}},{key:"setDataLayerColumnCount",value:function setDataLayerColumnCount(columnCount){this.dataLayerColumnCount=columnCount}},{key:"setDataLayerRowCount",value:function setDataLayerRowCount(rowCount){this.dataLayerRowCount=rowCount}},{key:"setDirectionToExtendSelectedArea",value:function setDirectionToExtendSelectedArea(direction){this.directionToExtendSelectedArea=direction}},{key:"setSelectedArea",value:function setSelectedArea(area){this.selectedArea=area}},{key:"setSelectingArea",value:function setSelectingArea(area){this.selectingArea=area}},{key:"setMovingSelectedPixels",value:function setMovingSelectedPixels(pixels){this.movingSelectedPixels=pixels}},{key:"setMovingSelectedArea",value:function setMovingSelectedArea(area){this.movingSelectedArea=area}},{key:"setExtendingSelectedPixels",value:function setExtendingSelectedPixels(pixels){this.extendingSelectedPixels=pixels}},{key:"setExtendingSelectedArea",value:function setExtendingSelectedArea(area){this.extendingSelectedArea=area}},{key:"setSelectedAreaPixels",value:function setSelectedAreaPixels(pixelArray){this.selectedAreaPixels=pixelArray}},{key:"setBackgroundColor",value:function setBackgroundColor(color){this.backgroundColor=color||config.XM}},{key:"setCapturedData",value:function setCapturedData(gridChangeStartCapturedData){this.capturedData=new Map;for(var _i=0,_Array$from=Array.from(gridChangeStartCapturedData.entries());_i<_Array$from.length;_i++){var row=_Array$from[_i],_row=(0,slicedToArray.Z)(row,2),rowIndex=_row[0],rowData=_row[1];this.capturedData.set(rowIndex,new Map(rowData))}this.capturedDataOriginalIndices=getGridIndicesFromData(gridChangeStartCapturedData)}},{key:"setCapturedBaseExtendingSelectedArea",value:function setCapturedBaseExtendingSelectedArea(capturedBaseExtendingSelectedArea){this.capturedBaseExtendingSelectedArea=capturedBaseExtendingSelectedArea}},{key:"setCapturedBaseExtendingSelectedAreaPixels",value:function setCapturedBaseExtendingSelectedAreaPixels(capturedBaseExtendingSelectedAreaPixels){this.capturedBaseExtendingSelectedAreaPixels=capturedBaseExtendingSelectedAreaPixels}},{key:"resetCapturedData",value:function resetCapturedData(){this.capturedData=null,this.capturedDataOriginalIndices=null,this.deleteStrokePixelRecord(config.s9)}},{key:"getHoveredPixel",value:function getHoveredPixel(){return this.hoveredPixel}},{key:"getMovingSelectedPixels",value:function getMovingSelectedPixels(){return this.movingSelectedPixels}},{key:"getMovingSelectedArea",value:function getMovingSelectedArea(){return this.movingSelectedArea}},{key:"getExtendingSelectedArea",value:function getExtendingSelectedArea(){return this.extendingSelectedArea}},{key:"getExtendingSelectedPixels",value:function getExtendingSelectedPixels(){return this.extendingSelectedPixels}},{key:"setHoveredPixel",value:function setHoveredPixel(hoveredPixel){this.hoveredPixel=hoveredPixel}},{key:"getSelectingArea",value:function getSelectingArea(){return this.selectingArea}},{key:"getSelectedArea",value:function getSelectedArea(){return this.selectedArea}},{key:"getSelectedAreaPixels",value:function getSelectedAreaPixels(){return this.selectedAreaPixels}},{key:"getStrokedPixelRecords",value:function getStrokedPixelRecords(){return this.strokedPixelRecords}},{key:"getEffectiveStrokePixelChanges",value:function getEffectiveStrokePixelChanges(userId){return this.strokedPixelRecords.has(userId)?this.strokedPixelRecords.get(userId).getEffectiveChanges():[]}},{key:"getErasedPixelRecords",value:function getErasedPixelRecords(){return this.erasedPixelRecords}},{key:"getEffectiveEraserPixelChanges",value:function getEffectiveEraserPixelChanges(userId){return this.erasedPixelRecords.has(userId)?this.erasedPixelRecords.get(userId).getEffectiveChanges():[]}},{key:"getIndicatorPixels",value:function getIndicatorPixels(){return this.indicatorPixels}},{key:"detectSelectedAreaExtendDirection",value:function detectSelectedAreaExtendDirection(coord){if(!this.selectedArea)return null;var extensionAllowanceRatio=config.fA,strokeTouchingRange=config.Tf,scaledXWidth=(lerpRanges(this.panZoom.scale,config.G6,config.Vb,strokeTouchingRange,strokeTouchingRange*extensionAllowanceRatio),lerpRanges(this.panZoom.scale,config.G6,config.Vb,strokeTouchingRange,strokeTouchingRange*extensionAllowanceRatio)),x=coord.x,y=coord.y,selectedAreaWidth=this.selectedArea.endWorldPos.x-this.selectedArea.startWorldPos.x,selectedAreaHeight=this.selectedArea.endWorldPos.y-this.selectedArea.startWorldPos.y,top_x=this.selectedArea.startWorldPos.x,top_y=this.selectedArea.startWorldPos.y,top_width=selectedAreaWidth,bottom_x=this.selectedArea.startWorldPos.x,bottom_y=this.selectedArea.endWorldPos.y,bottom_width=selectedAreaWidth,left={x:this.selectedArea.startWorldPos.x,y:this.selectedArea.startWorldPos.y,width:scaledXWidth,height:selectedAreaHeight},right_x=this.selectedArea.endWorldPos.x,right_y=this.selectedArea.startWorldPos.y,right_height=selectedAreaHeight,cornerSquareHalfLength=left.width;return x>=top_x+cornerSquareHalfLength&&x<=top_x+top_width-cornerSquareHalfLength&&y>=top_y-cornerSquareHalfLength&&y<=top_y+cornerSquareHalfLength?config.pr.TOP:x>=bottom_x+cornerSquareHalfLength&&x<=bottom_x+bottom_width-cornerSquareHalfLength&&y>=bottom_y-cornerSquareHalfLength&&y<=bottom_y+cornerSquareHalfLength?config.pr.BOTTOM:x>=left.x-cornerSquareHalfLength&&x<=left.x+cornerSquareHalfLength&&y>=left.y+cornerSquareHalfLength&&y<=left.y+left.height-cornerSquareHalfLength?config.pr.LEFT:x>=right_x-cornerSquareHalfLength&&x<=right_x+cornerSquareHalfLength&&y>=right_y+cornerSquareHalfLength&&y<=right_y+right_height-cornerSquareHalfLength?config.pr.RIGHT:x>=top_x-cornerSquareHalfLength&&x<=top_x+cornerSquareHalfLength&&y>=top_y-cornerSquareHalfLength&&y<=top_y+cornerSquareHalfLength?config.pr.TOPLEFT:x>=right_x-cornerSquareHalfLength&&x<=right_x+cornerSquareHalfLength&&y>=right_y-cornerSquareHalfLength&&y<=right_y+cornerSquareHalfLength?config.pr.TOPRIGHT:x>=bottom_x-cornerSquareHalfLength&&x<=bottom_x+cornerSquareHalfLength&&y>=bottom_y-cornerSquareHalfLength&&y<=bottom_y+cornerSquareHalfLength?config.pr.BOTTOMLEFT:x>=right_x-cornerSquareHalfLength&&x<=right_x+cornerSquareHalfLength&&y>=bottom_y-cornerSquareHalfLength&&y<=bottom_y+cornerSquareHalfLength?config.pr.BOTTOMRIGHT:null}},{key:"extendSelectedAreaSideWays",value:function extendSelectedAreaSideWays(direction,extendToCoord,isAltPressed){var _this2=this,originalSelectAreaHeightPixelOffset=this.capturedBaseExtendingSelectedArea.endPixelIndex.rowIndex-this.capturedBaseExtendingSelectedArea.startPixelIndex.rowIndex,originalSelectAreaWidthPixelOffset=this.capturedBaseExtendingSelectedArea.endPixelIndex.columnIndex-this.capturedBaseExtendingSelectedArea.startPixelIndex.columnIndex,originPixelIndex={rowIndex:this.capturedBaseExtendingSelectedArea.startPixelIndex.rowIndex+(originalSelectAreaHeightPixelOffset+2)/2,columnIndex:this.capturedBaseExtendingSelectedArea.startPixelIndex.columnIndex+(originalSelectAreaWidthPixelOffset+2)/2},modifyPixelWidthRatio=1,modifyPixelHeightRatio=1,heightExtensionOffset=direction===config.pr.TOP?this.capturedBaseExtendingSelectedArea.startWorldPos.y-extendToCoord.y:direction===config.pr.BOTTOM?extendToCoord.y-this.capturedBaseExtendingSelectedArea.endWorldPos.y:0,widthExtensionOffset=direction===config.pr.LEFT?this.capturedBaseExtendingSelectedArea.startWorldPos.x-extendToCoord.x:direction===config.pr.RIGHT?extendToCoord.x-this.capturedBaseExtendingSelectedArea.endWorldPos.x:0;if(isAltPressed){var wasOriginalAreaHeightEven=(originalSelectAreaHeightPixelOffset+1)%2==0,wasOriginalAreaWidthEven=(originalSelectAreaWidthPixelOffset+1)%2==0,singleSideOffsetRowBy=Math.round(heightExtensionOffset/this.gridSquareLength),singleSideOffsetColumnBy=Math.round(widthExtensionOffset/this.gridSquareLength),heightPixelCount=originalSelectAreaHeightPixelOffset+1+2*singleSideOffsetRowBy;heightPixelCount<1&&!wasOriginalAreaHeightEven?(heightPixelCount=1,singleSideOffsetRowBy=-originalSelectAreaHeightPixelOffset/2):heightPixelCount<2&&wasOriginalAreaHeightEven&&(heightPixelCount=2,singleSideOffsetRowBy=-(originalSelectAreaHeightPixelOffset-1)/2);var widthPixelCount=originalSelectAreaWidthPixelOffset+1+2*singleSideOffsetColumnBy;widthPixelCount<1&&!wasOriginalAreaWidthEven?(widthPixelCount=1,singleSideOffsetColumnBy=-originalSelectAreaWidthPixelOffset/2):widthPixelCount<2&&wasOriginalAreaWidthEven&&(widthPixelCount=2,singleSideOffsetColumnBy=-(originalSelectAreaWidthPixelOffset-1)/2),modifyPixelHeightRatio=(originalSelectAreaHeightPixelOffset+2*singleSideOffsetRowBy)/originalSelectAreaHeightPixelOffset,modifyPixelWidthRatio=(originalSelectAreaWidthPixelOffset+2*singleSideOffsetColumnBy)/originalSelectAreaWidthPixelOffset,this.setExtendingSelectedArea({startWorldPos:{x:this.capturedBaseExtendingSelectedArea.startWorldPos.x-singleSideOffsetColumnBy*this.gridSquareLength,y:this.capturedBaseExtendingSelectedArea.startWorldPos.y-singleSideOffsetRowBy*this.gridSquareLength},endWorldPos:{x:this.capturedBaseExtendingSelectedArea.endWorldPos.x+singleSideOffsetColumnBy*this.gridSquareLength,y:this.capturedBaseExtendingSelectedArea.endWorldPos.y+singleSideOffsetRowBy*this.gridSquareLength},startPixelIndex:{rowIndex:this.capturedBaseExtendingSelectedArea.startPixelIndex.rowIndex-singleSideOffsetRowBy,columnIndex:this.capturedBaseExtendingSelectedArea.startPixelIndex.columnIndex-singleSideOffsetColumnBy},endPixelIndex:{rowIndex:this.capturedBaseExtendingSelectedArea.endPixelIndex.rowIndex+singleSideOffsetRowBy,columnIndex:this.capturedBaseExtendingSelectedArea.endPixelIndex.columnIndex+singleSideOffsetColumnBy}})}else{var _heightExtensionOffset=direction===config.pr.TOP?this.capturedBaseExtendingSelectedArea.startWorldPos.y-extendToCoord.y:direction===config.pr.BOTTOM?extendToCoord.y-this.capturedBaseExtendingSelectedArea.endWorldPos.y:0,_widthExtensionOffset=direction===config.pr.LEFT?this.capturedBaseExtendingSelectedArea.startWorldPos.x-extendToCoord.x:direction===config.pr.RIGHT?extendToCoord.x-this.capturedBaseExtendingSelectedArea.endWorldPos.x:0,offsetRowBy=Math.round(_heightExtensionOffset/this.gridSquareLength),offsetColumnBy=Math.round(_widthExtensionOffset/this.gridSquareLength),_heightPixelCount=originalSelectAreaHeightPixelOffset+1+offsetRowBy,_widthPixelCount=originalSelectAreaWidthPixelOffset+1+offsetColumnBy;_heightPixelCount<1&&(_heightPixelCount=1,offsetRowBy=-originalSelectAreaHeightPixelOffset),_widthPixelCount<1&&(_widthPixelCount=1,offsetColumnBy=-originalSelectAreaWidthPixelOffset),modifyPixelHeightRatio=_heightPixelCount/(originalSelectAreaHeightPixelOffset+1),modifyPixelWidthRatio=_widthPixelCount/(originalSelectAreaWidthPixelOffset+1),direction===config.pr.TOP?(originPixelIndex.rowIndex=this.capturedBaseExtendingSelectedArea.endPixelIndex.rowIndex,originPixelIndex.columnIndex=this.capturedBaseExtendingSelectedArea.startPixelIndex.columnIndex,this.setExtendingSelectedArea({startWorldPos:{x:this.capturedBaseExtendingSelectedArea.startWorldPos.x,y:this.capturedBaseExtendingSelectedArea.endWorldPos.y-_heightPixelCount*this.gridSquareLength},endWorldPos:this.capturedBaseExtendingSelectedArea.endWorldPos,startPixelIndex:{rowIndex:this.capturedBaseExtendingSelectedArea.endPixelIndex.rowIndex-_heightPixelCount+1,columnIndex:this.capturedBaseExtendingSelectedArea.startPixelIndex.columnIndex},endPixelIndex:this.capturedBaseExtendingSelectedArea.endPixelIndex})):direction===config.pr.BOTTOM?(originPixelIndex.rowIndex=this.capturedBaseExtendingSelectedArea.startPixelIndex.rowIndex,originPixelIndex.columnIndex=this.capturedBaseExtendingSelectedArea.startPixelIndex.columnIndex,modifyPixelHeightRatio=_heightPixelCount/(originalSelectAreaHeightPixelOffset+1),this.setExtendingSelectedArea({startWorldPos:this.capturedBaseExtendingSelectedArea.startWorldPos,endWorldPos:{x:this.capturedBaseExtendingSelectedArea.endWorldPos.x,y:this.capturedBaseExtendingSelectedArea.startWorldPos.y+_heightPixelCount*this.gridSquareLength},startPixelIndex:this.capturedBaseExtendingSelectedArea.startPixelIndex,endPixelIndex:{rowIndex:this.capturedBaseExtendingSelectedArea.startPixelIndex.rowIndex+_heightPixelCount-1,columnIndex:this.selectedArea.endPixelIndex.columnIndex}})):direction===config.pr.LEFT?(originPixelIndex.rowIndex=this.capturedBaseExtendingSelectedArea.startPixelIndex.rowIndex,originPixelIndex.columnIndex=this.capturedBaseExtendingSelectedArea.endPixelIndex.columnIndex,modifyPixelWidthRatio=_widthPixelCount/(originalSelectAreaWidthPixelOffset+1),this.setExtendingSelectedArea({startWorldPos:{x:this.capturedBaseExtendingSelectedArea.endWorldPos.x-_widthPixelCount*this.gridSquareLength,y:this.capturedBaseExtendingSelectedArea.startWorldPos.y},endWorldPos:this.capturedBaseExtendingSelectedArea.endWorldPos,startPixelIndex:{rowIndex:this.capturedBaseExtendingSelectedArea.startPixelIndex.rowIndex,columnIndex:this.capturedBaseExtendingSelectedArea.endPixelIndex.columnIndex-_widthPixelCount+1},endPixelIndex:this.capturedBaseExtendingSelectedArea.endPixelIndex})):direction===config.pr.RIGHT&&(originPixelIndex.rowIndex=this.capturedBaseExtendingSelectedArea.startPixelIndex.rowIndex,originPixelIndex.columnIndex=this.capturedBaseExtendingSelectedArea.startPixelIndex.columnIndex,modifyPixelWidthRatio=_widthPixelCount/(originalSelectAreaWidthPixelOffset+1),this.setExtendingSelectedArea({startWorldPos:this.capturedBaseExtendingSelectedArea.startWorldPos,endWorldPos:{x:this.capturedBaseExtendingSelectedArea.startWorldPos.x+_widthPixelCount*this.gridSquareLength,y:this.capturedBaseExtendingSelectedArea.endWorldPos.y},startPixelIndex:this.capturedBaseExtendingSelectedArea.startPixelIndex,endPixelIndex:{rowIndex:this.capturedBaseExtendingSelectedArea.endPixelIndex.rowIndex,columnIndex:this.capturedBaseExtendingSelectedArea.startPixelIndex.columnIndex+_widthPixelCount-1}}))}var filteredPixelsToColor=getOverlappingPixelIndicesForModifiedPixels(this.capturedBaseExtendingSelectedAreaPixels,originPixelIndex,modifyPixelWidthRatio,modifyPixelHeightRatio,this.gridSquareLength).filter((function(item){return!(item.columnIndex<_this2.extendingSelectedArea.startPixelIndex.columnIndex||item.columnIndex>_this2.extendingSelectedArea.endPixelIndex.columnIndex||item.rowIndex<_this2.extendingSelectedArea.startPixelIndex.rowIndex||item.rowIndex>_this2.extendingSelectedArea.endPixelIndex.rowIndex)}));this.setExtendingSelectedPixels(filteredPixelsToColor)}},{key:"extendSelectedAreaDiagonally",value:function extendSelectedAreaDiagonally(direction,extendToCoord,isAltPressed){var _this3=this;if(this.selectedArea&&this.capturedBaseExtendingSelectedArea){var originalSelectAreaHeightPixelOffset=this.capturedBaseExtendingSelectedArea.endPixelIndex.rowIndex-this.capturedBaseExtendingSelectedArea.startPixelIndex.rowIndex,originalSelectAreaWidthPixelOffset=this.capturedBaseExtendingSelectedArea.endPixelIndex.columnIndex-this.capturedBaseExtendingSelectedArea.startPixelIndex.columnIndex,originPixelIndex={rowIndex:this.capturedBaseExtendingSelectedArea.startPixelIndex.rowIndex,columnIndex:this.capturedBaseExtendingSelectedArea.endPixelIndex.columnIndex},modifyPixelWidthRatio=1,modifyPixelHeightRatio=1;if(isAltPressed){var wasOriginalAreaHeightEven=(originalSelectAreaHeightPixelOffset+1)%2==0,wasOriginalAreaWidthEven=(originalSelectAreaWidthPixelOffset+1)%2==0;originPixelIndex.rowIndex=this.capturedBaseExtendingSelectedArea.startPixelIndex.rowIndex+(originalSelectAreaHeightPixelOffset+2)/2,originPixelIndex.columnIndex=this.capturedBaseExtendingSelectedArea.startPixelIndex.columnIndex+(originalSelectAreaWidthPixelOffset+2)/2;var heightExtensionOffset=direction===config.pr.TOPLEFT||direction===config.pr.TOPRIGHT?this.capturedBaseExtendingSelectedArea.startWorldPos.y-extendToCoord.y:extendToCoord.y-this.capturedBaseExtendingSelectedArea.endWorldPos.y,widthExtensionOffset=direction===config.pr.TOPLEFT||direction===config.pr.BOTTOMLEFT?this.capturedBaseExtendingSelectedArea.startWorldPos.x-extendToCoord.x:extendToCoord.x-this.capturedBaseExtendingSelectedArea.endWorldPos.x,singleSideOffsetRowBy=Math.round(heightExtensionOffset/this.gridSquareLength),singleSideOffsetColumnBy=Math.round(widthExtensionOffset/this.gridSquareLength),heightPixelCount=originalSelectAreaHeightPixelOffset+1+2*singleSideOffsetRowBy;heightPixelCount<1&&!wasOriginalAreaHeightEven?(heightPixelCount=1,singleSideOffsetRowBy=-originalSelectAreaHeightPixelOffset/2):heightPixelCount<2&&wasOriginalAreaHeightEven&&(heightPixelCount=2,singleSideOffsetRowBy=-(originalSelectAreaHeightPixelOffset-1)/2);var widthPixelCount=originalSelectAreaWidthPixelOffset+1+2*singleSideOffsetColumnBy;widthPixelCount<1&&!wasOriginalAreaWidthEven?(widthPixelCount=1,singleSideOffsetColumnBy=-originalSelectAreaWidthPixelOffset/2):widthPixelCount<2&&wasOriginalAreaWidthEven&&(widthPixelCount=2,singleSideOffsetColumnBy=-(originalSelectAreaWidthPixelOffset-1)/2),modifyPixelHeightRatio=(originalSelectAreaHeightPixelOffset+2*singleSideOffsetRowBy)/originalSelectAreaHeightPixelOffset,modifyPixelWidthRatio=(originalSelectAreaWidthPixelOffset+2*singleSideOffsetColumnBy)/originalSelectAreaWidthPixelOffset,this.setExtendingSelectedArea({startWorldPos:{x:this.capturedBaseExtendingSelectedArea.startWorldPos.x-singleSideOffsetColumnBy*this.gridSquareLength,y:this.capturedBaseExtendingSelectedArea.startWorldPos.y-singleSideOffsetRowBy*this.gridSquareLength},endWorldPos:{x:this.capturedBaseExtendingSelectedArea.endWorldPos.x+singleSideOffsetColumnBy*this.gridSquareLength,y:this.capturedBaseExtendingSelectedArea.endWorldPos.y+singleSideOffsetRowBy*this.gridSquareLength},startPixelIndex:{rowIndex:this.capturedBaseExtendingSelectedArea.startPixelIndex.rowIndex-singleSideOffsetRowBy,columnIndex:this.capturedBaseExtendingSelectedArea.startPixelIndex.columnIndex-singleSideOffsetColumnBy},endPixelIndex:{rowIndex:this.capturedBaseExtendingSelectedArea.endPixelIndex.rowIndex+singleSideOffsetRowBy,columnIndex:this.capturedBaseExtendingSelectedArea.endPixelIndex.columnIndex+singleSideOffsetColumnBy}})}else{var _heightExtensionOffset2=direction===config.pr.TOPLEFT||direction===config.pr.TOPRIGHT?this.capturedBaseExtendingSelectedArea.startWorldPos.y-extendToCoord.y:extendToCoord.y-this.capturedBaseExtendingSelectedArea.endWorldPos.y,_widthExtensionOffset2=direction===config.pr.TOPLEFT||direction===config.pr.BOTTOMLEFT?this.capturedBaseExtendingSelectedArea.startWorldPos.x-extendToCoord.x:extendToCoord.x-this.capturedBaseExtendingSelectedArea.endWorldPos.x,offsetRowBy=Math.round(_heightExtensionOffset2/this.gridSquareLength),offsetColumnBy=Math.round(_widthExtensionOffset2/this.gridSquareLength),_heightPixelCount2=originalSelectAreaHeightPixelOffset+1+offsetRowBy,_widthPixelCount2=originalSelectAreaWidthPixelOffset+1+offsetColumnBy;_heightPixelCount2<1&&(_heightPixelCount2=1,offsetRowBy=-originalSelectAreaHeightPixelOffset),_widthPixelCount2<1&&(_widthPixelCount2=1,offsetColumnBy=-originalSelectAreaWidthPixelOffset),direction===config.pr.TOPLEFT?(originPixelIndex.rowIndex=this.capturedBaseExtendingSelectedArea.endPixelIndex.rowIndex,originPixelIndex.columnIndex=this.capturedBaseExtendingSelectedArea.endPixelIndex.columnIndex,modifyPixelHeightRatio=_heightPixelCount2/(originalSelectAreaHeightPixelOffset+1),modifyPixelWidthRatio=_widthPixelCount2/(originalSelectAreaWidthPixelOffset+1),this.setExtendingSelectedArea({startWorldPos:{x:this.capturedBaseExtendingSelectedArea.endWorldPos.x-_widthPixelCount2*this.gridSquareLength,y:this.capturedBaseExtendingSelectedArea.endWorldPos.y-_heightPixelCount2*this.gridSquareLength},endWorldPos:this.capturedBaseExtendingSelectedArea.endWorldPos,startPixelIndex:{rowIndex:this.capturedBaseExtendingSelectedArea.endPixelIndex.rowIndex-_heightPixelCount2+1,columnIndex:this.capturedBaseExtendingSelectedArea.endPixelIndex.columnIndex-_widthPixelCount2+1},endPixelIndex:this.capturedBaseExtendingSelectedArea.endPixelIndex})):direction===config.pr.TOPRIGHT?(originPixelIndex.rowIndex=this.capturedBaseExtendingSelectedArea.endPixelIndex.rowIndex,originPixelIndex.columnIndex=this.capturedBaseExtendingSelectedArea.startPixelIndex.columnIndex,modifyPixelHeightRatio=_heightPixelCount2/(originalSelectAreaHeightPixelOffset+1),modifyPixelWidthRatio=_widthPixelCount2/(originalSelectAreaWidthPixelOffset+1),this.setExtendingSelectedArea({startWorldPos:{x:this.capturedBaseExtendingSelectedArea.startWorldPos.x,y:this.capturedBaseExtendingSelectedArea.endWorldPos.y-_heightPixelCount2*this.gridSquareLength},endWorldPos:{x:this.capturedBaseExtendingSelectedArea.startWorldPos.x+_widthPixelCount2*this.gridSquareLength,y:this.capturedBaseExtendingSelectedArea.endWorldPos.y},startPixelIndex:{rowIndex:this.capturedBaseExtendingSelectedArea.endPixelIndex.rowIndex-_heightPixelCount2+1,columnIndex:this.capturedBaseExtendingSelectedArea.startPixelIndex.columnIndex},endPixelIndex:{rowIndex:this.capturedBaseExtendingSelectedArea.endPixelIndex.rowIndex,columnIndex:this.capturedBaseExtendingSelectedArea.startPixelIndex.columnIndex+_widthPixelCount2-1}})):direction===config.pr.BOTTOMLEFT?(originPixelIndex.rowIndex=this.capturedBaseExtendingSelectedArea.startPixelIndex.rowIndex,originPixelIndex.columnIndex=this.capturedBaseExtendingSelectedArea.endPixelIndex.columnIndex,modifyPixelHeightRatio=_heightPixelCount2/(originalSelectAreaHeightPixelOffset+1),modifyPixelWidthRatio=_widthPixelCount2/(originalSelectAreaWidthPixelOffset+1),this.setExtendingSelectedArea({startWorldPos:{x:this.capturedBaseExtendingSelectedArea.endWorldPos.x-_widthPixelCount2*this.gridSquareLength,y:this.capturedBaseExtendingSelectedArea.startWorldPos.y},endWorldPos:{x:this.capturedBaseExtendingSelectedArea.endWorldPos.x,y:this.capturedBaseExtendingSelectedArea.startWorldPos.y+_heightPixelCount2*this.gridSquareLength},startPixelIndex:{rowIndex:this.capturedBaseExtendingSelectedArea.startPixelIndex.rowIndex,columnIndex:this.capturedBaseExtendingSelectedArea.endPixelIndex.columnIndex-_widthPixelCount2+1},endPixelIndex:{rowIndex:this.capturedBaseExtendingSelectedArea.startPixelIndex.rowIndex+_heightPixelCount2-1,columnIndex:this.capturedBaseExtendingSelectedArea.endPixelIndex.columnIndex}})):direction===config.pr.BOTTOMRIGHT&&(originPixelIndex.rowIndex=this.capturedBaseExtendingSelectedArea.startPixelIndex.rowIndex,originPixelIndex.columnIndex=this.capturedBaseExtendingSelectedArea.startPixelIndex.columnIndex,modifyPixelHeightRatio=_heightPixelCount2/(originalSelectAreaHeightPixelOffset+1),modifyPixelWidthRatio=_widthPixelCount2/(originalSelectAreaWidthPixelOffset+1),this.setExtendingSelectedArea({startWorldPos:{x:this.capturedBaseExtendingSelectedArea.startWorldPos.x,y:this.capturedBaseExtendingSelectedArea.startWorldPos.y},endWorldPos:{x:this.capturedBaseExtendingSelectedArea.startWorldPos.x+_widthPixelCount2*this.gridSquareLength,y:this.capturedBaseExtendingSelectedArea.startWorldPos.y+_heightPixelCount2*this.gridSquareLength},startPixelIndex:{rowIndex:this.capturedBaseExtendingSelectedArea.startPixelIndex.rowIndex,columnIndex:this.capturedBaseExtendingSelectedArea.startPixelIndex.columnIndex},endPixelIndex:{rowIndex:this.capturedBaseExtendingSelectedArea.startPixelIndex.rowIndex+_heightPixelCount2-1,columnIndex:this.capturedBaseExtendingSelectedArea.startPixelIndex.columnIndex+_widthPixelCount2-1}}))}var filteredPixelsToColor=getOverlappingPixelIndicesForModifiedPixels(this.capturedBaseExtendingSelectedAreaPixels,originPixelIndex,modifyPixelWidthRatio,modifyPixelHeightRatio,this.gridSquareLength).filter((function(item){return!(item.columnIndex<_this3.extendingSelectedArea.startPixelIndex.columnIndex||item.columnIndex>_this3.extendingSelectedArea.endPixelIndex.columnIndex||item.rowIndex<_this3.extendingSelectedArea.startPixelIndex.rowIndex||item.rowIndex>_this3.extendingSelectedArea.endPixelIndex.rowIndex)}));this.setExtendingSelectedPixels(filteredPixelsToColor)}}},{key:"extendSelectedArea",value:function extendSelectedArea(direction,extendToCoord,isAltPressed){if(this.selectedArea)switch(null===this.capturedBaseExtendingSelectedArea&&(this.capturedBaseExtendingSelectedArea=this.selectedArea),null===this.capturedBaseExtendingSelectedAreaPixels&&(this.capturedBaseExtendingSelectedAreaPixels=(0,toConsumableArray.Z)(this.selectedAreaPixels)),direction){case config.pr.TOP:this.extendSelectedAreaSideWays(config.pr.TOP,extendToCoord,isAltPressed);break;case config.pr.BOTTOM:this.extendSelectedAreaSideWays(config.pr.BOTTOM,extendToCoord,isAltPressed);break;case config.pr.LEFT:this.extendSelectedAreaSideWays(config.pr.LEFT,extendToCoord,isAltPressed);break;case config.pr.RIGHT:this.extendSelectedAreaSideWays(config.pr.RIGHT,extendToCoord,isAltPressed);break;case config.pr.TOPLEFT:this.extendSelectedAreaDiagonally(config.pr.TOPLEFT,extendToCoord,isAltPressed);break;case config.pr.TOPRIGHT:this.extendSelectedAreaDiagonally(config.pr.TOPRIGHT,extendToCoord,isAltPressed);break;case config.pr.BOTTOMLEFT:this.extendSelectedAreaDiagonally(config.pr.BOTTOMLEFT,extendToCoord,isAltPressed);break;case config.pr.BOTTOMRIGHT:this.extendSelectedAreaDiagonally(config.pr.BOTTOMRIGHT,extendToCoord,isAltPressed)}}},{key:"extendCapturedData",value:function extendCapturedData(direction){if(!this.capturedData)throw new Error("There is no captured data");var _getGridIndicesFromDa=getGridIndicesFromData(this.capturedData),topRowIndex=_getGridIndicesFromDa.topRowIndex,bottomRowIndex=_getGridIndicesFromDa.bottomRowIndex,leftColumnIndex=_getGridIndicesFromDa.leftColumnIndex,rightColumnIndex=_getGridIndicesFromDa.rightColumnIndex;if(direction===config.pr.TOP||direction===config.pr.BOTTOM){var newRowIndex=direction===config.pr.TOP?topRowIndex-1:bottomRowIndex+1;!function addRowToData(data,rowIndex,defaultColor){var columnKeys=getColumnKeysFromData(data);if(!data.has(rowIndex)){data.set(rowIndex,new Map);var _step,_iterator=(0,createForOfIteratorHelper.Z)(columnKeys);try{for(_iterator.s();!(_step=_iterator.n()).done;){var i=_step.value;data.get(rowIndex).set(i,{color:""})}}catch(err){_iterator.e(err)}finally{_iterator.f()}}}(this.capturedData,newRowIndex,this.defaultPixelColor)}else if(direction===config.pr.LEFT||direction===config.pr.RIGHT){var newColumnIndex=direction===config.pr.LEFT?leftColumnIndex-1:rightColumnIndex+1;!function addColumnToData(data,columnIndex,defaultColor){data.forEach((function(row){row.has(columnIndex)||row.set(columnIndex,{color:""})}))}(this.capturedData,newColumnIndex,this.defaultPixelColor)}}},{key:"shortenCapturedData",value:function shortenCapturedData(direction){if(!this.capturedData)throw new Error("There is no captured data");var _getGridIndicesFromDa2=getGridIndicesFromData(this.capturedData),topRowIndex=_getGridIndicesFromDa2.topRowIndex,bottomRowIndex=_getGridIndicesFromDa2.bottomRowIndex,leftColumnIndex=_getGridIndicesFromDa2.leftColumnIndex,rightColumnIndex=_getGridIndicesFromDa2.rightColumnIndex,columnCount=getColumnCountFromData(this.capturedData),rowCount=getRowCountFromData(this.capturedData),pixelModifyItems=[];if(direction===config.pr.TOP||direction===config.pr.BOTTOM){if(rowCount<=config.tj)return!1;var swipedRowIndex=direction===config.pr.TOP?topRowIndex:bottomRowIndex,swipedRowPixels=extractColoredPixelsFromRow(this.capturedData,swipedRowIndex);pixelModifyItems.push.apply(pixelModifyItems,(0,toConsumableArray.Z)(swipedRowPixels)),function deleteRowOfData(data,rowIndex){data.has(rowIndex)&&data.delete(rowIndex)}(this.capturedData,swipedRowIndex)}else if(direction===config.pr.LEFT||direction===config.pr.RIGHT){if(columnCount<=config.tj)return!1;var swipedColumnIndex=direction===config.pr.LEFT?leftColumnIndex:rightColumnIndex,swipedColumnPixels=extractColoredPixelsFromColumn(this.capturedData,swipedColumnIndex);pixelModifyItems.push.apply(pixelModifyItems,(0,toConsumableArray.Z)(swipedColumnPixels)),function deleteColumnOfData(data,columnIndex){data.forEach((function(row){row.has(columnIndex)&&row.delete(columnIndex)}))}(this.capturedData,swipedColumnIndex)}return!0}},{key:"setIndicatorPixels",value:function setIndicatorPixels(indicatorPixels){Array.isArray(indicatorPixels)&&(this.indicatorPixels=indicatorPixels)}},{key:"addToStrokePixelRecords",value:function addToStrokePixelRecords(userId,pixelItem){var _this$strokedPixelRec;this.strokedPixelRecords.has(userId)||this.strokedPixelRecords.set(userId,new PixelChangeRecords),null===(_this$strokedPixelRec=this.strokedPixelRecords.get(userId))||void 0===_this$strokedPixelRec||_this$strokedPixelRec.record(pixelItem)}},{key:"getAllStrokePixels",value:function getAllStrokePixels(){var allStrokePixels=[];return this.strokedPixelRecords.forEach((function(pixelChangeRecords){allStrokePixels.push.apply(allStrokePixels,(0,toConsumableArray.Z)(pixelChangeRecords.getEffectiveChanges()))})),allStrokePixels}},{key:"addToErasedPixelRecords",value:function addToErasedPixelRecords(userId,pixelItem){var _this$erasedPixelReco;this.erasedPixelRecords.has(userId)||this.erasedPixelRecords.set(userId,new PixelChangeRecords),null===(_this$erasedPixelReco=this.erasedPixelRecords.get(userId))||void 0===_this$erasedPixelReco||_this$erasedPixelReco.record(pixelItem)}},{key:"getAllErasedPixels",value:function getAllErasedPixels(){var allErasedPixels=[];return this.erasedPixelRecords.forEach((function(pixelChangeRecords){allErasedPixels.push.apply(allErasedPixels,(0,toConsumableArray.Z)(pixelChangeRecords.getEffectiveChanges()))})),allErasedPixels}},{key:"deleteErasedPixelRecord",value:function deleteErasedPixelRecord(userId){this.erasedPixelRecords.delete(userId)}},{key:"deleteStrokePixelRecord",value:function deleteStrokePixelRecord(userId){this.strokedPixelRecords.delete(userId)}},{key:"colorPixels",value:function colorPixels(data){var _this$tempStrokedPixe;(_this$tempStrokedPixe=this.tempStrokedPixels).push.apply(_this$tempStrokedPixe,(0,toConsumableArray.Z)(data))}},{key:"erasePixels",value:function erasePixels(data){var _this$tempStrokedPixe2;(_this$tempStrokedPixe2=this.tempStrokedPixels).push.apply(_this$tempStrokedPixe2,(0,toConsumableArray.Z)(data.map((function(item){return(0,objectSpread2.Z)((0,objectSpread2.Z)({},item),{},{color:""})}))))}},{key:"renderStrokedPixels",value:function renderStrokedPixels(correctedLeftTopScreenPoint,squareLength){var _this4=this,ctx=this.ctx,doesCapturedDataExist=null!==this.capturedData,allStrokedPixels=this.getAllStrokePixels().filter((function(item){if(doesCapturedDataExist){var gridIndices=getGridIndicesFromData(_this4.capturedData);return item.rowIndex<gridIndices.topRowIndex||item.rowIndex>gridIndices.bottomRowIndex||item.columnIndex<gridIndices.leftColumnIndex||item.columnIndex>gridIndices.rightColumnIndex}return!0})),tempColorPixelsToStroke=this.tempStrokedPixels.filter((function(item){return""!==item.color})).filter((function(item){if(doesCapturedDataExist){var gridIndices=getGridIndicesFromData(_this4.capturedData);return item.rowIndex<gridIndices.topRowIndex||item.rowIndex>gridIndices.bottomRowIndex||item.columnIndex<gridIndices.leftColumnIndex||item.columnIndex>gridIndices.rightColumnIndex}return!0}));ctx.save();var _step,_iterator=(0,createForOfIteratorHelper.Z)(allStrokedPixels);try{for(_iterator.s();!(_step=_iterator.n()).done;){var item=_step.value,relativeRowIndex=this.rowKeyOrderMap.get(item.rowIndex),relativeColumnIndex=this.columnKeyOrderMap.get(item.columnIndex);void 0!==relativeRowIndex&&void 0!==relativeColumnIndex&&(ctx.fillStyle=item.color,ctx.fillRect(relativeColumnIndex*squareLength+correctedLeftTopScreenPoint.x,relativeRowIndex*squareLength+correctedLeftTopScreenPoint.y,squareLength,squareLength))}}catch(err){_iterator.e(err)}finally{_iterator.f()}var _step2,_iterator2=(0,createForOfIteratorHelper.Z)(tempColorPixelsToStroke);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var _item=_step2.value,_relativeRowIndex=this.rowKeyOrderMap.get(_item.rowIndex),_relativeColumnIndex=this.columnKeyOrderMap.get(_item.columnIndex);void 0!==_relativeRowIndex&&void 0!==_relativeColumnIndex&&(ctx.fillStyle=_item.color,ctx.fillRect(_relativeColumnIndex*squareLength+correctedLeftTopScreenPoint.x,_relativeRowIndex*squareLength+correctedLeftTopScreenPoint.y,squareLength,squareLength))}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}ctx.restore()}},{key:"renderErasedPixels",value:function renderErasedPixels(correctedLeftTopScreenPoint,squareLength){var tempErasePixels=this.tempStrokedPixels.filter((function(item){return""===item.color})),allErasedPixels=this.getAllErasedPixels(),ctx=this.ctx;ctx.save();var _step3,_iterator3=(0,createForOfIteratorHelper.Z)(allErasedPixels);try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var item=_step3.value,relativeRowIndex=this.rowKeyOrderMap.get(item.rowIndex),relativeColumnIndex=this.columnKeyOrderMap.get(item.columnIndex);void 0!==relativeRowIndex&&void 0!==relativeColumnIndex&&(ctx.clearRect(relativeColumnIndex*squareLength+correctedLeftTopScreenPoint.x,relativeRowIndex*squareLength+correctedLeftTopScreenPoint.y,squareLength,squareLength),ctx.fillStyle=this.defaultPixelColor,ctx.fillRect(relativeColumnIndex*squareLength+correctedLeftTopScreenPoint.x,relativeRowIndex*squareLength+correctedLeftTopScreenPoint.y,squareLength,squareLength))}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}var _step4,_iterator4=(0,createForOfIteratorHelper.Z)(tempErasePixels);try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var _item2=_step4.value,_relativeRowIndex2=this.rowKeyOrderMap.get(_item2.rowIndex),_relativeColumnIndex2=this.columnKeyOrderMap.get(_item2.columnIndex);void 0!==_relativeRowIndex2&&void 0!==_relativeColumnIndex2&&(ctx.clearRect(_relativeColumnIndex2*squareLength+correctedLeftTopScreenPoint.x,_relativeRowIndex2*squareLength+correctedLeftTopScreenPoint.y,squareLength,squareLength),ctx.fillStyle=this.defaultPixelColor,ctx.fillRect(_relativeColumnIndex2*squareLength+correctedLeftTopScreenPoint.x,_relativeRowIndex2*squareLength+correctedLeftTopScreenPoint.y,squareLength,squareLength))}}catch(err){_iterator4.e(err)}finally{_iterator4.f()}}},{key:"renderMovingSelectedPixels",value:function renderMovingSelectedPixels(correctedLeftTopScreenPoint,squareLength){if(null!==this.movingSelectedPixels&&0!=this.movingSelectedPixels.length){var ctx=this.ctx;ctx.save();var _step5,_iterator5=(0,createForOfIteratorHelper.Z)(this.movingSelectedPixels);try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){var item=_step5.value,color=item.previousColor;ctx.fillStyle=color;var relativeRowIndex=this.rowKeyOrderMap.get(item.rowIndex),relativeColumnIndex=this.columnKeyOrderMap.get(item.columnIndex);void 0!==relativeRowIndex&&void 0!==relativeColumnIndex&&ctx.fillRect(relativeColumnIndex*squareLength+correctedLeftTopScreenPoint.x,relativeRowIndex*squareLength+correctedLeftTopScreenPoint.y,squareLength,squareLength)}}catch(err){_iterator5.e(err)}finally{_iterator5.f()}ctx.restore()}}},{key:"renderExtendingSelectedPixels",value:function renderExtendingSelectedPixels(correctedLeftTopScreenPoint,squareLength){if(null!==this.extendingSelectedPixels&&0!=this.extendingSelectedPixels.length){var ctx=this.ctx;ctx.save();var _step6,_iterator6=(0,createForOfIteratorHelper.Z)(this.extendingSelectedPixels);try{for(_iterator6.s();!(_step6=_iterator6.n()).done;){var item=_step6.value,color=item.previousColor;ctx.fillStyle=color;var relativeRowIndex=this.rowKeyOrderMap.get(item.rowIndex),relativeColumnIndex=this.columnKeyOrderMap.get(item.columnIndex);void 0!==relativeRowIndex&&void 0!==relativeColumnIndex&&ctx.fillRect(relativeColumnIndex*squareLength+correctedLeftTopScreenPoint.x,relativeRowIndex*squareLength+correctedLeftTopScreenPoint.y,squareLength,squareLength)}}catch(err){_iterator6.e(err)}finally{_iterator6.f()}ctx.restore()}}},{key:"renderCanvasMask",value:function renderCanvasMask(correctedLeftTopScreenPoint,squareLength){if(null!==this.capturedData&&null!==this.capturedDataOriginalIndices){var modifiedGridIndices=getGridIndicesFromData(this.capturedData),originalGridIndices=this.capturedDataOriginalIndices,columnCount=modifiedGridIndices.rightColumnIndex-modifiedGridIndices.leftColumnIndex+1,rowCount=modifiedGridIndices.bottomRowIndex-modifiedGridIndices.topRowIndex+1,leftColumnOffset=modifiedGridIndices.leftColumnIndex-originalGridIndices.leftColumnIndex,rightColumnOffset=modifiedGridIndices.rightColumnIndex-originalGridIndices.rightColumnIndex,topRowOffset=modifiedGridIndices.topRowIndex-originalGridIndices.topRowIndex,bottomRowOffset=modifiedGridIndices.bottomRowIndex-originalGridIndices.bottomRowIndex,ctx=this.ctx;leftColumnOffset>0?drawRect(ctx,correctedLeftTopScreenPoint.x-leftColumnOffset*squareLength,correctedLeftTopScreenPoint.y,leftColumnOffset*squareLength,rowCount*squareLength,this.backgroundColor,this.backgroundColor,1):drawRect(ctx,correctedLeftTopScreenPoint.x,correctedLeftTopScreenPoint.y,-leftColumnOffset*squareLength,rowCount*squareLength,this.defaultPixelColor,this.defaultPixelColor,1),rightColumnOffset>0?drawRect(ctx,correctedLeftTopScreenPoint.x+columnCount*squareLength-rightColumnOffset*squareLength,correctedLeftTopScreenPoint.y,rightColumnOffset*squareLength,rowCount*squareLength,this.defaultPixelColor,this.defaultPixelColor,1):drawRect(ctx,correctedLeftTopScreenPoint.x+columnCount*squareLength,correctedLeftTopScreenPoint.y,-rightColumnOffset*squareLength,rowCount*squareLength,this.backgroundColor,this.backgroundColor,1),topRowOffset>0?drawRect(ctx,correctedLeftTopScreenPoint.x,correctedLeftTopScreenPoint.y-topRowOffset*squareLength,columnCount*squareLength,topRowOffset*squareLength,this.backgroundColor,this.backgroundColor,1):drawRect(ctx,correctedLeftTopScreenPoint.x,correctedLeftTopScreenPoint.y,columnCount*squareLength,-topRowOffset*squareLength,this.defaultPixelColor,this.defaultPixelColor,1),bottomRowOffset>0?drawRect(ctx,correctedLeftTopScreenPoint.x,correctedLeftTopScreenPoint.y+rowCount*squareLength-bottomRowOffset*squareLength,columnCount*squareLength,bottomRowOffset*squareLength,this.defaultPixelColor,this.defaultPixelColor,1):drawRect(ctx,correctedLeftTopScreenPoint.x,correctedLeftTopScreenPoint.y+rowCount*squareLength,columnCount*squareLength,-bottomRowOffset*squareLength,this.backgroundColor,this.backgroundColor,1),leftColumnOffset>0&&topRowOffset>0&&drawRect(ctx,correctedLeftTopScreenPoint.x-leftColumnOffset*squareLength,correctedLeftTopScreenPoint.y-topRowOffset*squareLength,leftColumnOffset*squareLength,topRowOffset*squareLength,this.backgroundColor,this.backgroundColor,1),leftColumnOffset>0&&bottomRowOffset<0&&drawRect(ctx,correctedLeftTopScreenPoint.x-leftColumnOffset*squareLength,correctedLeftTopScreenPoint.y+rowCount*squareLength,leftColumnOffset*squareLength,-bottomRowOffset*squareLength,this.backgroundColor,this.backgroundColor,1),rightColumnOffset<0&&topRowOffset>0&&drawRect(ctx,correctedLeftTopScreenPoint.x+columnCount*squareLength,correctedLeftTopScreenPoint.y-topRowOffset*squareLength,-rightColumnOffset*squareLength,topRowOffset*squareLength,this.backgroundColor,this.backgroundColor,1),rightColumnOffset<0&&bottomRowOffset<0&&drawRect(ctx,correctedLeftTopScreenPoint.x+columnCount*squareLength,correctedLeftTopScreenPoint.y+rowCount*squareLength,-rightColumnOffset*squareLength,-bottomRowOffset*squareLength,this.backgroundColor,this.backgroundColor,1)}}},{key:"renderIndicatorPixels",value:function renderIndicatorPixels(correctedLeftTopScreenPoint,squareLength){if(0!=this.indicatorPixels.length){var ctx=this.ctx;ctx.save();var _step7,_iterator7=(0,createForOfIteratorHelper.Z)(this.indicatorPixels);try{for(_iterator7.s();!(_step7=_iterator7.n()).done;){var item=_step7.value;ctx.fillStyle=item.color,ctx.globalAlpha=.5;var relativeRowIndex=this.rowKeyOrderMap.get(item.rowIndex),relativeColumnIndex=this.columnKeyOrderMap.get(item.columnIndex);void 0!==relativeRowIndex&&void 0!==relativeColumnIndex&&(ctx.clearRect(relativeColumnIndex*squareLength+correctedLeftTopScreenPoint.x,relativeRowIndex*squareLength+correctedLeftTopScreenPoint.y,squareLength,squareLength),ctx.fillRect(relativeColumnIndex*squareLength+correctedLeftTopScreenPoint.x,relativeRowIndex*squareLength+correctedLeftTopScreenPoint.y,squareLength,squareLength))}}catch(err){_iterator7.e(err)}finally{_iterator7.f()}ctx.restore()}}},{key:"renderHoveredPixel",value:function renderHoveredPixel(correctedLeftTopScreenPoint,squareLength){if(null!==this.hoveredPixel){var ctx=this.ctx,_this$hoveredPixel=this.hoveredPixel,rowIndex=_this$hoveredPixel.rowIndex,columnIndex=_this$hoveredPixel.columnIndex,relativeRowIndex=this.rowKeyOrderMap.get(rowIndex),relativeColumnIndex=this.columnKeyOrderMap.get(columnIndex);if(void 0!==relativeRowIndex&&void 0!==relativeColumnIndex){var brushPatternWidth=this.brushPattern.length,brushPatternHeight=this.brushPattern[0].length,brushPatternCenterRowIndex=Math.floor(brushPatternHeight/2),brushPatternCenterColumnIndex=Math.floor(brushPatternWidth/2);ctx.save(),ctx.globalAlpha=.5;for(var i=0;i<brushPatternHeight;i++)for(var j=0;j<brushPatternWidth;j++){if(0!==this.brushPattern[i][j]){var _relativeRowIndex3=this.rowKeyOrderMap.get(rowIndex+i-brushPatternCenterRowIndex),_relativeColumnIndex3=this.columnKeyOrderMap.get(columnIndex+j-brushPatternCenterColumnIndex);void 0!==_relativeRowIndex3&&void 0!==_relativeColumnIndex3&&(ctx.fillStyle=this.hoveredPixel.color,ctx.fillRect(_relativeColumnIndex3*squareLength+correctedLeftTopScreenPoint.x,_relativeRowIndex3*squareLength+correctedLeftTopScreenPoint.y,squareLength,squareLength))}}ctx.restore()}}}},{key:"render",value:function render(){var squareLength=this.gridSquareLength*this.panZoom.scale,leftTopPoint={x:this.leftColumnIndex*this.gridSquareLength,y:this.topRowIndex*this.gridSquareLength},correctedLeftTopScreenPoint=getScreenPoint(convertCartesianToScreen(this.element,leftTopPoint,this.dpr),this.panZoom);this.ctx.clearRect(0,0,this.width,this.height),this.renderCanvasMask(correctedLeftTopScreenPoint,squareLength),this.renderStrokedPixels(correctedLeftTopScreenPoint,squareLength),this.renderErasedPixels(correctedLeftTopScreenPoint,squareLength),this.renderIndicatorPixels(correctedLeftTopScreenPoint,squareLength),this.renderHoveredPixel(correctedLeftTopScreenPoint,squareLength),this.renderMovingSelectedPixels(correctedLeftTopScreenPoint,squareLength),this.renderExtendingSelectedPixels(correctedLeftTopScreenPoint,squareLength)}}]),InteractionLayer}(BaseLayer);!function(ActionType){ActionType.ColorChange="ColorChange",ActionType.ColorSizeChange="ColorSizeChange",ActionType.SelectAreaMove="SelectAreaMove",ActionType.LayerCreate="LayerCreate",ActionType.LayerDelete="LayerDelete",ActionType.LayerOrderChange="LayerOrderChange"}(ActionType||(ActionType={}));var Action=function(){function Action(){(0,classCallCheck.Z)(this,Action),this.type=void 0,this.layerId=void 0}return(0,createClass.Z)(Action,[{key:"getType",value:function getType(){return this.type}},{key:"getLayerId",value:function getLayerId(){return this.layerId}}]),Action}(),ColorChangeAction=function(_Action){(0,inherits.Z)(ColorChangeAction,_Action);var _super=(0,createSuper.Z)(ColorChangeAction);function ColorChangeAction(data,layerId){var _this;return(0,classCallCheck.Z)(this,ColorChangeAction),(_this=_super.call(this)).type=ActionType.ColorChange,_this.data=void 0,_this.data=data,_this.layerId=layerId,_this}return(0,createClass.Z)(ColorChangeAction,[{key:"createInverseAction",value:function createInverseAction(){return new ColorChangeAction(this.data.map((function(item){return(0,objectSpread2.Z)((0,objectSpread2.Z)({},item),{},{previousColor:item.color,color:item.previousColor})})),this.layerId)}}]),ColorChangeAction}(Action),ColorSizeChangeAction=function(_Action){(0,inherits.Z)(ColorSizeChangeAction,_Action);var _super=(0,createSuper.Z)(ColorSizeChangeAction);function ColorSizeChangeAction(data,rowIndicesToAdd,columnIndicesToAdd,rowIndicesToDelete,columnIndicesToDelete,layerId){var _this;return(0,classCallCheck.Z)(this,ColorSizeChangeAction),(_this=_super.call(this)).type=ActionType.ColorSizeChange,_this.data=void 0,_this.rowIndicesToAdd=void 0,_this.columnIndicesToAdd=void 0,_this.rowIndicesToDelete=void 0,_this.columnIndicesToDelete=void 0,_this.data=data,_this.rowIndicesToDelete=new Set(rowIndicesToDelete),_this.columnIndicesToDelete=new Set(columnIndicesToDelete),_this.rowIndicesToAdd=new Set(rowIndicesToAdd),_this.columnIndicesToAdd=new Set(columnIndicesToAdd),_this.layerId=layerId,_this}return(0,createClass.Z)(ColorSizeChangeAction,[{key:"createInverseAction",value:function createInverseAction(){return new ColorSizeChangeAction(this.data,Array.from(this.rowIndicesToDelete),Array.from(this.columnIndicesToDelete),Array.from(this.rowIndicesToAdd),Array.from(this.columnIndicesToAdd),this.layerId)}}]),ColorSizeChangeAction}(Action),LayerCreateAction=function(_Action){(0,inherits.Z)(LayerCreateAction,_Action);var _super=(0,createSuper.Z)(LayerCreateAction);function LayerCreateAction(layerId,layer,insertPosition){var _this;return(0,classCallCheck.Z)(this,LayerCreateAction),(_this=_super.call(this)).type=ActionType.LayerCreate,_this.insertIndex=void 0,_this.layer=void 0,_this.layerId=layerId,_this.layer=layer,_this.insertIndex=insertPosition,_this}return(0,createClass.Z)(LayerCreateAction,[{key:"createInverseAction",value:function createInverseAction(){return new LayerDeleteAction(this.layerId,this.layer,this.insertIndex)}}]),LayerCreateAction}(Action),LayerDeleteAction=function(_Action2){(0,inherits.Z)(LayerDeleteAction,_Action2);var _super2=(0,createSuper.Z)(LayerDeleteAction);function LayerDeleteAction(layerId,layer,removedIndex){var _this2;return(0,classCallCheck.Z)(this,LayerDeleteAction),(_this2=_super2.call(this)).type=ActionType.LayerDelete,_this2.removeIndex=void 0,_this2.layer=void 0,_this2.layerId=layerId,_this2.layer=layer,_this2.removeIndex=removedIndex,_this2}return(0,createClass.Z)(LayerDeleteAction,[{key:"createInverseAction",value:function createInverseAction(){return new LayerCreateAction(this.layerId,this.layer,this.removeIndex)}}]),LayerDeleteAction}(Action),LayerReorderAction=function(_Action){(0,inherits.Z)(LayerReorderAction,_Action);var _super=(0,createSuper.Z)(LayerReorderAction);function LayerReorderAction(previousLayerIds,reorderdLayerIds){var _this;return(0,classCallCheck.Z)(this,LayerReorderAction),(_this=_super.call(this)).type=ActionType.LayerOrderChange,_this.layerId=null,_this.previousLayerIds=void 0,_this.reorderdLayerIds=void 0,_this.previousLayerIds=previousLayerIds,_this.reorderdLayerIds=reorderdLayerIds,_this}return(0,createClass.Z)(LayerReorderAction,[{key:"createInverseAction",value:function createInverseAction(){return new LayerReorderAction(this.reorderdLayerIds,this.previousLayerIds)}}]),LayerReorderAction}(Action),SelectAreaMoveAction=function(_Action){(0,inherits.Z)(SelectAreaMoveAction,_Action);var _super=(0,createSuper.Z)(SelectAreaMoveAction);function SelectAreaMoveAction(data,previousSelectedArea,newSelectedArea,layerId){var _this;return(0,classCallCheck.Z)(this,SelectAreaMoveAction),(_this=_super.call(this)).type=ActionType.SelectAreaMove,_this.data=void 0,_this.tool=types.G3.SELECT,_this.previousSelectedArea=void 0,_this.newSelectedArea=void 0,_this.data=data,_this.previousSelectedArea=previousSelectedArea,_this.newSelectedArea=newSelectedArea,_this.layerId=layerId,_this}return(0,createClass.Z)(SelectAreaMoveAction,[{key:"createInverseAction",value:function createInverseAction(){return new SelectAreaMoveAction(this.data.map((function(item){return(0,objectSpread2.Z)((0,objectSpread2.Z)({},item),{},{previousColor:item.color,color:item.previousColor})})),this.newSelectedArea,this.previousSelectedArea,this.layerId)}}]),SelectAreaMoveAction}(Action),Event=function(){function Event(name){(0,classCallCheck.Z)(this,Event),this.name=void 0,this.callbacks=void 0,this.name=name,this.callbacks=[]}return(0,createClass.Z)(Event,[{key:"on",value:function on(cb){this.callbacks.push(cb)}},{key:"off",value:function off(cb){var idx=this.callbacks.findIndex((function(callback){return callback===cb}));this.callbacks.splice(idx,1)}},{key:"toString",value:function toString(){return this.name}}]),Event}(),EventDispatcher=function(){function EventDispatcher(){(0,classCallCheck.Z)(this,EventDispatcher),this.events=void 0,this.events={}}return(0,createClass.Z)(EventDispatcher,[{key:"emit",value:function emit(name){for(var _len=arguments.length,args=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)args[_key-1]=arguments[_key];this.events[name]&&this.events[name].callbacks.forEach((function(cb){cb.apply(void 0,args)}))}},{key:"addEventListener",value:function addEventListener(name,cb){this.events[name]||(this.events[name]=new Event(name)),this.events[name].on(cb)}},{key:"removeEventListener",value:function removeEventListener(name,cb){cb?this.events[name].off(cb):delete this.events[name]}}]),EventDispatcher}(),QueueNode=(0,createClass.Z)((function QueueNode(data){(0,classCallCheck.Z)(this,QueueNode),this.data=void 0,this.next=void 0,this.data=data,this.next=null})),Queue=function(){function Queue(){(0,classCallCheck.Z)(this,Queue),this.length=void 0,this.head=void 0,this.tail=void 0,this.head=null,this.tail=null,this.length=0}return(0,createClass.Z)(Queue,[{key:"enqueue",value:function enqueue(data){var node=new QueueNode(data);0===this.length?this.head=node:this.tail.next=node,this.tail=node,this.length++}},{key:"dequeue",value:function dequeue(){if(0===this.length)return null;var data=this.head.data;return this.head=this.head.next,this.length--,data}},{key:"size",value:function size(){return this.length}},{key:"isEmpty",value:function isEmpty(){return 0===this.length}},{key:"clear",value:function clear(){this.head=null,this.tail=null,this.length=0}}]),Queue}();function addEvent(el,type,fn,capturing){return el.addEventListener(type,fn,capturing)}function removeEvent(el,type,fn,capturing){return el.removeEventListener(type,fn,capturing)}var touch={mouseup:"touchend",mouseout:"touchend",mousedown:"touchstart",mousemove:"touchmove"};function touchy(el,event,type,fn){event(el,touch[type],fn),event(el,type,fn)}function isValidIndicesRange(rowIndex,columnIndex,indices){var topRowIndex=indices.topRowIndex,bottomRowIndex=indices.bottomRowIndex,leftColumnIndex=indices.leftColumnIndex,rightColumnIndex=indices.rightColumnIndex;return!(rowIndex<topRowIndex||rowIndex>bottomRowIndex||columnIndex<leftColumnIndex||columnIndex>rightColumnIndex)}var Editor=function(_EventDispatcher){(0,inherits.Z)(Editor,_EventDispatcher);var _super=(0,createSuper.Z)(Editor);function Editor(_ref){var _this,gridCanvas=_ref.gridCanvas,interactionCanvas=_ref.interactionCanvas,dataCanvas=_ref.dataCanvas,backgroundCanvas=_ref.backgroundCanvas,foregroundCanvas=_ref.foregroundCanvas,initLayers=_ref.initLayers,gridSquareLength=_ref.gridSquareLength,width=_ref.width,height=_ref.height,initAutoScale=_ref.initAutoScale,dpr=_ref.dpr;(0,classCallCheck.Z)(this,Editor),(_this=_super.call(this)).gridLayer=void 0,_this.interactionLayer=void 0,_this.dataLayer=void 0,_this.foregroundCanvasElement=void 0,_this.backgroundCanvasElement=void 0,_this.foregroundCtx=void 0,_this.backgroundCtx=void 0,_this.zoomSensitivity=config.uF,_this.maxScale=config.G6,_this.minScale=1/config.IA,_this.extensionAllowanceRatio=2,_this.pinchZoomDiff=null,_this.width=void 0,_this.height=void 0,_this.originalLayerIdsInOrderForHistory=[],_this.topRowIndex=void 0,_this.leftColumnIndex=void 0,_this.lastRenderAllCall=null,_this.panZoom={scale:1,offset:{x:0,y:0}},_this.panPoint={lastMousePos:{x:0,y:0}},_this.dpr=1,_this.brushColor="#FF0000",_this.gridSquareLength=config.IA,_this.maxHistoryCount=100,_this.undoHistory=[],_this.redoHistory=[],_this.extensionPoint={direction:null},_this.isPanZoomable=!0,_this.isAltPressed=!1,_this.mouseMode=config.Om.NULL,_this.brushTool=types.G3.DOT,_this.mouseDownWorldPos=null,_this.mouseDownPanZoom=null,_this.mouseMoveWorldPos={x:0,y:0},_this.previousMouseMoveWorldPos=null,_this.renderDataLayerTimeout=null,_this.isDrawingEnabled=!0,_this.isInteractionApplicable=!0,_this.element=void 0,_this.resizeUnit=1,_this.maxColumnCount=null,_this.maxRowCount=null,_this.minColumnCount=config.tj,_this.minRowCount=config.tj,_this.styleMouseCursor=function(mouseCoord){if(_this.mouseMode!==config.Om.PANNING)if(_this.brushTool!==types.G3.NONE){var hoveredButton=_this.detectButtonClicked(mouseCoord);if(_this.mouseMode===config.Om.EXTENDING&&(hoveredButton=_this.extensionPoint.direction),hoveredButton)switch(hoveredButton){case config.pr.TOP:case config.pr.BOTTOM:_this.element.style.cursor="ns-resize";break;case config.pr.LEFT:case config.pr.RIGHT:_this.element.style.cursor="ew-resize";break;case config.pr.TOPLEFT:_this.element.style.cursor="nw-resize";break;case config.pr.TOPRIGHT:_this.element.style.cursor="ne-resize";break;case config.pr.BOTTOMLEFT:_this.element.style.cursor="sw-resize";break;case config.pr.BOTTOMRIGHT:_this.element.style.cursor="se-resize"}else switch(_this.brushTool){case types.G3.DOT:case types.G3.ERASER:case types.G3.PAINT_BUCKET:_this.element.style.cursor="crosshair";break;case types.G3.SELECT:_this.element.style.cursor="crosshair";var selectedArea=_this.interactionLayer.getSelectedArea();if(selectedArea){var direction=_this.interactionLayer.detectSelectedAreaExtendDirection(mouseCoord);if(direction)switch(direction){case config.pr.TOP:case config.pr.BOTTOM:_this.element.style.cursor="ns-resize";break;case config.pr.LEFT:case config.pr.RIGHT:_this.element.style.cursor="ew-resize";break;case config.pr.TOPLEFT:_this.element.style.cursor="nw-resize";break;case config.pr.TOPRIGHT:_this.element.style.cursor="ne-resize";break;case config.pr.BOTTOMLEFT:_this.element.style.cursor="sw-resize";break;case config.pr.BOTTOMRIGHT:_this.element.style.cursor="se-resize"}else getIsPointInsideRegion(mouseCoord,selectedArea)&&(_this.element.style.cursor="grab")}break;default:_this.element.style.cursor="default"}}else _this.element.style.cursor="grab";else _this.element.style.cursor="grabbing"},_this.handleExtension=function(evt){evt.preventDefault();var interactionLayer=_this.interactionLayer,interactionCapturedData=interactionLayer.getCapturedData();interactionCapturedData||(interactionLayer.setCapturedData(_this.dataLayer.getCopiedData()),interactionCapturedData=interactionLayer.getCapturedData());var dataLayerRowCount=_this.dataLayer.getRowCount(),dataLayerColumnCount=_this.dataLayer.getColumnCount(),minAmountForExtension=_this.gridSquareLength;if(!(window.TouchEvent&&evt instanceof TouchEvent&&evt.touches.length>1)){var mouseDownPanZoom=_this.mouseDownPanZoom,mouseCartCoord=getMouseCartCoord(evt,_this.element,mouseDownPanZoom,_this.dpr),buttonDirection=_this.extensionPoint.direction,mouseOffsetDegree=diffPoints(_this.mouseDownWorldPos,mouseCartCoord),mouseOffsetChangeYAmount=mouseOffsetDegree.y>0?Math.floor(mouseOffsetDegree.y/minAmountForExtension):Math.ceil(mouseOffsetDegree.y/minAmountForExtension),mouseOffsetChangeXAmount=mouseOffsetDegree.x>0?Math.floor(mouseOffsetDegree.x/minAmountForExtension):Math.ceil(mouseOffsetDegree.x/minAmountForExtension);if(0!=Math.abs(mouseOffsetChangeYAmount)||0!=Math.abs(mouseOffsetChangeXAmount)){var updatedRowCount=buttonDirection===config.pr.TOP||buttonDirection===config.pr.TOPLEFT||buttonDirection===config.pr.TOPRIGHT?dataLayerRowCount+mouseOffsetChangeYAmount:dataLayerRowCount-mouseOffsetChangeYAmount,updatedColumnCount=buttonDirection===config.pr.TOPLEFT||buttonDirection===config.pr.BOTTOMLEFT||buttonDirection===config.pr.LEFT?dataLayerColumnCount+mouseOffsetChangeXAmount:dataLayerColumnCount-mouseOffsetChangeXAmount,interactionLayerRowCount=getRowCountFromData(interactionCapturedData),interactionLayerColumnCount=getColumnCountFromData(interactionCapturedData),updatedRowCountDifference=updatedRowCount-interactionLayerRowCount,updatedColumnCountDifference=updatedColumnCount-interactionLayerColumnCount;if(buttonDirection){var isRowSizeModifiable=!(buttonDirection===config.pr.LEFT||buttonDirection===config.pr.RIGHT)&&updatedRowCountDifference%_this.resizeUnit==0,isColumnSizeModifiable=!(buttonDirection===config.pr.TOP||buttonDirection===config.pr.BOTTOM)&&updatedColumnCountDifference%_this.resizeUnit==0;if(isRowSizeModifiable)if(updatedRowCount>interactionLayerRowCount){var validUpdatedRowCount=updatedRowCount;_this.maxRowCount&&updatedRowCount>_this.maxRowCount&&(validUpdatedRowCount=_this.maxRowCount),_this.extendInteractionGridBy(buttonDirection,{x:0,y:validUpdatedRowCount-interactionLayerRowCount})}else updatedRowCount>=_this.minRowCount?_this.shortenInteractionGridBy(buttonDirection,{x:0,y:interactionLayerRowCount-updatedRowCount}):_this.shortenInteractionGridBy(buttonDirection,{x:0,y:interactionLayerRowCount-_this.minRowCount});if(isColumnSizeModifiable)if(updatedColumnCount>interactionLayerColumnCount){var validUpdatedColumnCount=updatedColumnCount;_this.maxColumnCount&&updatedColumnCount>_this.maxColumnCount&&(validUpdatedColumnCount=_this.maxColumnCount),_this.extendInteractionGridBy(buttonDirection,{x:validUpdatedColumnCount-interactionLayerColumnCount,y:0})}else updatedColumnCount>=_this.minColumnCount?_this.shortenInteractionGridBy(buttonDirection,{x:interactionLayerColumnCount-updatedColumnCount,y:0}):_this.shortenInteractionGridBy(buttonDirection,{x:interactionLayerColumnCount-_this.minColumnCount,y:0});_this.interactionLayer.setCriterionDataForRendering(_this.interactionLayer.getCapturedData()),_this.lastRenderAllCall&&cancelAnimationFrame(_this.lastRenderAllCall),_this.lastRenderAllCall=requestAnimationFrame((function(){_this.renderAll(),_this.lastRenderAllCall=null}))}}}},_this.handlePinchZoom=function(evt){if(_this.isPanZoomable&&!_this.interactionLayer.getCapturedData()){var currentPinchCenter=getCenterCartCoordFromTwoTouches(evt,_this.element,_this.panZoom,_this.dpr);if(currentPinchCenter){_this.panPoint.lastMousePos=currentPinchCenter;var newZoomInfo=calculateNewPanZoomFromPinchZoom(evt,_this.element,_this.panZoom,_this.zoomSensitivity,_this.pinchZoomDiff,_this.minScale,_this.maxScale);newZoomInfo&&(_this.pinchZoomDiff=newZoomInfo.pinchZoomDiff,_this.setPanZoom({scale:newZoomInfo.panZoom.scale,offset:newZoomInfo.panZoom.offset}))}}},_this.handleKeyDown=function(e){"KeyZ"===e.code&&(e.ctrlKey||e.metaKey)&&_this.undo(),"KeyY"===e.code&&(e.ctrlKey||e.metaKey)&&_this.redo()},_this.handleWheel=function(e){if(e.preventDefault(),_this.isPanZoomable&&_this.mouseMode!==config.Om.EXTENDING)if(e.ctrlKey){var zoom=1-e.deltaY/_this.zoomSensitivity,newScale=_this.panZoom.scale*zoom;newScale>_this.maxScale&&(newScale=_this.maxScale),newScale<_this.minScale&&(newScale=_this.minScale);var mouseOffset={x:e.offsetX,y:e.offsetY},newOffset=returnScrollOffsetFromMouseOffset(mouseOffset,_this.panZoom,newScale);_this.setPanZoom({scale:newScale,offset:newOffset})}else{var offset=diffPoints(_this.panZoom.offset,{x:e.deltaX,y:e.deltaY});_this.setPanZoom((0,objectSpread2.Z)((0,objectSpread2.Z)({},_this.panZoom),{},{offset}))}},_this.handlePanning=function(evt){var lastMousePos=(0,objectSpread2.Z)({},_this.panPoint.lastMousePos),point=getPointFromTouchyEvent(evt,_this.element,_this.panZoom),currentMousePos={x:point.offsetX,y:point.offsetY};_this.panPoint.lastMousePos=currentMousePos;var mouseDiff=diffPoints(lastMousePos,currentMousePos),offset=diffPoints(_this.panZoom.offset,mouseDiff);_this.setPanZoom({offset})},_this.gridSquareLength=gridSquareLength||_this.gridSquareLength,_this.dataLayer=new DataLayer({canvas:dataCanvas,layers:initLayers});var topRowIndex=_this.dataLayer.getTopRowIndex(),leftColumnIndex=_this.dataLayer.getLeftColumnIndex();_this.originalLayerIdsInOrderForHistory=_this.dataLayer.getLayers().map((function(layer){return layer.getId()}));var initRowCount=_this.dataLayer.getRowCount(),initColumnCount=_this.dataLayer.getColumnCount();return _this.gridLayer=new GridLayer({columnCount:initColumnCount,rowCount:initRowCount,canvas:gridCanvas}),_this.interactionLayer=new InteractionLayer({columnCount:initColumnCount,rowCount:initRowCount,canvas:interactionCanvas}),_this.setTopLeftIndices(topRowIndex,leftColumnIndex),_this.foregroundCanvasElement=foregroundCanvas,_this.foregroundCtx=foregroundCanvas.getContext("2d"),_this.backgroundCanvasElement=backgroundCanvas,_this.backgroundCtx=backgroundCanvas.getContext("2d"),_this.interactionLayer.setCriterionDataForRendering(_this.dataLayer.getData()),_this.gridLayer.setCriterionDataForRendering(_this.dataLayer.getData()),_this.dataLayer.setCriterionDataForRendering(_this.dataLayer.getData()),_this.element=interactionCanvas,dpr&&_this.scale(dpr,dpr),_this.setSize(width,height),_this.adjustInitialZoomScale({width:initColumnCount,height:initRowCount},!1===initAutoScale?1:void 0),_this.initialize(),_this.dataLayer.updateCapturedImageBitmap(),_this}return(0,createClass.Z)(Editor,[{key:"initialize",value:function initialize(){this.emit=this.emit.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onMouseOut=this.onMouseOut.bind(this),this.onMouseDown=this.onMouseDown.bind(this),this.onMouseMove=this.onMouseMove.bind(this),touchy(this.element,addEvent,"mousedown",this.onMouseDown),touchy(this.element,addEvent,"mouseup",this.onMouseUp),touchy(this.element,addEvent,"mouseout",this.onMouseOut),touchy(this.element,addEvent,"mousemove",this.onMouseMove),this.element.addEventListener("wheel",this.handleWheel)}},{key:"adjustInitialZoomScale",value:function adjustInitialZoomScale(dimensions,initScale){var width=dimensions.width,height=dimensions.height,gridWidth=width*this.gridSquareLength,canvasWidth=this.width,gridHeight=height*this.gridSquareLength,canvasHeight=this.height,horizontalScale=canvasWidth/(gridWidth+2*Math.max((canvasWidth-gridWidth)/2,20)),verticalScale=canvasHeight/(gridHeight+2*Math.max((canvasHeight-gridHeight)/2,20)),scale=initScale||Math.min(horizontalScale,verticalScale),originWordPos={x:0,y:0},canvasMiddlePoint={x:canvasWidth/2,y:canvasHeight/2},diff=diffPoints(getScreenPoint(canvasMiddlePoint,{scale:1,offset:originWordPos}),getScreenPoint(canvasMiddlePoint,{scale,offset:originWordPos}));this.setPanZoom({scale,offset:{x:diff.x-width/2*this.gridSquareLength*scale,y:diff.y-height/2*this.gridSquareLength*scale}})}},{key:"emitCurrentGridStatus",value:function emitCurrentGridStatus(){var data=this.dataLayer.getData(),dimensions={columnCount:this.getColumnCount(),rowCount:this.getRowCount()},indices=getGridIndicesFromData(data);this.emitGridChangeEvent({dimensions,indices})}},{key:"emitCurrentHoverPixelStatus",value:function emitCurrentHoverPixelStatus(){this.emitHoverPixelChangeEvent({indices:this.interactionLayer.getHoveredPixel()})}},{key:"emitCurrentData",value:function emitCurrentData(){this.emitDataChangeEvent({isLocalChange:!1,data:this.dataLayer.getData(),layerId:this.dataLayer.getCurrentLayer().getId()})}},{key:"emitCurrentBrushTool",value:function emitCurrentBrushTool(){this.emitBrushChangeEvent({brushColor:this.brushColor,brushTool:this.brushTool,brushPattern:this.interactionLayer.getBrushPattern()})}},{key:"emitCurrentLayerStatus",value:function emitCurrentLayerStatus(){this.emitLayerChangeEvent({layers:this.dataLayer.getLayers(),currentLayer:this.dataLayer.getCurrentLayer()})}},{key:"emitCurrentCanvasInfoStatus",value:function emitCurrentCanvasInfoStatus(baseColumnCount,baseRowCount){var leftTopPoint={x:this.leftColumnIndex*this.gridSquareLength,y:this.topRowIndex*this.gridSquareLength},correctedLeftTopScreenPoint=getScreenPoint(convertCartesianToScreen(this.element,leftTopPoint,this.dpr),this.panZoom),gridSquareSize=this.gridSquareLength*this.panZoom.scale,columnCount=baseColumnCount||this.dataLayer.getColumnCount(),rowCount=baseRowCount||this.dataLayer.getRowCount();this.emitCanvasInfoChangeEvent({panZoom:this.panZoom,topLeftCornerOffset:correctedLeftTopScreenPoint,topRightCornerOffset:{x:correctedLeftTopScreenPoint.x+columnCount*gridSquareSize,y:correctedLeftTopScreenPoint.y},bottomLeftCornerOffset:{x:correctedLeftTopScreenPoint.x,y:correctedLeftTopScreenPoint.y+rowCount*gridSquareSize},bottomRightCornerOffset:{x:correctedLeftTopScreenPoint.x+columnCount*gridSquareSize,y:correctedLeftTopScreenPoint.y+rowCount*gridSquareSize},gridSquareSize})}},{key:"emitCanvasInfoChangeEvent",value:function emitCanvasInfoChangeEvent(parmas){this.emit(types.v8.CANVAS_INFO_CHANGE,parmas)}},{key:"emitDataChangeEvent",value:function emitDataChangeEvent(params){this.emit(types.v8.DATA_CHANGE,params)}},{key:"emitGridChangeEvent",value:function emitGridChangeEvent(params){this.emit(types.v8.GRID_CHANGE,params)}},{key:"emitStrokeEndEvent",value:function emitStrokeEndEvent(params){this.emit(types.v8.STROKE_END,params)}},{key:"emitHoverPixelChangeEvent",value:function emitHoverPixelChangeEvent(params){this.emit(types.v8.HOVER_PIXEL_CHANGE,params)}},{key:"emitBrushChangeEvent",value:function emitBrushChangeEvent(params){this.emit(types.v8.BRUSH_CHANGE,params)}},{key:"emitLayerChangeEvent",value:function emitLayerChangeEvent(params){this.emit(types.v8.LAYER_CHANGE,params)}},{key:"setBrushPattern",value:function setBrushPattern(pattern){this.interactionLayer.setBrushPattern(pattern),this.emitBrushChangeEvent({brushColor:this.brushColor,brushTool:this.brushTool,brushPattern:this.interactionLayer.getBrushPattern()})}},{key:"setBackgroundColor",value:function setBackgroundColor(color){this.interactionLayer.setBackgroundColor(color)}},{key:"setIndicatorPixels",value:function setIndicatorPixels(indicatorPixels){this.interactionLayer.setIndicatorPixels(indicatorPixels),this.renderInteractionLayer()}},{key:"setIsGridFixed",value:function setIsGridFixed(isGridFixed){this.gridLayer.setIsGridFixed(isGridFixed),this.renderGridLayer()}},{key:"setGridStrokeColor",value:function setGridStrokeColor(color){this.gridLayer.setGridStrokeColor(color),this.renderGridLayer()}},{key:"setGridStrokeWidth",value:function setGridStrokeWidth(width){this.gridLayer.setGridStrokeWidth(width),this.renderGridLayer()}},{key:"setDefaultPixelColor",value:function setDefaultPixelColor(color){void 0!==color&&(this.dataLayer.setDefaultPixelColor(color),this.interactionLayer.setDefaultPixelColor(color),this.renderDataLayer(),this.dataLayer.updateCapturedImageBitmap())}},{key:"setGridSquareLength",value:function setGridSquareLength(length){var _this2=this;0!==length&&void 0!==length&&(this.gridSquareLength=length,this.gridLayer.setGridSquareLength(length),this.interactionLayer.setGridSquareLength(length),this.dataLayer.setGridSquareLength(length),this.dataLayer.updateCapturedImageBitmap(),this.lastRenderAllCall&&cancelAnimationFrame(this.lastRenderAllCall),this.lastRenderAllCall=requestAnimationFrame((function(){_this2.renderAll(),_this2.lastRenderAllCall=null})))}},{key:"setMinScale",value:function setMinScale(minScale){if(void 0!==minScale){if(minScale>this.maxScale)throw new Error("minScale cannot be greater than maxScale");this.minScale=minScale}}},{key:"setMaxScale",value:function setMaxScale(maxScale){if(void 0!==maxScale){if(maxScale<this.minScale)throw new Error("maxScale cannot be less than minScale");this.maxScale=maxScale}}},{key:"setIsGridVisible",value:function setIsGridVisible(isGridVisible){this.gridLayer.setIsGridVisible(isGridVisible),this.renderGridLayer()}},{key:"setIsPanZoomable",value:function setIsPanZoomable(isPanZoomable){void 0!==isPanZoomable&&(this.isPanZoomable=isPanZoomable)}},{key:"setIsDrawingEnabled",value:function setIsDrawingEnabled(isDrawingEnabled){void 0!==isDrawingEnabled&&(this.isDrawingEnabled=isDrawingEnabled)}},{key:"setIsInteractionApplicable",value:function setIsInteractionApplicable(isInteractionApplicable){void 0!==isInteractionApplicable&&(this.isInteractionApplicable=isInteractionApplicable)}},{key:"setBrushTool",value:function setBrushTool(tool){this.brushTool=tool,this.brushTool!==types.G3.SELECT&&(this.interactionLayer.setSelectedArea(null),this.interactionLayer.setSelectingArea(null)),this.emitBrushChangeEvent({brushColor:this.brushColor,brushTool:this.brushTool,brushPattern:this.interactionLayer.getBrushPattern()})}},{key:"setIsAltPressed",value:function setIsAltPressed(isAltPressed){this.isAltPressed=isAltPressed}},{key:"setResizeUnit",value:function setResizeUnit(resizeUnit){this.resizeUnit=resizeUnit}},{key:"setMaxColumnCount",value:function setMaxColumnCount(maxColumnCount){maxColumnCount>config.tj&&maxColumnCount>this.minColumnCount&&(this.maxColumnCount=maxColumnCount)}},{key:"setMaxRowCount",value:function setMaxRowCount(maxRowCount){maxRowCount>config.tj&&maxRowCount>this.minRowCount&&(this.maxRowCount=maxRowCount)}},{key:"setMinColumnCount",value:function setMinColumnCount(minColumnCount){minColumnCount>=config.tj&&(this.minColumnCount=minColumnCount)}},{key:"setMinRowCount",value:function setMinRowCount(minRowCount){minRowCount>=config.tj&&(this.minRowCount=minRowCount)}},{key:"changeBrushColor",value:function changeBrushColor(color){this.brushColor=color,this.emitBrushChangeEvent({brushColor:this.brushColor,brushTool:this.brushTool,brushPattern:this.interactionLayer.getBrushPattern()})}},{key:"setBrushColor",value:function setBrushColor(color){if(void 0!==color){this.brushColor=color;var hoveredPixel=this.interactionLayer.getHoveredPixel();hoveredPixel&&(this.interactionLayer.setHoveredPixel((0,objectSpread2.Z)((0,objectSpread2.Z)({},hoveredPixel),{},{color:this.brushColor})),this.renderDataLayer())}}},{key:"getBrushColor",value:function getBrushColor(){return this.brushColor}},{key:"getBrushPattern",value:function getBrushPattern(){return this.interactionLayer.getBrushPattern()}},{key:"getColumnCount",value:function getColumnCount(){return this.dataLayer.getColumnCount()}},{key:"getRowCount",value:function getRowCount(){return this.dataLayer.getRowCount()}},{key:"getGridIndices",value:function getGridIndices(){return this.dataLayer.getGridIndices()}},{key:"getGridSquareLength",value:function getGridSquareLength(){return this.gridSquareLength}},{key:"getMinScale",value:function getMinScale(){return this.minScale}},{key:"getMaxScale",value:function getMaxScale(){return this.maxScale}},{key:"detectButtonClicked",value:function detectButtonClicked(coord){var _this$gridLayer$getBu=this.gridLayer.getButtonsDimensions(),top=_this$gridLayer$getBu.top,bottom=_this$gridLayer$getBu.bottom,right=_this$gridLayer$getBu.right,left=_this$gridLayer$getBu.left,x=coord.x,y=coord.y,scaledYHeight=lerpRanges(this.panZoom.scale,this.maxScale,this.minScale,top.height,top.height*this.extensionAllowanceRatio),scaledXWidth=lerpRanges(this.panZoom.scale,this.maxScale,this.minScale,left.width,left.width*this.extensionAllowanceRatio);return x>=top.x&&x<=top.x+top.width&&y>=top.y-scaledYHeight+top.height&&y<=top.y+top.height?config.pr.TOP:x>=bottom.x&&x<=bottom.x+bottom.width&&y>=bottom.y&&y<=bottom.y+scaledYHeight?config.pr.BOTTOM:x>=left.x-scaledXWidth+left.width&&x<=left.x+left.width&&y>=left.y&&y<=left.y+left.height?config.pr.LEFT:x>=right.x&&x<=right.x+scaledXWidth&&y>=right.y&&y<=right.y+right.height?config.pr.RIGHT:x>=left.x-scaledXWidth+left.width&&x<=left.x+left.width&&y>=top.y-scaledYHeight+top.height&&y<=top.y+top.height?config.pr.TOPLEFT:x>=right.x&&x<=right.x+scaledXWidth&&y>=top.y-scaledYHeight+top.height&&y<=top.y+top.height?config.pr.TOPRIGHT:x>=left.x-scaledXWidth+left.width&&x<=left.x+left.width&&y>=bottom.y&&y<=bottom.y+scaledYHeight?config.pr.BOTTOMLEFT:x>=right.x&&x<=right.x+scaledXWidth&&y>=bottom.y&&y<=bottom.y+scaledYHeight?config.pr.BOTTOMRIGHT:null}},{key:"scale",value:function scale(x,y){this.dataLayer.scale(x,y),this.gridLayer.scale(x,y),this.interactionLayer.scale(x,y),this.foregroundCtx.scale(x,y),this.backgroundCtx.scale(x,y)}},{key:"setWidth",value:function setWidth(width,devicePixelRatio){this.width=width,this.dataLayer.setWidth(width,devicePixelRatio),this.gridLayer.setWidth(width,devicePixelRatio),this.interactionLayer.setWidth(width,devicePixelRatio),this.foregroundCanvasElement.width=devicePixelRatio?width*devicePixelRatio:width,this.foregroundCanvasElement.style.width="".concat(width,"px"),this.backgroundCanvasElement.width=devicePixelRatio?width*devicePixelRatio:width,this.backgroundCanvasElement.style.width="".concat(width,"px")}},{key:"setHeight",value:function setHeight(height,devicePixelRatio){this.height=height,this.dataLayer.setHeight(height,devicePixelRatio),this.gridLayer.setHeight(height,devicePixelRatio),this.interactionLayer.setHeight(height,devicePixelRatio),this.foregroundCanvasElement.height=devicePixelRatio?height*devicePixelRatio:height,this.foregroundCanvasElement.style.height="".concat(height,"px"),this.backgroundCanvasElement.height=devicePixelRatio?height*devicePixelRatio:height,this.backgroundCanvasElement.style.height="".concat(height,"px")}},{key:"getWidth",value:function getWidth(){return this.width}},{key:"getHeight",value:function getHeight(){return this.height}},{key:"getCanvasElement",value:function getCanvasElement(){return this.element}},{key:"getLayers",value:function getLayers(){return this.dataLayer.getLayers().map((function(layer){return{id:layer.getId(),data:layer.getData()}}))}},{key:"getLayersAsArray",value:function getLayersAsArray(){return this.dataLayer.getLayers().map((function(layer){return{id:layer.getId(),data:layer.getDataArray()}}))}},{key:"getPanZoom",value:function getPanZoom(){return this.panZoom}},{key:"setSize",value:function setSize(width,height,devicePixelRatio){this.setWidth(width,devicePixelRatio),this.setHeight(height,devicePixelRatio),this.setDpr(devicePixelRatio||this.dpr)}},{key:"setDpr",value:function setDpr(dpr){this.dpr=dpr,this.dataLayer.setDpr(dpr),this.gridLayer.setDpr(dpr),this.interactionLayer.setDpr(dpr),this.dataLayer.updateCapturedImageBitmap()}},{key:"setTopLeftIndices",value:function setTopLeftIndices(topRowIndex,leftColumnIndex){this.topRowIndex=topRowIndex,this.leftColumnIndex=leftColumnIndex,this.dataLayer.setTopRowIndex(topRowIndex),this.dataLayer.setLeftColumnIndex(leftColumnIndex),this.gridLayer.setTopRowIndex(topRowIndex),this.gridLayer.setLeftColumnIndex(leftColumnIndex),this.interactionLayer.setTopRowIndex(topRowIndex),this.interactionLayer.setLeftColumnIndex(leftColumnIndex)}},{key:"setCurrentLayer",value:function setCurrentLayer(layerId){if(!this.dataLayer.getLayer(layerId))throw new Error("Layer not found");this.dataLayer.setCurrentLayer(layerId),this.emitCurrentLayerStatus()}},{key:"addLayer",value:function addLayer(layerId,insertPosition,data){var shouldRecordAction=arguments.length>3&&void 0!==arguments[3]&&arguments[3],createdLayer=this.dataLayer.createLayer(layerId,data);this.dataLayer.getLayers().splice(insertPosition,0,createdLayer),shouldRecordAction&&this.recordAction(new LayerCreateAction(layerId,createdLayer,insertPosition)),this.renderDataLayer(),this.dataLayer.updateCapturedImageBitmap(),this.emitCurrentLayerStatus()}},{key:"removeLayer",value:function removeLayer(layerId){var shouldRecordAction=arguments.length>1&&void 0!==arguments[1]&&arguments[1],layer=this.dataLayer.getLayer(layerId);if(!layer)throw new Error("Layer not found");if(1===this.dataLayer.getLayers().length)throw new Error("Cannot delete last layer");var removeIndex=this.dataLayer.getLayerIndex(layerId);this.dataLayer.getLayers().splice(removeIndex,1),this.dataLayer.setCurrentLayer(this.dataLayer.getLayers()[0].getId()),shouldRecordAction&&this.recordAction(new LayerDeleteAction(layer.getId(),layer,removeIndex)),this.renderDataLayer(),this.dataLayer.updateCapturedImageBitmap(),this.emitCurrentLayerStatus()}},{key:"showLayer",value:function showLayer(layerId){this.dataLayer.showLayer(layerId),this.emitCurrentLayerStatus(),this.renderDataLayer(),this.dataLayer.updateCapturedImageBitmap()}},{key:"hideLayer",value:function hideLayer(layerId){this.dataLayer.hideLayer(layerId),this.emitCurrentLayerStatus(),this.renderDataLayer(),this.dataLayer.updateCapturedImageBitmap()}},{key:"isolateLayer",value:function isolateLayer(layerId){this.dataLayer.isolateLayer(layerId),this.emitCurrentLayerStatus(),this.renderDataLayer(),this.dataLayer.updateCapturedImageBitmap()}},{key:"showAllLayers",value:function showAllLayers(){this.dataLayer.showAllLayers(),this.emitCurrentLayerStatus(),this.renderDataLayer(),this.dataLayer.updateCapturedImageBitmap()}},{key:"changeLayerPosition",value:function changeLayerPosition(layerId,toIndex){var layer=this.dataLayer.getLayer(layerId);if(!layer)throw new Error("Layer not found");var fromIndex=this.dataLayer.getLayerIndex(layerId);this.dataLayer.getLayers().splice(fromIndex,1),this.dataLayer.getLayers().splice(toIndex,0,layer),this.emitCurrentLayerStatus(),this.renderDataLayer(),this.dataLayer.updateCapturedImageBitmap()}},{key:"reorderLayersByIds",value:function reorderLayersByIds(layerIds){this.dataLayer.reorderLayersByIds(layerIds),this.emitCurrentLayerStatus(),this.recordAction(new LayerReorderAction(this.originalLayerIdsInOrderForHistory,layerIds)),this.originalLayerIdsInOrderForHistory=this.dataLayer.getLayers().map((function(layer){return layer.getId()})),this.renderDataLayer(),this.dataLayer.updateCapturedImageBitmap()}},{key:"setData",value:function setData(data,layerId){var _this3=this,isLocalChange=arguments.length>2&&void 0!==arguments[2]&&arguments[2],_validateSquareArray=validateSquareArray(data),isDataValid=_validateSquareArray.isDataValid,rowCount=_validateSquareArray.rowCount,columnCount=_validateSquareArray.columnCount;if(!isDataValid)throw new InvalidSquareDataError;this.undoHistory=[],this.redoHistory=[];for(var leftColumnIndex=data[0][0].columnIndex,topRowIndex=data[0][0].rowIndex,newData=new Map,i=0;i<data.length;i++){newData.set(topRowIndex+i,new Map);for(var j=0;j<data[i].length;j++)newData.get(topRowIndex+i).set(leftColumnIndex+j,{color:data[i][j].color})}if(void 0===layerId){if(this.dataLayer.getLayers().length>1)throw new UnspecifiedLayerIdError;this.dataLayer.setData(newData)}else{var layer=this.dataLayer.getLayer(layerId);if(!layer)throw new LayerNotFoundError(layerId);var layerInfo=layer.getDataInfo();if(layerInfo.rowCount!==rowCount||layerInfo.columnCount!==columnCount)throw new InvalidDataDimensionsError;if(layerInfo.gridIndices.leftColumnIndex!==leftColumnIndex||layerInfo.gridIndices.topRowIndex!==topRowIndex)throw new InvalidDataIndicesError;this.dataLayer.setData(newData,layerId)}this.dataLayer.updateCapturedImageBitmap(),this.gridLayer.setCriterionDataForRendering(this.dataLayer.getData()),this.gridLayer.setRowCount(rowCount),this.gridLayer.setColumnCount(columnCount),this.interactionLayer.setDataLayerRowCount(rowCount),this.interactionLayer.setDataLayerColumnCount(columnCount),this.setTopLeftIndices(topRowIndex,leftColumnIndex),this.emitDataChangeEvent({isLocalChange,data:this.dataLayer.getData(),layerId:this.dataLayer.getCurrentLayer().getId()}),this.emitGridChangeEvent({dimensions:this.dataLayer.getDimensions(),indices:this.dataLayer.getGridIndices()}),this.emitCurrentCanvasInfoStatus(),this.interactionLayer.setCriterionDataForRendering(this.dataLayer.getData()),this.dataLayer.setCriterionDataForRendering(this.dataLayer.getData()),this.interactionLayer.resetCapturedData(),this.adjustInitialZoomScale({width:columnCount,height:rowCount}),this.lastRenderAllCall&&cancelAnimationFrame(this.lastRenderAllCall),this.lastRenderAllCall=requestAnimationFrame((function(){_this3.renderAll(),_this3.lastRenderAllCall=null}))}},{key:"setLayers",value:function setLayers(layers){validateLayers(layers),this.dataLayer.setLayers(layers),this.dataLayer.updateCapturedImageBitmap(),this.originalLayerIdsInOrderForHistory=layers.map((function(layer){return layer.id})),this.undoHistory=[],this.redoHistory=[],this.dataLayer.setCurrentLayer(layers[0].id),this.gridLayer.setCriterionDataForRendering(this.dataLayer.getData());var rowCount=this.dataLayer.getRowCount(),columnCount=this.dataLayer.getColumnCount();this.gridLayer.setRowCount(rowCount),this.gridLayer.setColumnCount(columnCount),this.interactionLayer.setDataLayerRowCount(rowCount),this.interactionLayer.setDataLayerColumnCount(columnCount);var topRowIndex=this.dataLayer.getTopRowIndex(),leftColumnIndex=this.dataLayer.getLeftColumnIndex();this.setTopLeftIndices(topRowIndex,leftColumnIndex),this.emitDataChangeEvent({isLocalChange:!1,data:this.dataLayer.getData(),layerId:this.dataLayer.getCurrentLayer().getId()}),this.emitGridChangeEvent({dimensions:this.dataLayer.getDimensions(),indices:this.dataLayer.getGridIndices()}),this.emitCurrentCanvasInfoStatus(),this.interactionLayer.setCriterionDataForRendering(this.dataLayer.getData()),this.dataLayer.setCriterionDataForRendering(this.dataLayer.getData()),this.interactionLayer.resetCapturedData(),this.adjustInitialZoomScale({width:columnCount,height:rowCount}),this.emitCurrentLayerStatus(),this.lastRenderAllCall&&cancelAnimationFrame(this.lastRenderAllCall),this.lastRenderAllCall=requestAnimationFrame(this.renderAll)}},{key:"convertWorldPosToCanvasOffset",value:function convertWorldPosToCanvasOffset(worldPos){return getScreenPoint(convertCartesianToScreen(this.element,worldPos,this.dpr),this.panZoom)}},{key:"setPanZoom",value:function setPanZoom(_ref2){var _this4=this,offset=_ref2.offset,scale=_ref2.scale,baseColumnCount=_ref2.baseColumnCount,baseRowCount=_ref2.baseRowCount,columnCount=baseColumnCount||this.dataLayer.getColumnCount(),rowCount=baseRowCount||this.dataLayer.getRowCount();if(scale&&(this.panZoom.scale=scale),offset){var correctedOffset=(0,objectSpread2.Z)({},offset),isGridRowsBiggerThanCanvas=rowCount*this.gridSquareLength*this.panZoom.scale>this.height,isGridColumnsBiggerThanCanvas=columnCount*this.gridSquareLength*this.panZoom.scale>this.width,leftTopCornerWorldPos={x:this.leftColumnIndex*this.gridSquareLength,y:this.topRowIndex*this.gridSquareLength},gridWidthInWorld=columnCount*this.gridSquareLength,gridHeightInWorld=rowCount*this.gridSquareLength,minXPosition=isGridColumnsBiggerThanCanvas?(-leftTopCornerWorldPos.x-this.width/2-gridWidthInWorld)*this.panZoom.scale:(-leftTopCornerWorldPos.x-this.width/2)*this.panZoom.scale,minYPosition=isGridRowsBiggerThanCanvas?(-leftTopCornerWorldPos.y-this.height/2-gridHeightInWorld)*this.panZoom.scale:(-leftTopCornerWorldPos.y-this.height/2)*this.panZoom.scale,maxXPosition=isGridColumnsBiggerThanCanvas?this.width-(this.width/2+leftTopCornerWorldPos.x)*this.panZoom.scale:this.width-(this.width/2+leftTopCornerWorldPos.x+gridWidthInWorld)*this.panZoom.scale,maxYPosition=isGridRowsBiggerThanCanvas?this.height-(this.height/2+leftTopCornerWorldPos.y)*this.panZoom.scale:this.height-(this.height/2+leftTopCornerWorldPos.y+gridHeightInWorld)*this.panZoom.scale;correctedOffset.x<minXPosition&&(correctedOffset.x=minXPosition),correctedOffset.y<minYPosition&&(correctedOffset.y=minYPosition),correctedOffset.x>maxXPosition&&(correctedOffset.x=maxXPosition),correctedOffset.y>maxYPosition&&(correctedOffset.y=maxYPosition),this.panZoom.offset=correctedOffset}this.panZoom.scale<config.xH?this.gridLayer.setIsGridVisible(!1):this.gridLayer.setIsGridVisible(!0),this.relayPanZoomToOtherLayers(),this.lastRenderAllCall&&cancelAnimationFrame(this.lastRenderAllCall),this.lastRenderAllCall=requestAnimationFrame((function(){_this4.renderAll(),_this4.lastRenderAllCall=null})),this.emitCurrentCanvasInfoStatus(baseColumnCount,baseRowCount)}},{key:"relayPanZoomToOtherLayers",value:function relayPanZoomToOtherLayers(){this.dataLayer.setPanZoom(this.panZoom),this.gridLayer.setPanZoom(this.panZoom),this.interactionLayer.setPanZoom(this.panZoom)}},{key:"addGridIndices",value:function addGridIndices(_ref3){var _this5=this,rowIndices=_ref3.rowIndices,columnIndices=_ref3.columnIndices,data=_ref3.data,layerId=_ref3.layerId,_ref3$isLocalChange=_ref3.isLocalChange,isLocalChange=void 0!==_ref3$isLocalChange&&_ref3$isLocalChange,_this$dataLayer$addGr=this.dataLayer.addGridIndices({rowIndicesToAdd:rowIndices,columnIndicesToAdd:columnIndices}),validColumnIndices=_this$dataLayer$addGr.validColumnIndices,validRowIndices=_this$dataLayer$addGr.validRowIndices,modifiedLayerId=layerId||this.dataLayer.getCurrentLayer().getId(),modifiedPixels=data&&data.length>0?this.dataLayer.updatePixelColors(data,modifiedLayerId):[],addedOrDeletedRows=validRowIndices.map((function(rowIndex){return{index:rowIndex,isDelete:!1}})),addedOrDeletedColumns=validColumnIndices.map((function(columnIndex){return{index:columnIndex,isDelete:!1}}));if(0!==validColumnIndices.length||0!==validRowIndices.length||0!==modifiedPixels.length){this.recordSizeChangeAction(validRowIndices,validColumnIndices,[],[],modifiedPixels.map((function(pixel){return(0,objectSpread2.Z)((0,objectSpread2.Z)({},pixel),{},{color:pixel.previousColor,previousColor:pixel.color})}))),this.emitDataChangeEvent({isLocalChange,data:this.dataLayer.getData(),layerId:modifiedLayerId,delta:{modifiedPixels,addedOrDeletedRows,addedOrDeletedColumns}});var updatedData=this.dataLayer.getData();this.dataLayer.updateCapturedImageBitmap();var updatedColumnCount=getColumnCountFromData(updatedData),updatedDimensions={rowCount:getRowCountFromData(updatedData),columnCount:updatedColumnCount},updatedGridIndices=getGridIndicesFromData(updatedData);0===addedOrDeletedColumns.length&&0===addedOrDeletedRows.length||(this.emitGridChangeEvent({dimensions:updatedDimensions,indices:updatedGridIndices}),this.emitCurrentCanvasInfoStatus()),this.relayDataDimensionsToLayers(),this.gridLayer.setCriterionDataForRendering(this.dataLayer.getData()),this.dataLayer.setCriterionDataForRendering(this.dataLayer.getData()),this.interactionLayer.resetCapturedData(),this.interactionLayer.setCriterionDataForRendering(this.dataLayer.getData());var topRowIndex=this.dataLayer.getTopRowIndex(),leftColumnIndex=this.dataLayer.getLeftColumnIndex();this.setTopLeftIndices(topRowIndex,leftColumnIndex),this.dataLayer.updateCapturedImageBitmap(),this.lastRenderAllCall&&cancelAnimationFrame(this.lastRenderAllCall),this.lastRenderAllCall=requestAnimationFrame((function(){_this5.renderAll(),_this5.lastRenderAllCall=null}))}}},{key:"deleteGridIndices",value:function deleteGridIndices(_ref4){var _this6=this,rowIndices=_ref4.rowIndices,columnIndices=_ref4.columnIndices,layerId=_ref4.layerId,_ref4$isLocalChange=_ref4.isLocalChange,isLocalChange=void 0!==_ref4$isLocalChange&&_ref4$isLocalChange,_this$dataLayer$delet=this.dataLayer.deleteGridIndices({rowIndicesToDelete:rowIndices,columnIndicesToDelete:columnIndices}),validColumnIndices=_this$dataLayer$delet.validColumnIndices,validRowIndices=_this$dataLayer$delet.validRowIndices,swipedPixels=_this$dataLayer$delet.swipedPixels,modifiedLayerId=layerId||this.dataLayer.getCurrentLayer().getId(),addedOrDeletedRows=validRowIndices.map((function(rowIndex){return{index:rowIndex,isDelete:!0}})),addedOrDeletedColumns=validColumnIndices.map((function(columnIndex){return{index:columnIndex,isDelete:!0}}));if(0!==validColumnIndices.length||0!==validRowIndices.length||0!==swipedPixels.length){this.recordSizeChangeAction([],[],validRowIndices,validColumnIndices,swipedPixels),this.emitDataChangeEvent({isLocalChange,data:this.dataLayer.getData(),layerId:modifiedLayerId,delta:{modifiedPixels:[],addedOrDeletedRows,addedOrDeletedColumns}});var updatedData=this.dataLayer.getData();this.dataLayer.updateCapturedImageBitmap();var updatedColumnCount=getColumnCountFromData(updatedData),updatedDimensions={rowCount:getRowCountFromData(updatedData),columnCount:updatedColumnCount},updatedGridIndices=getGridIndicesFromData(updatedData);0===addedOrDeletedColumns.length&&0===addedOrDeletedRows.length||(this.emitGridChangeEvent({dimensions:updatedDimensions,indices:updatedGridIndices}),this.emitCurrentCanvasInfoStatus()),this.relayDataDimensionsToLayers(),this.gridLayer.setCriterionDataForRendering(this.dataLayer.getData()),this.dataLayer.setCriterionDataForRendering(this.dataLayer.getData()),this.interactionLayer.resetCapturedData(),this.interactionLayer.setCriterionDataForRendering(this.dataLayer.getData());var topRowIndex=this.dataLayer.getTopRowIndex(),leftColumnIndex=this.dataLayer.getLeftColumnIndex();this.setTopLeftIndices(topRowIndex,leftColumnIndex),this.dataLayer.updateCapturedImageBitmap(),this.lastRenderAllCall&&cancelAnimationFrame(this.lastRenderAllCall),this.lastRenderAllCall=requestAnimationFrame((function(){_this6.renderAll(),_this6.lastRenderAllCall=null}))}}},{key:"extendInteractionGridBy",value:function extendInteractionGridBy(direction,amount){var extendAmount={x:0,y:0},interactionLayer=this.interactionLayer,interactionCapturedData=interactionLayer.getCapturedData();if(interactionCapturedData&&!(amount.x<=0&&amount.y<=0)){for(var _i=0,_Object$entries=Object.entries(amount);_i<_Object$entries.length;_i++)for(var _Object$entries$_i=(0,slicedToArray.Z)(_Object$entries[_i],2),key=_Object$entries$_i[0],value=_Object$entries$_i[1],i=0;i<value;i++)direction!==config.pr.TOPLEFT&&direction!==config.pr.TOPRIGHT||"y"!==key?direction!==config.pr.BOTTOMLEFT&&direction!==config.pr.BOTTOMRIGHT||"y"!==key?direction!==config.pr.TOPLEFT&&direction!==config.pr.BOTTOMLEFT||"x"!==key?direction!==config.pr.TOPRIGHT&&direction!==config.pr.BOTTOMRIGHT||"x"!==key?interactionLayer.extendCapturedData(direction):interactionLayer.extendCapturedData(config.pr.RIGHT):interactionLayer.extendCapturedData(config.pr.LEFT):interactionLayer.extendCapturedData(config.pr.BOTTOM):interactionLayer.extendCapturedData(config.pr.TOP),"x"===key?extendAmount.x+=1:"y"===key&&(extendAmount.y+=1);var updatedGridIndices=getGridIndicesFromData(interactionCapturedData);this.interactionLayer.setTopRowIndex(updatedGridIndices.topRowIndex),this.interactionLayer.setLeftColumnIndex(updatedGridIndices.leftColumnIndex),this.gridLayer.setTopRowIndex(updatedGridIndices.topRowIndex),this.gridLayer.setLeftColumnIndex(updatedGridIndices.leftColumnIndex)}}},{key:"shortenInteractionGridBy",value:function shortenInteractionGridBy(direction,amount){var interactionLayer=this.interactionLayer,shortenAmount={x:0,y:0};if(!(amount.x<=0&&amount.y<=0)){for(var _i2=0,_Object$entries2=Object.entries(amount);_i2<_Object$entries2.length;_i2++)for(var _Object$entries2$_i=(0,slicedToArray.Z)(_Object$entries2[_i2],2),key=_Object$entries2$_i[0],value=_Object$entries2$_i[1],i=0;i<value;i++)direction!==config.pr.TOPLEFT&&direction!==config.pr.TOPRIGHT||"y"!==key?direction!==config.pr.BOTTOMLEFT&&direction!==config.pr.BOTTOMRIGHT||"y"!==key?direction!==config.pr.TOPLEFT&&direction!==config.pr.BOTTOMLEFT||"x"!==key?direction!==config.pr.TOPRIGHT&&direction!==config.pr.BOTTOMRIGHT||"x"!==key?interactionLayer.shortenCapturedData(direction):interactionLayer.shortenCapturedData(config.pr.RIGHT):interactionLayer.shortenCapturedData(config.pr.LEFT):interactionLayer.shortenCapturedData(config.pr.BOTTOM):interactionLayer.shortenCapturedData(config.pr.TOP),"x"===key?shortenAmount.x+=1:"y"===key&&(shortenAmount.y+=1);var updatedGridIndices=getGridIndicesFromData(interactionLayer.getCapturedData());this.interactionLayer.setTopRowIndex(updatedGridIndices.topRowIndex),this.interactionLayer.setLeftColumnIndex(updatedGridIndices.leftColumnIndex),this.gridLayer.setLeftColumnIndex(updatedGridIndices.leftColumnIndex),this.gridLayer.setTopRowIndex(updatedGridIndices.topRowIndex)}}},{key:"drawPixelInInteractionLayer",value:function drawPixelInInteractionLayer(rowIndex,columnIndex,brushPattern){var interactionLayer=this.interactionLayer,data=this.dataLayer.getData(),brushPatternWidth=brushPattern.length,brushPatternHeight=brushPattern[0].length,brushPatternCenterRowIndex=Math.floor(brushPatternHeight/2),brushPatternCenterColumnIndex=Math.floor(brushPatternWidth/2);if(this.brushTool===types.G3.ERASER)for(var i=0;i<brushPattern.length;i++)for(var j=0;j<brushPattern[i].length;j++){var _data$get,_data$get$get;if(0!==brushPattern[i][j]){var previousColor=null===(_data$get=data.get(rowIndex+i-brushPatternCenterRowIndex))||void 0===_data$get||null===(_data$get$get=_data$get.get(columnIndex+j-brushPatternCenterColumnIndex))||void 0===_data$get$get?void 0:_data$get$get.color;interactionLayer.addToErasedPixelRecords(config.s9,{rowIndex:rowIndex+i-brushPatternCenterRowIndex,columnIndex:columnIndex+j-brushPatternCenterColumnIndex,color:"",previousColor})}}else if(this.brushTool===types.G3.DOT)for(var _i3=0;_i3<brushPattern.length;_i3++)for(var _j=0;_j<brushPattern[_i3].length;_j++){var _data$get2,_data$get2$get;if(0!==brushPattern[_i3][_j]){var _getGridIndicesFromDa=getGridIndicesFromData(data),topRowIndex=_getGridIndicesFromDa.topRowIndex,leftColumnIndex=_getGridIndicesFromDa.leftColumnIndex,bottomRowIndex=_getGridIndicesFromDa.bottomRowIndex,rightColumnIndex=_getGridIndicesFromDa.rightColumnIndex,rowIndexToColor=rowIndex+_i3-brushPatternCenterRowIndex,columnIndexToColor=columnIndex+_j-brushPatternCenterColumnIndex;if(!(rowIndexToColor<topRowIndex||rowIndexToColor>bottomRowIndex||columnIndexToColor<leftColumnIndex||columnIndexToColor>rightColumnIndex)){var _previousColor=null===(_data$get2=data.get(rowIndexToColor))||void 0===_data$get2||null===(_data$get2$get=_data$get2.get(columnIndexToColor))||void 0===_data$get2$get?void 0:_data$get2$get.color;interactionLayer.addToStrokePixelRecords(config.s9,{rowIndex:rowIndexToColor,columnIndex:columnIndexToColor,color:this.brushColor,previousColor:_previousColor})}}}else if(this.brushTool===types.G3.PAINT_BUCKET){var _data$get3,_data$get3$get,gridIndices=getGridIndicesFromData(data),initialSelectedColor=null===(_data$get3=data.get(rowIndex))||void 0===_data$get3||null===(_data$get3$get=_data$get3.get(columnIndex))||void 0===_data$get3$get?void 0:_data$get3$get.color;if(initialSelectedColor===this.brushColor)return;this.colorPixelsArea(initialSelectedColor,gridIndices,{rowIndex,columnIndex})}this.renderInteractionLayer()}},{key:"relayDataDimensionsToLayers",value:function relayDataDimensionsToLayers(){var columnCount=getColumnCountFromData(this.dataLayer.getData());this.gridLayer.setColumnCount(columnCount),this.interactionLayer.setDataLayerColumnCount(columnCount);var rowCount=getRowCountFromData(this.dataLayer.getData());this.gridLayer.setRowCount(rowCount),this.interactionLayer.setDataLayerRowCount(rowCount)}},{key:"relayInteractionDataToDataLayer",value:function relayInteractionDataToDataLayer(){var interactionLayer=this.interactionLayer,isDataModified=!1;if(this.isInteractionApplicable){var strokedPixelModifyItems=interactionLayer.getEffectiveStrokePixelChanges(config.s9),erasedPixelModifyItems=interactionLayer.getEffectiveEraserPixelChanges(config.s9),pixelModifyItems=[].concat((0,toConsumableArray.Z)(strokedPixelModifyItems),(0,toConsumableArray.Z)(erasedPixelModifyItems)),modifiedPixels=[],addedOrDeletedRows=[],addedOrDeletedColumns=[];if(0!==pixelModifyItems.length){var _this$dataLayer$color=this.dataLayer.colorPixels(pixelModifyItems,this.dataLayer.getCurrentLayer().getId()),totalAddedColumnIndices=_this$dataLayer$color.totalAddedColumnIndices,totalAddedRowIndices=_this$dataLayer$color.totalAddedRowIndices;this.recordColorChangeAction(pixelModifyItems),modifiedPixels.push.apply(modifiedPixels,(0,toConsumableArray.Z)(pixelModifyItems)),addedOrDeletedColumns.push.apply(addedOrDeletedColumns,(0,toConsumableArray.Z)(totalAddedColumnIndices.map((function(index){return{index,isDelete:!1}})))),addedOrDeletedRows.push.apply(addedOrDeletedRows,(0,toConsumableArray.Z)(totalAddedRowIndices.map((function(index){return{index,isDelete:!1}})))),this.emitStrokeEndEvent({strokedPixels:pixelModifyItems,strokeTool:this.brushTool})}var capturedData=interactionLayer.getCapturedData();if(capturedData){var interactionGridIndices=getGridIndicesFromData(capturedData),dataGridIndices=this.interactionLayer.getCapturedDataOriginalIndices(),topRowDiff=interactionGridIndices.topRowIndex-dataGridIndices.topRowIndex,leftColumnDiff=interactionGridIndices.leftColumnIndex-dataGridIndices.leftColumnIndex,bottomRowDiff=interactionGridIndices.bottomRowIndex-dataGridIndices.bottomRowIndex,rightColumnDiff=interactionGridIndices.rightColumnIndex-dataGridIndices.rightColumnIndex;if(topRowDiff<0){var amount=-topRowDiff,addedRowIndices=Array.from(new Array(amount),(function(_,i){return dataGridIndices.topRowIndex-i-1}));addedOrDeletedRows.push.apply(addedOrDeletedRows,(0,toConsumableArray.Z)(addedRowIndices.map((function(index){return{index,isDelete:!1}}))))}else if(topRowDiff>0){var _amount=topRowDiff,deletedRowIndices=Array.from(new Array(_amount),(function(_,i){return dataGridIndices.topRowIndex+i}));addedOrDeletedRows.push.apply(addedOrDeletedRows,(0,toConsumableArray.Z)(deletedRowIndices.map((function(index){return{index,isDelete:!0}}))))}if(leftColumnDiff<0){var _amount2=-leftColumnDiff,addedColumnIndices=Array.from(new Array(_amount2),(function(_,i){return dataGridIndices.leftColumnIndex-i-1}));addedOrDeletedColumns.push.apply(addedOrDeletedColumns,(0,toConsumableArray.Z)(addedColumnIndices.map((function(index){return{index,isDelete:!1}}))))}else if(leftColumnDiff>0){var _amount3=leftColumnDiff,deletedColumnIndices=Array.from(new Array(_amount3),(function(_,i){return dataGridIndices.leftColumnIndex+i}));addedOrDeletedColumns.push.apply(addedOrDeletedColumns,(0,toConsumableArray.Z)(deletedColumnIndices.map((function(index){return{index,isDelete:!0}}))))}if(bottomRowDiff>0){var _amount4=bottomRowDiff,_addedRowIndices=Array.from(new Array(_amount4),(function(_,i){return dataGridIndices.bottomRowIndex+i+1}));addedOrDeletedRows.push.apply(addedOrDeletedRows,(0,toConsumableArray.Z)(_addedRowIndices.map((function(index){return{index,isDelete:!1}}))))}else if(bottomRowDiff<0){var _amount5=-bottomRowDiff,_deletedRowIndices=Array.from(new Array(_amount5),(function(_,i){return dataGridIndices.bottomRowIndex-i}));addedOrDeletedRows.push.apply(addedOrDeletedRows,(0,toConsumableArray.Z)(_deletedRowIndices.map((function(index){return{index,isDelete:!0}}))))}if(rightColumnDiff>0){var _amount6=rightColumnDiff,_addedColumnIndices=Array.from(new Array(_amount6),(function(_,i){return dataGridIndices.rightColumnIndex+i+1}));addedOrDeletedColumns.push.apply(addedOrDeletedColumns,(0,toConsumableArray.Z)(_addedColumnIndices.map((function(index){return{index,isDelete:!1}}))))}else if(rightColumnDiff<0){var _amount7=-rightColumnDiff,_deletedColumnIndices=Array.from(new Array(_amount7),(function(_,i){return dataGridIndices.rightColumnIndex-i}));addedOrDeletedColumns.push.apply(addedOrDeletedColumns,(0,toConsumableArray.Z)(_deletedColumnIndices.map((function(index){return{index,isDelete:!0}}))))}if(0!==addedOrDeletedColumns.length||0!==addedOrDeletedRows.length){var addedColumIndices=addedOrDeletedColumns.filter((function(item){return!1===item.isDelete})).map((function(el){return el.index})),_addedRowIndices2=addedOrDeletedRows.filter((function(item){return!1===item.isDelete})).map((function(el){return el.index})),_deletedColumnIndices2=addedOrDeletedColumns.filter((function(item){return!0===item.isDelete})).map((function(el){return el.index})),_deletedRowIndices2=addedOrDeletedRows.filter((function(item){return!0===item.isDelete})).map((function(el){return el.index}));this.dataLayer.addGridIndices({rowIndicesToAdd:_addedRowIndices2,columnIndicesToAdd:addedColumIndices});var swipedPixels=this.dataLayer.deleteGridIndices({rowIndicesToDelete:_deletedRowIndices2,columnIndicesToDelete:_deletedColumnIndices2}).swipedPixels;this.recordSizeChangeAction(_addedRowIndices2,addedColumIndices,_deletedRowIndices2,_deletedColumnIndices2,swipedPixels)}}var updatedData=this.dataLayer.getData();0===modifiedPixels.length&&0===addedOrDeletedRows.length&&0===addedOrDeletedColumns.length||(isDataModified=!0,this.emitDataChangeEvent({isLocalChange:!0,data:updatedData,layerId:this.dataLayer.getCurrentLayer().getId(),delta:{modifiedPixels,addedOrDeletedRows,addedOrDeletedColumns}}));var updatedColumnCount=getColumnCountFromData(updatedData),updatedDimensions={rowCount:getRowCountFromData(updatedData),columnCount:updatedColumnCount},updatedGridIndices=getGridIndicesFromData(updatedData);0===addedOrDeletedColumns.length&&0===addedOrDeletedRows.length||(this.setTopLeftIndices(updatedGridIndices.topRowIndex,updatedGridIndices.leftColumnIndex),this.emitGridChangeEvent({dimensions:updatedDimensions,indices:updatedGridIndices}),this.emitCurrentCanvasInfoStatus()),interactionLayer.deleteErasedPixelRecord(config.s9),interactionLayer.deleteStrokePixelRecord(config.s9),this.dataLayer.setCriterionDataForRendering(this.dataLayer.getData())}return this.relayDataDimensionsToLayers(),this.gridLayer.setCriterionDataForRendering(this.dataLayer.getData()),this.interactionLayer.setCriterionDataForRendering(this.dataLayer.getData()),interactionLayer.resetCapturedData(),isDataModified}},{key:"recordSizeChangeAction",value:function recordSizeChangeAction(rowIndicesToAdd,columnIndicesToAdd,rowIndicesToDelete,columnIndicesToDelete,deletedPixels){this.recordAction(new ColorSizeChangeAction(deletedPixels,rowIndicesToAdd,columnIndicesToAdd,rowIndicesToDelete,columnIndicesToDelete,this.dataLayer.getCurrentLayer().getId()))}},{key:"recordColorChangeAction",value:function recordColorChangeAction(pixelModifyItems){this.recordAction(new ColorChangeAction(pixelModifyItems,this.dataLayer.getCurrentLayer().getId()))}},{key:"commitAction",value:function commitAction(action){var type=action.getType(),layerId=action.getLayerId();type!==ActionType.SelectAreaMove&&(this.interactionLayer.setSelectedArea(null),this.setBrushTool(types.G3.DOT));var modifiedPixels=[],addedOrDeletedColumns=[],addedOrDeletedRows=[];switch(type){case ActionType.ColorChange:var colorChangeAction=action;this.dataLayer.updatePixelColors(colorChangeAction.data,layerId),modifiedPixels.push.apply(modifiedPixels,(0,toConsumableArray.Z)(colorChangeAction.data));break;case ActionType.ColorSizeChange:var colorSizeChangeAction=action,colorSizeChangeRowsToAdd=Array.from(colorSizeChangeAction.rowIndicesToAdd),colorSizeChangeRowsToDelete=Array.from(colorSizeChangeAction.rowIndicesToDelete),colorSizeChangeColumnsToAdd=Array.from(colorSizeChangeAction.columnIndicesToAdd),colorSizeChangeColumnsToDelete=Array.from(colorSizeChangeAction.columnIndicesToDelete);this.dataLayer.deleteGridIndices({rowIndicesToDelete:colorSizeChangeRowsToDelete,columnIndicesToDelete:colorSizeChangeColumnsToDelete}),this.dataLayer.addGridIndices({rowIndicesToAdd:colorSizeChangeRowsToAdd,columnIndicesToAdd:colorSizeChangeColumnsToAdd}),addedOrDeletedColumns.push.apply(addedOrDeletedColumns,(0,toConsumableArray.Z)(colorSizeChangeColumnsToDelete.map((function(index){return{index,isDelete:!0}}))).concat((0,toConsumableArray.Z)(colorSizeChangeColumnsToAdd.map((function(index){return{index,isDelete:!1}}))))),addedOrDeletedRows.push.apply(addedOrDeletedRows,(0,toConsumableArray.Z)(colorSizeChangeRowsToDelete.map((function(index){return{index,isDelete:!0}}))).concat((0,toConsumableArray.Z)(colorSizeChangeRowsToAdd.map((function(index){return{index,isDelete:!1}})))));var colorSizeChangePixels=colorSizeChangeAction.data;modifiedPixels.push.apply(modifiedPixels,(0,toConsumableArray.Z)(colorSizeChangePixels)),this.dataLayer.updatePixelColors(colorSizeChangePixels,layerId);break;case ActionType.SelectAreaMove:var selectAreamoveAction=action,updatedPixels=this.dataLayer.updatePixelColors(selectAreamoveAction.data,layerId);modifiedPixels.push.apply(modifiedPixels,(0,toConsumableArray.Z)(updatedPixels)),this.brushTool=types.G3.SELECT,this.interactionLayer.setSelectedArea(selectAreamoveAction.newSelectedArea);break;case ActionType.LayerCreate:var layerCreateAction=action;this.addLayer(layerCreateAction.layerId,layerCreateAction.removeIndex,layerCreateAction.layer.getDataArray());break;case ActionType.LayerDelete:var layerDeleteAction=action;this.removeLayer(layerDeleteAction.layerId),this.dataLayer.getCurrentLayer().getId()===layerDeleteAction.layerId&&this.dataLayer.setCurrentLayer(this.dataLayer.getLayers()[0].getId());break;case ActionType.LayerOrderChange:var layerOrderChangeAction=action;this.dataLayer.reorderLayersByIds(layerOrderChangeAction.reorderdLayerIds)}if(this.emitCurrentLayerStatus(),this.dataLayer.getLayer(layerId)){var updatedData=this.dataLayer.getLayer(layerId).getData(),leftColumnIndex=getColumnKeysFromData(updatedData)[0],topRowIndex=getRowKeysFromData(updatedData)[0];this.setTopLeftIndices(topRowIndex,leftColumnIndex),this.dataLayer.updateCapturedImageBitmap(),this.emitGridChangeEvent({dimensions:{rowCount:getRowCountFromData(updatedData),columnCount:getColumnCountFromData(updatedData)},indices:getGridIndicesFromData(updatedData)}),this.emitDataChangeEvent({isLocalChange:!0,data:updatedData,layerId,delta:{modifiedPixels,addedOrDeletedRows,addedOrDeletedColumns}})}}},{key:"recordAction",value:function recordAction(action){this.undoHistory.length>=this.maxHistoryCount&&this.undoHistory.shift(),this.undoHistory.push(action),this.redoHistory=[]}},{key:"undo",value:function undo(){var _this7=this;if(0!==this.undoHistory.length){var action=this.undoHistory.pop(),inverseAction=action.createInverseAction();this.commitAction(inverseAction),this.redoHistory.push(action);var rowCount=getRowCountFromData(this.dataLayer.getData()),columnCount=getColumnCountFromData(this.dataLayer.getData());this.gridLayer.setRowCount(rowCount),this.gridLayer.setColumnCount(columnCount),this.interactionLayer.setDataLayerRowCount(rowCount),this.interactionLayer.setDataLayerColumnCount(columnCount),this.gridLayer.setCriterionDataForRendering(this.dataLayer.getData()),this.dataLayer.setCriterionDataForRendering(this.dataLayer.getData()),this.interactionLayer.setCriterionDataForRendering(this.dataLayer.getData()),this.lastRenderAllCall&&cancelAnimationFrame(this.lastRenderAllCall),this.lastRenderAllCall=requestAnimationFrame((function(){_this7.renderAll(),_this7.lastRenderAllCall=null}))}}},{key:"redo",value:function redo(){var _this8=this;if(0!==this.redoHistory.length){var action=this.redoHistory.pop();this.commitAction(action),this.undoHistory.push(action);var rowCount=getRowCountFromData(this.dataLayer.getData()),columnCount=getColumnCountFromData(this.dataLayer.getData());this.gridLayer.setRowCount(rowCount),this.gridLayer.setColumnCount(columnCount),this.interactionLayer.setDataLayerRowCount(rowCount),this.interactionLayer.setDataLayerColumnCount(columnCount),this.gridLayer.setCriterionDataForRendering(this.dataLayer.getData()),this.dataLayer.setCriterionDataForRendering(this.dataLayer.getData()),this.interactionLayer.setCriterionDataForRendering(this.dataLayer.getData()),this.lastRenderAllCall&&cancelAnimationFrame(this.lastRenderAllCall),this.lastRenderAllCall=requestAnimationFrame((function(){_this8.renderAll(),_this8.lastRenderAllCall=null}))}}},{key:"erasePixels",value:function erasePixels(data,layerId){var _this9=this,isLocalChange=arguments.length>2&&void 0!==arguments[2]&&arguments[2],dataForAction=this.dataLayer.erasePixels(data,layerId).dataForAction,modifiedLayerId=layerId||this.dataLayer.getCurrentLayer().getId();null!==this.interactionLayer.getCapturedData()&&this.interactionLayer.erasePixels(data),this.dataLayer.updateCapturedImageBitmap(),this.recordAction(new ColorChangeAction(dataForAction,modifiedLayerId)),this.emitDataChangeEvent({isLocalChange,data:this.dataLayer.getLayer(modifiedLayerId).getData(),layerId:modifiedLayerId,delta:{modifiedPixels:dataForAction,addedOrDeletedColumns:[],addedOrDeletedRows:[]}}),this.lastRenderAllCall&&cancelAnimationFrame(this.lastRenderAllCall),this.lastRenderAllCall=requestAnimationFrame((function(){_this9.renderAll(),_this9.lastRenderAllCall=null}))}},{key:"colorPixels",value:function colorPixels(data,layerId){var _this10=this,isLocalChange=arguments.length>2&&void 0!==arguments[2]&&arguments[2],_this$dataLayer$color2=this.dataLayer.colorPixels(data,layerId),dataForAction=_this$dataLayer$color2.dataForAction,totalAddedColumnIndices=_this$dataLayer$color2.totalAddedColumnIndices,totalAddedRowIndices=_this$dataLayer$color2.totalAddedRowIndices,modifiedLayerId=layerId||this.dataLayer.getCurrentLayer().getId();null!==this.interactionLayer.getCapturedData()?(this.interactionLayer.colorPixels(data),this.interactionLayer.setCriterionDataForRendering(this.interactionLayer.getCapturedData())):this.interactionLayer.setCriterionDataForRendering(this.dataLayer.getLayer(modifiedLayerId).getData()),this.dataLayer.updateCapturedImageBitmap(),this.relayDataDimensionsToLayers(),this.recordAction(new ColorSizeChangeAction(dataForAction.map((function(item){return{rowIndex:item.rowIndex,columnIndex:item.columnIndex,color:item.previousColor}})),totalAddedRowIndices,totalAddedColumnIndices,[],[],modifiedLayerId)),this.emitDataChangeEvent({isLocalChange,data:this.dataLayer.getLayer(modifiedLayerId).getData(),layerId:modifiedLayerId,delta:{modifiedPixels:dataForAction,addedOrDeletedColumns:totalAddedColumnIndices.map((function(columnIndex){return{index:columnIndex,isDelete:!1}})),addedOrDeletedRows:totalAddedRowIndices.map((function(rowIndex){return{index:rowIndex,isDelete:!1}}))}});var criterionData=this.dataLayer.getLayer(modifiedLayerId).getData();this.gridLayer.setCriterionDataForRendering(criterionData),this.dataLayer.setCriterionDataForRendering(criterionData);var topRowIndex=this.dataLayer.getTopRowIndex(),leftColumnIndex=this.dataLayer.getLeftColumnIndex();this.setTopLeftIndices(topRowIndex,leftColumnIndex),this.dataLayer.updateCapturedImageBitmap(),this.lastRenderAllCall&&cancelAnimationFrame(this.lastRenderAllCall),this.lastRenderAllCall=requestAnimationFrame((function(){_this10.renderAll(),_this10.lastRenderAllCall=null}))}},{key:"colorPixelsArea",value:function colorPixelsArea(initialColor,gridIndices,currentIndices){var interactionLayer=this.interactionLayer,indicesQueue=new Queue;indicesQueue.enqueue(currentIndices),interactionLayer.setCapturedData(this.dataLayer.getCopiedData());for(var data=this.interactionLayer.getCapturedData();indicesQueue.size()>0;){var _data$get4,_ref5=indicesQueue.dequeue(),rowIndex=_ref5.rowIndex,columnIndex=_ref5.columnIndex;if(isValidIndicesRange(rowIndex,columnIndex,gridIndices)){var currentPixel=null===(_data$get4=data.get(rowIndex))||void 0===_data$get4?void 0:_data$get4.get(columnIndex);if(currentPixel&&(null==currentPixel?void 0:currentPixel.color)===initialColor){var color=this.brushColor,previousColor=data.get(rowIndex).get(columnIndex).color;data.get(rowIndex).get(columnIndex).color=color,interactionLayer.addToStrokePixelRecords(config.s9,{rowIndex,columnIndex,color,previousColor}),[{rowIndex:rowIndex-1,columnIndex},{rowIndex:rowIndex+1,columnIndex},{rowIndex,columnIndex:columnIndex-1},{rowIndex,columnIndex:columnIndex+1}].forEach((function(_ref6){var rowIndex=_ref6.rowIndex,columnIndex=_ref6.columnIndex;indicesQueue.enqueue({rowIndex,columnIndex})}))}}}}},{key:"onMouseDown",value:function onMouseDown(evt){evt.preventDefault();var point=getPointFromTouchyEvent(evt,this.element,this.panZoom);this.panPoint.lastMousePos={x:point.offsetX,y:point.offsetY};var mouseCartCoord=getMouseCartCoord(evt,this.element,this.panZoom,this.dpr);this.mouseDownWorldPos={x:mouseCartCoord.x,y:mouseCartCoord.y},this.mouseDownPanZoom={offset:{x:this.panZoom.offset.x,y:this.panZoom.offset.y},scale:this.panZoom.scale};var rowIndices=Array.from(this.dataLayer.getRowKeyOrderMap().keys()),columnIndices=Array.from(this.dataLayer.getColumnKeyOrderMap().keys()),pixelIndex=getPixelIndexFromMouseCartCoord(mouseCartCoord,rowIndices,columnIndices,this.gridSquareLength);this.mouseMode=pixelIndex?config.Om.DRAWING:config.Om.PANNING;var buttonDirection=this.detectButtonClicked(mouseCartCoord);if(buttonDirection&&(this.mouseMode=config.Om.EXTENDING),this.brushTool===types.G3.SELECT&&(this.mouseMode=config.Om.DRAWING),this.brushTool!==types.G3.NONE&&1!==evt.button||(this.element.style.cursor="grabbing",this.mouseMode=config.Om.PANNING),this.mouseMode===config.Om.DRAWING&&this.isDrawingEnabled)if(this.brushTool===types.G3.SELECT){var previousSelectedArea=this.interactionLayer.getSelectedArea(),isMouseCoordInSelectedArea=!1;if(previousSelectedArea){var directionToExtendSelectedArea=this.interactionLayer.detectSelectedAreaExtendDirection(this.mouseDownWorldPos);if(this.interactionLayer.setDirectionToExtendSelectedArea(directionToExtendSelectedArea),isMouseCoordInSelectedArea=getIsPointInsideRegion(this.mouseDownWorldPos,previousSelectedArea),null!==directionToExtendSelectedArea){var coloredPixels=this.getColoredPixelsInSelectedArea(previousSelectedArea,"");return this.interactionLayer.setExtendingSelectedArea(previousSelectedArea),this.interactionLayer.setExtendingSelectedPixels(coloredPixels),this.interactionLayer.setCapturedBaseExtendingSelectedArea(previousSelectedArea),this.interactionLayer.setCapturedBaseExtendingSelectedAreaPixels(coloredPixels),this.dataLayer.erasePixels(coloredPixels,this.dataLayer.getCurrentLayer().getId()),this.dataLayer.render(),void this.interactionLayer.render()}}if(isMouseCoordInSelectedArea){this.interactionLayer.setSelectingArea(null);var _coloredPixels=this.getColoredPixelsInSelectedArea(previousSelectedArea,"");this.dataLayer.erasePixels(_coloredPixels,this.dataLayer.getCurrentLayer().getId()),this.interactionLayer.setSelectedAreaPixels(_coloredPixels),this.interactionLayer.setMovingSelectedPixels(_coloredPixels),this.interactionLayer.setMovingSelectedArea(previousSelectedArea),this.dataLayer.render(),this.interactionLayer.render()}else this.interactionLayer.setSelectedArea(null),this.interactionLayer.setSelectingArea({startWorldPos:this.mouseDownWorldPos,endWorldPos:this.mouseDownWorldPos})}else this.brushTool!==types.G3.DOT&&this.brushTool!==types.G3.PAINT_BUCKET||pixelIndex&&(this.drawPixelInInteractionLayer(pixelIndex.rowIndex,pixelIndex.columnIndex,this.interactionLayer.getBrushPattern()),this.renderInteractionLayer());else if(this.mouseMode===config.Om.PANNING){var touchesCount=evt.touches&&evt.touches.length?evt.touches.length:0;if(2===touchesCount){this.mouseMode=config.Om.PINCHZOOMING;var centerCartCoord=getCenterCartCoordFromTwoTouches(evt,this.element,this.panZoom,this.dpr);centerCartCoord?(this.mouseDownWorldPos={x:centerCartCoord.x,y:centerCartCoord.y},this.panPoint.lastMousePos={x:centerCartCoord.x,y:centerCartCoord.y}):this.mouseMode=config.Om.NULL}else touchesCount>2&&(this.mouseMode=config.Om.NULL)}else if(this.mouseMode===config.Om.EXTENDING){this.gridLayer.getIsGridFixed()||buttonDirection&&(this.extensionPoint.direction=buttonDirection,this.mouseMode=config.Om.EXTENDING)}this.previousMouseMoveWorldPos=this.mouseDownWorldPos}},{key:"getColoredPixelsInSelectedArea",value:function getColoredPixelsInSelectedArea(selectedArea,newColor){var _convertWorldPosAreaT,data=this.dataLayer.getData(),rowCount=this.dataLayer.getRowCount(),columnCount=this.dataLayer.getColumnCount(),rowKeys=getRowKeysFromData(data),columnKeys=getColumnKeysFromData(data),sortedRowKeys=rowKeys.sort((function(a,b){return a-b})),sortedColumnKeys=columnKeys.sort((function(a,b){return a-b})),includedPixelsIndices=null===(_convertWorldPosAreaT=convertWorldPosAreaToPixelGridArea(selectedArea,rowCount,columnCount,this.gridSquareLength,sortedRowKeys,sortedColumnKeys))||void 0===_convertWorldPosAreaT?void 0:_convertWorldPosAreaT.includedPixelsIndices;if(!includedPixelsIndices)return[];var _step,_getGridIndicesFromDa2=getGridIndicesFromData(data),topRowIndex=_getGridIndicesFromDa2.topRowIndex,bottomRowIndex=_getGridIndicesFromDa2.bottomRowIndex,leftColumnIndex=_getGridIndicesFromDa2.leftColumnIndex,rightColumnIndex=_getGridIndicesFromDa2.rightColumnIndex,selectedAreaPixels=[],_iterator=(0,createForOfIteratorHelper.Z)(includedPixelsIndices);try{for(_iterator.s();!(_step=_iterator.n()).done;){var _data$get$get2,index=_step.value,rowIndex=index.rowIndex,columnIndex=index.columnIndex,color=null===(_data$get$get2=data.get(rowIndex).get(columnIndex))||void 0===_data$get$get2?void 0:_data$get$get2.color;color&&selectedAreaPixels.push({rowIndex,columnIndex,previousColor:color,color:newColor})}}catch(err){_iterator.e(err)}finally{_iterator.f()}var filteredSelectedAreaPixels=selectedAreaPixels.filter((function(_ref7){var rowIndex=_ref7.rowIndex,columnIndex=_ref7.columnIndex;return rowIndex>=topRowIndex&&rowIndex<=bottomRowIndex&&columnIndex>=leftColumnIndex&&columnIndex<=rightColumnIndex}));return filteredSelectedAreaPixels}},{key:"onMouseMove",value:function onMouseMove(evt){var _this11=this,mouseCartCoord=getMouseCartCoord(evt,this.element,this.panZoom,this.dpr);if(this.mouseMoveWorldPos={x:mouseCartCoord.x,y:mouseCartCoord.y},this.styleMouseCursor(mouseCartCoord),this.mouseMode===config.Om.NULL){if(!this.isDrawingEnabled||this.brushTool===types.G3.NONE)return;if(this.brushTool===types.G3.SELECT){var selectedArea=this.interactionLayer.getSelectedArea();return void(selectedArea&&(this.gridLayer.render(),this.gridLayer.renderSelection(selectedArea)))}var rowIndices=Array.from(this.dataLayer.getRowKeyOrderMap().keys()),columnIndices=Array.from(this.dataLayer.getColumnKeyOrderMap().keys()),hoveredPixel=this.interactionLayer.getHoveredPixel(),pixelIndex=getPixelIndexFromMouseCartCoord(mouseCartCoord,rowIndices,columnIndices,this.gridSquareLength);pixelIndex?hoveredPixel&&hoveredPixel.rowIndex===pixelIndex.rowIndex&&hoveredPixel.columnIndex===pixelIndex.columnIndex||(this.interactionLayer.setHoveredPixel({rowIndex:pixelIndex.rowIndex,columnIndex:pixelIndex.columnIndex,color:this.brushTool!==types.G3.ERASER?this.brushColor:"white"}),this.emitHoverPixelChangeEvent({indices:pixelIndex}),this.renderInteractionLayer()):(this.emitHoverPixelChangeEvent({indices:null}),this.interactionLayer.setHoveredPixel(null),this.renderInteractionLayer());var buttonDirection=this.detectButtonClicked(mouseCartCoord);this.gridLayer.setHoveredButton(buttonDirection),this.renderGridLayer()}else if(this.mouseMode===config.Om.EXTENDING){if(this.gridLayer.getIsGridFixed())return;var _buttonDirection=this.extensionPoint.direction;this.interactionLayer.getCapturedData()||(this.gridLayer.setHoveredButton(_buttonDirection),this.renderGridLayer()),this.handleExtension(evt)}else if(this.mouseMode===config.Om.PANNING){if(!this.isPanZoomable)return;this.handlePanning(evt)}else if(this.mouseMode===config.Om.PINCHZOOMING)this.handlePinchZoom(evt);else if(this.mouseMode==config.Om.DRAWING){if(!this.isDrawingEnabled)return;var _rowIndices=Array.from(this.dataLayer.getRowKeyOrderMap().keys()),_columnIndices=Array.from(this.dataLayer.getColumnKeyOrderMap().keys()),_pixelIndex=getPixelIndexFromMouseCartCoord(mouseCartCoord,_rowIndices,_columnIndices,this.gridSquareLength);if(this.brushTool===types.G3.SELECT){var previousSelectingArea=this.interactionLayer.getSelectingArea(),previousSelectedArea=this.interactionLayer.getSelectedArea(),previousSelectedAreaPixels=this.interactionLayer.getSelectedAreaPixels(),movingSelectedPixels=this.interactionLayer.getMovingSelectedPixels(),directionToExtendSelectedArea=this.interactionLayer.getDirectionToExtendSelectedArea();if(null!==directionToExtendSelectedArea&&(this.interactionLayer.extendSelectedArea(directionToExtendSelectedArea,this.mouseMoveWorldPos,this.isAltPressed),this.gridLayer.render(),this.gridLayer.renderSelection(this.interactionLayer.getExtendingSelectedArea()),this.interactionLayer.render()),movingSelectedPixels&&this.mouseDownWorldPos&&previousSelectedArea){var mouseMoveDistance=diffPoints(this.mouseDownWorldPos,this.mouseMoveWorldPos),pixelWiseDeltaX=Math.round(mouseMoveDistance.x/this.gridSquareLength),pixelWiseDeltaY=Math.round(mouseMoveDistance.y/this.gridSquareLength),newMovingSelectedPixels=previousSelectedAreaPixels.map((function(pixel){return(0,objectSpread2.Z)((0,objectSpread2.Z)({},pixel),{},{rowIndex:pixel.rowIndex-pixelWiseDeltaY,columnIndex:pixel.columnIndex-pixelWiseDeltaX})}));this.interactionLayer.setMovingSelectedArea({startWorldPos:{x:previousSelectedArea.startWorldPos.x-pixelWiseDeltaX*this.gridSquareLength,y:previousSelectedArea.startWorldPos.y-pixelWiseDeltaY*this.gridSquareLength},endWorldPos:{x:previousSelectedArea.endWorldPos.x-pixelWiseDeltaX*this.gridSquareLength,y:previousSelectedArea.endWorldPos.y-pixelWiseDeltaY*this.gridSquareLength},startPixelIndex:{rowIndex:previousSelectedArea.startPixelIndex.rowIndex-pixelWiseDeltaY,columnIndex:previousSelectedArea.startPixelIndex.columnIndex-pixelWiseDeltaX},endPixelIndex:{rowIndex:previousSelectedArea.endPixelIndex.rowIndex-pixelWiseDeltaY,columnIndex:previousSelectedArea.endPixelIndex.columnIndex-pixelWiseDeltaX}}),this.interactionLayer.setMovingSelectedPixels(newMovingSelectedPixels);var _selectedArea=this.interactionLayer.getMovingSelectedArea();return this.gridLayer.render(),this.gridLayer.renderSelection(_selectedArea),void this.interactionLayer.render()}if(null!==previousSelectingArea){this.interactionLayer.setSelectingArea({startWorldPos:this.mouseDownWorldPos,endWorldPos:this.mouseMoveWorldPos});var selectingArea=this.interactionLayer.getSelectingArea();return this.renderGridLayer(),void this.gridLayer.renderSelection(selectingArea)}}else{if(!this.isDrawingEnabled)return;if(_pixelIndex){this.drawPixelInInteractionLayer(_pixelIndex.rowIndex,_pixelIndex.columnIndex,this.interactionLayer.getBrushPattern());var missingIndices=getInBetweenPixelIndicesfromCoords(this.previousMouseMoveWorldPos,this.mouseMoveWorldPos,this.gridSquareLength,this.dataLayer.getData());null!=missingIndices&&missingIndices.length&&missingIndices.forEach((function(point){_this11.drawPixelInInteractionLayer(point.rowIndex,point.columnIndex,_this11.interactionLayer.getBrushPattern())})),this.renderInteractionLayer(),this.brushTool===types.G3.ERASER&&this.renderErasedPixelsFromInteractionLayerInDataLayer()}}}this.previousMouseMoveWorldPos=this.mouseMoveWorldPos}},{key:"getSelectedArea",value:function getSelectedArea(){return this.interactionLayer.getSelectedArea()}},{key:"onKeyDown",value:function onKeyDown(e){if("KeyZ"===e.code&&(e.ctrlKey||e.metaKey))this.undo();else if("KeyY"===e.code&&(e.ctrlKey||e.metaKey))this.redo();else if("Backspace"===e.code||"Delete"===e.code){if(this.interactionLayer.getSelectedArea()){if(0===this.interactionLayer.getSelectedAreaPixels().length)return;var previousSelectedAreaPixels=this.interactionLayer.getSelectedAreaPixels();if(!previousSelectedAreaPixels||0===previousSelectedAreaPixels.length)return;var dataForAction=this.dataLayer.erasePixels(this.interactionLayer.getSelectedAreaPixels()).dataForAction;this.recordAction(new SelectAreaMoveAction([].concat((0,toConsumableArray.Z)(dataForAction.map((function(pixel){return(0,objectSpread2.Z)((0,objectSpread2.Z)({},pixel),{},{color:""})}))),(0,toConsumableArray.Z)(dataForAction)),this.interactionLayer.getSelectedArea(),this.interactionLayer.getSelectedArea(),this.dataLayer.getCurrentLayer().getId())),this.dataLayer.render(),this.dataLayer.updateCapturedImageBitmap()}}else if("Escape"===e.code)this.interactionLayer.setExtendingSelectedArea(null),this.interactionLayer.setExtendingSelectedPixels([]),this.interactionLayer.setMovingSelectedArea(null),this.interactionLayer.setMovingSelectedPixels([]),this.interactionLayer.setSelectingArea(null),this.interactionLayer.setSelectedArea(null),this.interactionLayer.setSelectedAreaPixels([]),this.gridLayer.render();else if("AltLeft"===e.code){var pixelsThatAreCurrentlyExtending=this.interactionLayer.getExtendingSelectedPixels(),currentExtendingArea=this.interactionLayer.getExtendingSelectedArea();pixelsThatAreCurrentlyExtending&&currentExtendingArea&&(this.interactionLayer.setCapturedBaseExtendingSelectedArea(currentExtendingArea),this.interactionLayer.setCapturedBaseExtendingSelectedAreaPixels(pixelsThatAreCurrentlyExtending)),this.isAltPressed=!0}}},{key:"onKeyUp",value:function onKeyUp(e){if("AltLeft"===e.code){var pixelsThatAreCurrentlyExtending=this.interactionLayer.getExtendingSelectedPixels(),currentExtendingArea=this.interactionLayer.getExtendingSelectedArea();pixelsThatAreCurrentlyExtending&&currentExtendingArea&&(this.interactionLayer.setCapturedBaseExtendingSelectedArea(currentExtendingArea),this.interactionLayer.setCapturedBaseExtendingSelectedAreaPixels(pixelsThatAreCurrentlyExtending)),this.isAltPressed=!1}}},{key:"relaySelectingAreaToSelectedArea",value:function relaySelectingAreaToSelectedArea(){var selectingArea=this.interactionLayer.getSelectingArea();if(selectingArea){var data=this.dataLayer.getData(),rowCount=this.dataLayer.getRowCount(),columnCount=this.dataLayer.getColumnCount(),rowKeys=getRowKeysFromData(data),columnKeys=getColumnKeysFromData(data),sortedRowKeys=rowKeys.sort((function(a,b){return a-b})),sortedColumnKeys=columnKeys.sort((function(a,b){return a-b})),region=convertWorldPosAreaToPixelGridArea(selectingArea,rowCount,columnCount,this.gridSquareLength,sortedRowKeys,sortedColumnKeys);if(region){this.interactionLayer.setSelectedArea({startWorldPos:region.startWorldPos,endWorldPos:region.endWorldPos,startPixelIndex:region.includedPixelsIndices[0],endPixelIndex:region.includedPixelsIndices[region.includedPixelsIndices.length-1]});var _step2,pixelData=this.dataLayer.getData(),regionPixelItems=[],_iterator2=(0,createForOfIteratorHelper.Z)(region.includedPixelsIndices);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var _pixelData$get$get,index=_step2.value,rowIndex=index.rowIndex,columnIndex=index.columnIndex,color=null===(_pixelData$get$get=pixelData.get(rowIndex).get(columnIndex))||void 0===_pixelData$get$get?void 0:_pixelData$get$get.color;color&&regionPixelItems.push({rowIndex,columnIndex,previousColor:color,color:""})}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}this.interactionLayer.setSelectedAreaPixels(regionPixelItems),this.gridLayer.renderSelection({startWorldPos:region.startWorldPos,endWorldPos:region.endWorldPos})}}this.interactionLayer.setSelectingArea(null)}},{key:"relayExtendingSelectedAreaToSelectedArea",value:function relayExtendingSelectedAreaToSelectedArea(){var previousSelectedArea=this.interactionLayer.getSelectedArea(),previousSelectedAreaPixels=this.interactionLayer.getSelectedAreaPixels(),finalSelectedArea=this.interactionLayer.getExtendingSelectedArea(),finalSelectedAreaPixels=this.interactionLayer.getExtendingSelectedPixels();if(previousSelectedArea&&previousSelectedAreaPixels&&finalSelectedArea&&finalSelectedAreaPixels){var data=this.dataLayer.getData(),_getGridIndicesFromDa3=getGridIndicesFromData(data),topRowIndex=_getGridIndicesFromDa3.topRowIndex,bottomRowIndex=_getGridIndicesFromDa3.bottomRowIndex,leftColumnIndex=_getGridIndicesFromDa3.leftColumnIndex,rightColumnIndex=_getGridIndicesFromDa3.rightColumnIndex,filteredFinalSelectedAreaPixels=finalSelectedAreaPixels.filter((function(item){return item.rowIndex<=bottomRowIndex&&item.columnIndex<=rightColumnIndex&&item.rowIndex>=topRowIndex&&item.columnIndex>=leftColumnIndex})).map((function(item){var _data$get$get3,previousColor=null===(_data$get$get3=data.get(item.rowIndex).get(item.columnIndex))||void 0===_data$get$get3?void 0:_data$get$get3.color;return(0,objectSpread2.Z)((0,objectSpread2.Z)({},item),{},{color:item.previousColor,previousColor})})),newSelectedAreaColorChangeItems=this.dataLayer.colorPixels(filteredFinalSelectedAreaPixels,this.dataLayer.getCurrentLayer().getId()).dataForAction,previousSelectedAreaColorChangeItems=previousSelectedAreaPixels;this.recordAction(new SelectAreaMoveAction([].concat((0,toConsumableArray.Z)(newSelectedAreaColorChangeItems),(0,toConsumableArray.Z)(previousSelectedAreaColorChangeItems)),previousSelectedArea,finalSelectedArea,this.dataLayer.getCurrentLayer().getId()));var _step3,effectiveColorChangeItemsMap=new Map,_iterator3=(0,createForOfIteratorHelper.Z)(previousSelectedAreaColorChangeItems);try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var item=_step3.value;effectiveColorChangeItemsMap.set(generatePixelId(item.rowIndex,item.columnIndex),item)}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}var _step4,_iterator4=(0,createForOfIteratorHelper.Z)(newSelectedAreaColorChangeItems);try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var _item=_step4.value;effectiveColorChangeItemsMap.set(generatePixelId(_item.rowIndex,_item.columnIndex),_item)}}catch(err){_iterator4.e(err)}finally{_iterator4.f()}var effectiveColorChangeItems=Array.from(effectiveColorChangeItemsMap.values()),newData=this.dataLayer.getData();effectiveColorChangeItems.length>0&&(this.emitStrokeEndEvent({strokedPixels:effectiveColorChangeItems,strokeTool:types.G3.SELECT}),this.emitDataChangeEvent({isLocalChange:!0,data:newData,layerId:this.dataLayer.getCurrentLayer().getId(),delta:{modifiedPixels:effectiveColorChangeItems,addedOrDeletedColumns:[],addedOrDeletedRows:[]}})),this.interactionLayer.setSelectedArea(finalSelectedArea),this.interactionLayer.setSelectedAreaPixels(filteredFinalSelectedAreaPixels),this.interactionLayer.setExtendingSelectedArea(null),this.interactionLayer.setExtendingSelectedPixels(null),this.interactionLayer.setDirectionToExtendSelectedArea(null),this.gridLayer.render(),this.gridLayer.renderSelection(finalSelectedArea),this.interactionLayer.setSelectedAreaPixels(filteredFinalSelectedAreaPixels)}}},{key:"relayMovingSelectedAreaToSelectedArea",value:function relayMovingSelectedAreaToSelectedArea(){var previousSelectedArea=this.interactionLayer.getSelectedArea(),previousSelectedAreaPixels=this.interactionLayer.getSelectedAreaPixels(),finalSelectedArea=this.interactionLayer.getMovingSelectedArea(),finalSelectedAreaPixels=this.interactionLayer.getMovingSelectedPixels();if(previousSelectedArea&&previousSelectedAreaPixels&&finalSelectedArea&&finalSelectedAreaPixels){var data=this.dataLayer.getData(),_getGridIndicesFromDa4=getGridIndicesFromData(data),topRowIndex=_getGridIndicesFromDa4.topRowIndex,bottomRowIndex=_getGridIndicesFromDa4.bottomRowIndex,leftColumnIndex=_getGridIndicesFromDa4.leftColumnIndex,rightColumnIndex=_getGridIndicesFromDa4.rightColumnIndex,filteredFinalSelectedAreaPixels=finalSelectedAreaPixels.filter((function(item){return item.rowIndex<=bottomRowIndex&&item.columnIndex<=rightColumnIndex&&item.rowIndex>=topRowIndex&&item.columnIndex>=leftColumnIndex})).map((function(filteredItem){var _data$get$get4;return(0,objectSpread2.Z)((0,objectSpread2.Z)({},filteredItem),{},{color:filteredItem.previousColor,previousColor:(null===(_data$get$get4=data.get(filteredItem.rowIndex).get(filteredItem.columnIndex))||void 0===_data$get$get4?void 0:_data$get$get4.color)||""})})),newSelectedAreaColorChangeItems=this.dataLayer.colorPixels(filteredFinalSelectedAreaPixels,this.dataLayer.getCurrentLayer().getId()).dataForAction,previousSelectedAreaColorChangeItems=previousSelectedAreaPixels;this.recordAction(new SelectAreaMoveAction([].concat((0,toConsumableArray.Z)(newSelectedAreaColorChangeItems),(0,toConsumableArray.Z)(previousSelectedAreaColorChangeItems)),previousSelectedArea,finalSelectedArea,this.dataLayer.getCurrentLayer().getId()));var _step5,effectiveColorChangeItemsMap=new Map,_iterator5=(0,createForOfIteratorHelper.Z)(previousSelectedAreaColorChangeItems);try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){var item=_step5.value;effectiveColorChangeItemsMap.set(generatePixelId(item.rowIndex,item.columnIndex),item)}}catch(err){_iterator5.e(err)}finally{_iterator5.f()}var _step6,_iterator6=(0,createForOfIteratorHelper.Z)(newSelectedAreaColorChangeItems);try{for(_iterator6.s();!(_step6=_iterator6.n()).done;){var _item2=_step6.value;effectiveColorChangeItemsMap.set(generatePixelId(_item2.rowIndex,_item2.columnIndex),_item2)}}catch(err){_iterator6.e(err)}finally{_iterator6.f()}var effectiveColorChangeItems=Array.from(effectiveColorChangeItemsMap.values()),newData=this.dataLayer.getCopiedData();effectiveColorChangeItems.length>0&&(this.emitStrokeEndEvent({strokedPixels:effectiveColorChangeItems,strokeTool:types.G3.SELECT}),this.emitDataChangeEvent({isLocalChange:!0,data:newData,layerId:this.dataLayer.getCurrentLayer().getId(),delta:{modifiedPixels:effectiveColorChangeItems,addedOrDeletedColumns:[],addedOrDeletedRows:[]}}));var movingSelectedArea=this.interactionLayer.getMovingSelectedArea();if(movingSelectedArea){this.interactionLayer.setSelectedArea(movingSelectedArea);var movingSelectedPixels=this.interactionLayer.getMovingSelectedPixels();this.interactionLayer.setSelectedAreaPixels(movingSelectedPixels)}this.interactionLayer.setMovingSelectedArea(null),this.interactionLayer.setMovingSelectedPixels(null),this.gridLayer.render(),this.gridLayer.renderSelection(movingSelectedArea)}}},{key:"onInteractionEnded",value:function onInteractionEnded(evt,shouldUpdateCapturedImage){var _this12=this;evt.preventDefault();var isDataModified=this.relayInteractionDataToDataLayer();(shouldUpdateCapturedImage||this.mouseMode!==config.Om.NULL&&isDataModified)&&(this.dataLayer.render(),this.dataLayer.updateCapturedImageBitmap()),this.mouseMode=config.Om.NULL,this.interactionLayer.setSelectingArea(null),null!==this.gridLayer.getHoveredButton()&&this.emitHoverPixelChangeEvent({indices:null}),this.pinchZoomDiff=void 0,this.gridLayer.setHoveredButton(null),this.renderGridLayer();var selectedArea=this.interactionLayer.getSelectedArea();selectedArea&&this.gridLayer.renderSelection(selectedArea),this.mouseDownWorldPos=null,this.mouseDownPanZoom=null,this.previousMouseMoveWorldPos=null,this.lastRenderAllCall&&cancelAnimationFrame(this.lastRenderAllCall),this.lastRenderAllCall=requestAnimationFrame((function(){_this12.renderAll(),_this12.lastRenderAllCall=null}))}},{key:"onMouseUp",value:function onMouseUp(evt){var shouldUpdateCapturedImage=!1;if(this.brushTool===types.G3.SELECT){this.relaySelectingAreaToSelectedArea(),this.relayMovingSelectedAreaToSelectedArea(),this.relayExtendingSelectedAreaToSelectedArea();var selectedArea=this.interactionLayer.getSelectedArea();selectedArea&&(shouldUpdateCapturedImage=!0),function getDoesAreaOverlapPixelgrid(area,rowCount,columnCount,gridSquareLength){if(!area)return!1;var _getAreaTopLeftAndBot2=getAreaTopLeftAndBottomRight(area),areaTopLeftPos=_getAreaTopLeftAndBot2.areaTopLeftPos,areaBottomRightPos=_getAreaTopLeftAndBot2.areaBottomRightPos,pixelGridLeftTopPoint_x=-columnCount/2*gridSquareLength,pixelGridLeftTopPoint_y=-rowCount/2*gridSquareLength,pixelGridRightBottomPoint_x=columnCount/2*gridSquareLength,pixelGridRightBottomPoint_y=rowCount/2*gridSquareLength;return areaTopLeftPos.x<=pixelGridRightBottomPoint_x||areaTopLeftPos.y<=pixelGridRightBottomPoint_y||areaBottomRightPos.x>=pixelGridLeftTopPoint_x||areaBottomRightPos.y>=pixelGridLeftTopPoint_y}(selectedArea,this.dataLayer.getRowCount(),this.dataLayer.getColumnCount(),this.gridSquareLength)||(this.interactionLayer.setMovingSelectedArea(null),this.interactionLayer.setMovingSelectedPixels(null),this.interactionLayer.setSelectedArea(null),this.interactionLayer.setSelectedAreaPixels(null),this.gridLayer.render())}this.onInteractionEnded(evt,shouldUpdateCapturedImage)}},{key:"onMouseOut",value:function onMouseOut(evt){this.onInteractionEnded(evt,!1)}},{key:"renderGridLayer",value:function renderGridLayer(){this.gridLayer.render()}},{key:"clear",value:function clear(){var clearedPixels=this.dataLayer.clear();this.undoHistory=[],this.redoHistory=[];for(var i=0;i<clearedPixels.length;i++){var _clearedPixels$i=clearedPixels[i],layerId=_clearedPixels$i.layerId,data=_clearedPixels$i.data;this.emitDataChangeEvent({isLocalChange:!0,layerId,data:this.dataLayer.getLayer(layerId).getData(),delta:{addedOrDeletedColumns:[],addedOrDeletedRows:[],modifiedPixels:data}})}this.dataLayer.updateCapturedImageBitmap(),this.renderDataLayer()}},{key:"downloadImage",value:function downloadImage(options){var data=this.dataLayer.getData(),columnCount=this.getColumnCount(),rowCount=this.getRowCount(),allRowKeys=getRowKeysFromData(data),allColumnKeys=getColumnKeysFromData(data),rowKeyOrderMap=createRowKeyOrderMapfromData(data).rowKeyOrderMap,columnKeyOrderMap=createColumnKeyOrderMapfromData(data).columnKeyOrderMap,_getGridIndicesFromDa5=getGridIndicesFromData(data);_getGridIndicesFromDa5.topRowIndex,_getGridIndicesFromDa5.bottomRowIndex,_getGridIndicesFromDa5.leftColumnIndex,_getGridIndicesFromDa5.rightColumnIndex;if("png"===options.type){var imageCanvas=document.createElement("canvas");imageCanvas.width=columnCount*this.gridSquareLength,imageCanvas.height=rowCount*this.gridSquareLength;var _step7,imageContext=imageCanvas.getContext("2d"),_iterator7=(0,createForOfIteratorHelper.Z)(allRowKeys);try{for(_iterator7.s();!(_step7=_iterator7.n()).done;){var _step8,i=_step7.value,_iterator8=(0,createForOfIteratorHelper.Z)(allColumnKeys);try{for(_iterator8.s();!(_step8=_iterator8.n()).done;){var _j2=_step8.value,rowIndex=i,columnIndex=_j2,relativeRowIndex=rowKeyOrderMap.get(rowIndex),relativeColumnIndex=columnKeyOrderMap.get(columnIndex),pixel=data.get(rowIndex).get(columnIndex);if(pixel&&pixel.color){var pixelCoord={x:relativeColumnIndex*this.gridSquareLength,y:relativeRowIndex*this.gridSquareLength};imageContext.save(),imageContext.fillStyle=pixel.color,imageContext.fillRect(pixelCoord.x,pixelCoord.y,this.gridSquareLength,this.gridSquareLength),imageContext.restore()}}}catch(err){_iterator8.e(err)}finally{_iterator8.f()}if(imageContext.save(),imageContext.strokeStyle="#000000",imageContext.lineWidth=1,options&&options.isGridVisible){for(var _i4=0;_i4<=this.getColumnCount();_i4++)imageContext.beginPath(),imageContext.moveTo(_i4*this.gridSquareLength,0),imageContext.lineTo(_i4*this.gridSquareLength,rowCount*this.gridSquareLength),imageContext.stroke(),imageContext.closePath();for(var j=0;j<=this.getRowCount();j++)imageContext.beginPath(),imageContext.moveTo(0,j*this.gridSquareLength),imageContext.lineTo(columnCount*this.gridSquareLength,j*this.gridSquareLength),imageContext.stroke(),imageContext.closePath()}imageContext.restore()}}catch(err){_iterator7.e(err)}finally{_iterator7.f()}var anchor=document.createElement("a");anchor.href=imageCanvas.toDataURL("image/png"),anchor.download="dotting.png",anchor.click()}else{if("svg"!==options.type)throw new UnrecognizedDownloadOptionError;for(var svgDom=document.createElementNS("http://www.w3.org/2000/svg","svg"),validTopRowIndex=rowCount-1,validBottomRowIndex=0,validLeftColumnIndex=columnCount-1,validRightColumnIndex=0,validPixelModifyItems=[],_i5=0;_i5<allRowKeys.length;_i5++)for(var rowKey=allRowKeys[_i5],_j3=0;_j3<allColumnKeys.length;_j3++){var _data$get5,_data$get5$get,columnKey=allColumnKeys[_j3],color=null===(_data$get5=data.get(rowKey))||void 0===_data$get5||null===(_data$get5$get=_data$get5.get(columnKey))||void 0===_data$get5$get?void 0:_data$get5$get.color;color&&(validTopRowIndex=Math.min(validTopRowIndex,rowKey),validBottomRowIndex=Math.max(validBottomRowIndex,rowKey),validLeftColumnIndex=Math.min(validLeftColumnIndex,columnKey),validRightColumnIndex=Math.max(validRightColumnIndex,columnKey),validPixelModifyItems.push({rowIndex:_i5,columnIndex:_j3,color}))}var validTopRowIndexOrder=rowKeyOrderMap.get(validTopRowIndex),validLeftColumnIndexOrder=columnKeyOrderMap.get(validLeftColumnIndex),svgWidth=(validRightColumnIndex-validLeftColumnIndex+1)*this.gridSquareLength,svgHeight=(validBottomRowIndex-validTopRowIndex+1)*this.gridSquareLength;if(svgDom.setAttribute("width","".concat(svgWidth)),svgDom.setAttribute("height","".concat(svgHeight)),0===validPixelModifyItems.length)throw new NoDataToMakeSvgError;for(var _i6=0;_i6<validPixelModifyItems.length;_i6++){var _validPixelModifyItem=validPixelModifyItems[_i6],_rowIndex=_validPixelModifyItem.rowIndex,_columnIndex=_validPixelModifyItem.columnIndex,_color=_validPixelModifyItem.color,svgRect=document.createElementNS("http://www.w3.org/2000/svg","rect"),correctedRowIndex=_rowIndex-validTopRowIndexOrder,correctedColumnIndex=_columnIndex-validLeftColumnIndexOrder;svgRect.setAttribute("y","".concat(correctedRowIndex*this.gridSquareLength)),svgRect.setAttribute("x","".concat(correctedColumnIndex*this.gridSquareLength)),svgRect.setAttribute("width","".concat(this.gridSquareLength)),svgRect.setAttribute("height","".concat(this.gridSquareLength)),svgRect.setAttribute("fill","".concat(_color)),svgDom.appendChild(svgRect)}var svgString=(new XMLSerializer).serializeToString(svgDom),_anchor=document.createElement("a");_anchor.href="data:image/svg+xml;charset=utf-8,".concat(encodeURIComponent(svgString)),_anchor.download="dotting.svg",_anchor.click()}}},{key:"renderAll",value:function renderAll(){var _this13=this,capturedData=this.interactionLayer.getCapturedData();if(capturedData){var rowCount=getRowCountFromData(capturedData),columnCount=getColumnCountFromData(capturedData);this.gridLayer.setRowCount(rowCount),this.gridLayer.setColumnCount(columnCount)}else this.mouseMode!==config.Om.PANNING&&this.mouseMode!==config.Om.PINCHZOOMING&&this.mouseMode!==config.Om.NULL||!this.dataLayer.getCapturedImageBitmap()?this.renderDataLayer():this.dataLayer.renderImageBitmap(),this.renderErasedPixelsFromInteractionLayerInDataLayer();this.renderInteractionLayer(),this.renderGridLayer();var selectedArea=this.interactionLayer.getSelectedArea();selectedArea&&this.gridLayer.renderSelection(selectedArea),clearTimeout(this.renderDataLayerTimeout),this.renderDataLayerTimeout=setTimeout((function(){_this13.renderDataLayer()}),500)}},{key:"renderErasedPixelsFromInteractionLayerInDataLayer",value:function renderErasedPixelsFromInteractionLayerInDataLayer(){var erasedPixelsInInteractionLayer=this.interactionLayer.getAllErasedPixels();if(erasedPixelsInInteractionLayer.length>0){var _step9,ctx=this.dataLayer.getContext(),squareLength=this.gridSquareLength*this.panZoom.scale,correctedLeftTopScreenPoint=getScreenPoint(convertCartesianToScreen(this.element,{x:0,y:0},this.dpr),this.panZoom),_iterator9=(0,createForOfIteratorHelper.Z)(erasedPixelsInInteractionLayer);try{for(_iterator9.s();!(_step9=_iterator9.n()).done;){var _this$dataLayer$getDa,_this$dataLayer$getDa2,pixel=_step9.value,rowIndex=pixel.rowIndex,columnIndex=pixel.columnIndex,relativeRowIndex=this.dataLayer.getRowKeyOrderMap().get(rowIndex),relativeColumnIndex=this.dataLayer.getColumnKeyOrderMap().get(columnIndex);if(void 0!==relativeColumnIndex&&void 0!==relativeRowIndex)(null===(_this$dataLayer$getDa=this.dataLayer.getData().get(rowIndex))||void 0===_this$dataLayer$getDa||null===(_this$dataLayer$getDa2=_this$dataLayer$getDa.get(columnIndex))||void 0===_this$dataLayer$getDa2?void 0:_this$dataLayer$getDa2.color)&&ctx.clearRect(relativeColumnIndex*squareLength+correctedLeftTopScreenPoint.x,relativeRowIndex*squareLength+correctedLeftTopScreenPoint.y,squareLength,squareLength)}}catch(err){_iterator9.e(err)}finally{_iterator9.f()}}}},{key:"renderDataLayer",value:function renderDataLayer(){this.dataLayer.render()}},{key:"renderInteractionLayer",value:function renderInteractionLayer(){this.interactionLayer.render()}},{key:"destroy",value:function destroy(){touchy(this.element,removeEvent,"mouseup",this.onMouseUp),touchy(this.element,removeEvent,"mouseout",this.onMouseOut),touchy(this.element,removeEvent,"mousedown",this.onMouseDown),touchy(this.element,removeEvent,"mousemove",this.onMouseMove),touchy(this.element,removeEvent,"mousemove",this.handlePinchZoom),this.element.removeEventListener("wheel",this.handleWheel)}}]),Editor}(EventDispatcher);const components_Dotting=(0,react.forwardRef)((function Dotting(props,ref){var containerRef=(0,react.useRef)(null),_useState=(0,react.useState)(null),_useState2=(0,slicedToArray.Z)(_useState,2),foregroundCanvas=_useState2[0],setForeGroundCanvas=_useState2[1],_useState3=(0,react.useState)(null),_useState4=(0,slicedToArray.Z)(_useState3,2),gridCanvas=_useState4[0],setGridCanvas=_useState4[1],_useState5=(0,react.useState)(null),_useState6=(0,slicedToArray.Z)(_useState5,2),dataCanvas=_useState6[0],setDataCanvas=_useState6[1],_useState7=(0,react.useState)(null),_useState8=(0,slicedToArray.Z)(_useState7,2),interactionCanvas=_useState8[0],setInteractionCanvas=_useState8[1],_useState9=(0,react.useState)(null),_useState10=(0,slicedToArray.Z)(_useState9,2),backgroundCanvas=_useState10[0],setBackgroundCanvas=_useState10[1],_useState11=(0,react.useState)(null),_useState12=(0,slicedToArray.Z)(_useState11,2),editor=_useState12[0],setEditor=_useState12[1],_useState13=(0,react.useState)([]),_useState14=(0,slicedToArray.Z)(_useState13,2),dataChangeListeners=_useState14[0],setDataChangeListeners=_useState14[1],_useState15=(0,react.useState)([]),_useState16=(0,slicedToArray.Z)(_useState15,2),gridChangeListeners=_useState16[0],setGridChangeListeners=_useState16[1],_useState17=(0,react.useState)([]),_useState18=(0,slicedToArray.Z)(_useState17,2),strokeEndListeners=_useState18[0],setStrokeEndListeners=_useState18[1],_useState19=(0,react.useState)([]),_useState20=(0,slicedToArray.Z)(_useState19,2),brushChangeListeners=_useState20[0],setBrushChangeListeners=_useState20[1],_useState21=(0,react.useState)([]),_useState22=(0,slicedToArray.Z)(_useState21,2),hoverPixelChangeListeners=_useState22[0],setHoverPixelChangeListeners=_useState22[1],_useState23=(0,react.useState)([]),_useState24=(0,slicedToArray.Z)(_useState23,2),layerChangeListeners=_useState24[0],setLayerChangeListeners=_useState24[1],_useState25=(0,react.useState)([]),_useState26=(0,slicedToArray.Z)(_useState25,2),canvasInfoChangeListeners=_useState26[0],setCanvasInfoChangeListeners=_useState26[1],_useState27=(0,react.useState)([]),_useState28=(0,slicedToArray.Z)(_useState27,2),canvasElementEventListeners=_useState28[0],setCanvasElementEventListeners=_useState28[1];(0,react.useEffect)((function(){editor&&editor.setIsGridFixed(props.isGridFixed)}),[editor,props.isGridFixed]),(0,react.useEffect)((function(){editor&&editor.setGridStrokeColor(props.gridStrokeColor)}),[editor,props.gridStrokeColor]),(0,react.useEffect)((function(){editor&&editor.setGridStrokeWidth(props.gridStrokeWidth)}),[editor,props.gridStrokeWidth]),(0,react.useEffect)((function(){editor&&editor.setIsGridVisible(props.isGridVisible)}),[editor,props.isGridVisible]),(0,react.useEffect)((function(){editor&&editor.setIsPanZoomable(props.isPanZoomable)}),[editor,props.isPanZoomable]),(0,react.useEffect)((function(){editor&&editor.setIsInteractionApplicable(props.isInteractionApplicable)}),[editor,props.isInteractionApplicable]),(0,react.useEffect)((function(){editor&&editor.setGridSquareLength(props.gridSquareLength)}),[editor,props.gridSquareLength]),(0,react.useEffect)((function(){editor&&editor.setDefaultPixelColor(props.defaultPixelColor)}),[editor,props.defaultPixelColor]),(0,react.useEffect)((function(){editor&&editor.setMinScale(props.minScale)}),[editor,props.minScale]),(0,react.useEffect)((function(){editor&&editor.setMaxScale(props.maxScale)}),[editor,props.maxScale]),(0,react.useEffect)((function(){if(editor)return gridChangeListeners.forEach((function(listener){editor.addEventListener(types.v8.GRID_CHANGE,listener)})),editor.emitCurrentGridStatus(),function(){gridChangeListeners.forEach((function(listener){null==editor||editor.removeEventListener(types.v8.GRID_CHANGE,listener)}))}}),[editor,gridChangeListeners]),(0,react.useEffect)((function(){if(editor)return dataChangeListeners.forEach((function(listener){editor.addEventListener(types.v8.DATA_CHANGE,listener)})),editor.emitCurrentData(),function(){dataChangeListeners.forEach((function(listener){null==editor||editor.removeEventListener(types.v8.DATA_CHANGE,listener)}))}}),[editor,dataChangeListeners]),(0,react.useEffect)((function(){if(editor)return brushChangeListeners.forEach((function(listener){editor.addEventListener(types.v8.BRUSH_CHANGE,listener)})),editor.emitCurrentBrushTool(),function(){brushChangeListeners.forEach((function(listener){null==editor||editor.removeEventListener(types.v8.BRUSH_CHANGE,listener)}))}}),[editor,brushChangeListeners]),(0,react.useEffect)((function(){if(editor)return strokeEndListeners.forEach((function(listener){editor.addEventListener(types.v8.STROKE_END,listener)})),function(){strokeEndListeners.forEach((function(listener){null==editor||editor.removeEventListener(types.v8.STROKE_END,listener)}))}}),[editor,strokeEndListeners]),(0,react.useEffect)((function(){if(editor)return hoverPixelChangeListeners.forEach((function(listener){editor.addEventListener(types.v8.HOVER_PIXEL_CHANGE,listener)})),editor.emitCurrentHoverPixelStatus(),function(){hoverPixelChangeListeners.forEach((function(listener){null==editor||editor.removeEventListener(types.v8.HOVER_PIXEL_CHANGE,listener)}))}}),[editor,hoverPixelChangeListeners]),(0,react.useEffect)((function(){if(editor)return layerChangeListeners.forEach((function(listener){editor.addEventListener(types.v8.LAYER_CHANGE,listener)})),editor.emitCurrentLayerStatus(),function(){layerChangeListeners.forEach((function(listener){null==editor||editor.removeEventListener(types.v8.LAYER_CHANGE,listener)}))}}),[editor,layerChangeListeners]),(0,react.useEffect)((function(){if(editor)return canvasInfoChangeListeners.forEach((function(listener){editor.addEventListener(types.v8.CANVAS_INFO_CHANGE,listener)})),editor.emitCurrentCanvasInfoStatus(),function(){canvasInfoChangeListeners.forEach((function(listener){null==editor||editor.removeEventListener(types.v8.CANVAS_INFO_CHANGE,listener)}))}}),[editor,canvasInfoChangeListeners]),(0,react.useEffect)((function(){if(editor)return canvasElementEventListeners.forEach((function(_ref){var type=_ref.type,listener=_ref.listener;editor.getCanvasElement().addEventListener(type,listener)})),function(){canvasElementEventListeners.forEach((function(_ref2){var type=_ref2.type,listener=_ref2.listener;editor.getCanvasElement().removeEventListener(type,listener)}))}}),[editor,canvasElementEventListeners]),(0,react.useEffect)((function(){var onResize=function onResize(){if(containerRef.current&&editor){var dpr=window.devicePixelRatio,rect=containerRef.current.getBoundingClientRect();editor.setSize(rect.width,rect.height,dpr),editor.scale(dpr,dpr),editor.renderAll()}};return onResize(),window.addEventListener("resize",onResize),function(){window.removeEventListener("resize",onResize)}}),[editor,containerRef,props.height,props.width,backgroundCanvas,foregroundCanvas]),(0,react.useEffect)((function(){editor&&props.indicatorData&&editor.setIndicatorPixels(props.indicatorData)}),[editor,props.indicatorData]),(0,react.useEffect)((function(){editor&&(props.brushColor&&editor.setBrushColor(props.brushColor),props.brushTool&&editor.setBrushTool(props.brushTool))}),[editor,props.brushColor,props.brushTool]),(0,react.useEffect)((function(){editor&&props.backgroundColor&&editor.setBackgroundColor(props.backgroundColor)}),[editor,props.backgroundColor]),(0,react.useEffect)((function(){editor&&props.resizeUnit&&editor.setResizeUnit(props.resizeUnit)}),[editor,props.resizeUnit]),(0,react.useEffect)((function(){editor&&props.isDrawingEnabled&&editor.setIsDrawingEnabled(props.isDrawingEnabled)}),[editor,props.isDrawingEnabled]),(0,react.useEffect)((function(){editor&&(props.maxColumnCount&&editor.setMaxColumnCount(props.maxColumnCount),props.minColumnCount&&editor.setMinColumnCount(props.minColumnCount),props.maxRowCount&&editor.setMaxRowCount(props.maxRowCount),props.minRowCount&&editor.setMinRowCount(props.minRowCount))}),[editor,props.maxColumnCount,props.minColumnCount,props.maxRowCount,props.minRowCount]),(0,react.useEffect)((function(){if(gridCanvas&&interactionCanvas&&dataCanvas&&backgroundCanvas&&foregroundCanvas&&containerRef.current){var _containerRef$current=containerRef.current.getBoundingClientRect(),width=_containerRef$current.width,height=_containerRef$current.height,validatedLayers=props.initLayers&&validateLayers(props.initLayers)?props.initLayers:void 0,dpr=window.devicePixelRatio,editor=new Editor({gridCanvas,interactionCanvas,dataCanvas,backgroundCanvas,foregroundCanvas,initLayers:validatedLayers,gridSquareLength:props.gridSquareLength,width,height,dpr});return dpr&&editor.scale(dpr,dpr),editor.setIsGridFixed(props.isGridFixed),editor.setIsInteractionApplicable(props.isInteractionApplicable),editor.setIsDrawingEnabled(props.isDrawingEnabled),editor.setIsPanZoomable(props.isPanZoomable),editor.setIsGridVisible(props.isGridVisible),editor.setGridStrokeColor(props.gridStrokeColor),editor.setGridStrokeWidth(props.gridStrokeWidth),editor.setGridSquareLength(props.gridSquareLength),editor.setDefaultPixelColor(props.defaultPixelColor),editor.setMinScale(props.minScale),editor.setMaxScale(props.maxScale),setEditor(editor),function(){editor.destroy()}}}),[gridCanvas,interactionCanvas,dataCanvas,backgroundCanvas]);var gotGridCanvasRef=(0,react.useCallback)((function(element){element&&(element.style.touchAction="none",setGridCanvas(element))}),[]),gotInteractionCanvasRef=(0,react.useCallback)((function(element){element&&(element.style.touchAction="none",setInteractionCanvas(element))}),[]),gotDataCanvasRef=(0,react.useCallback)((function(element){element&&(element.style.touchAction="none",setDataCanvas(element))}),[]),gotBackgroundCanvasRef=(0,react.useCallback)((function(element){element&&(element.style.touchAction="none",setBackgroundCanvas(element))}),[]),gotForeGroundCanvasRef=(0,react.useCallback)((function(element){element&&(element.style.touchAction="none",setForeGroundCanvas(element))}),[]),addDataChangeListener=(0,react.useCallback)((function(listener){setDataChangeListeners((function(listeners){return[].concat((0,toConsumableArray.Z)(listeners),[listener])}))}),[]),removeDataChangeListener=(0,react.useCallback)((function(listener){editor.removeEventListener(types.v8.DATA_CHANGE,listener),setDataChangeListeners((function(listeners){return listeners.filter((function(l){return l!==listener}))}))}),[editor]),addGridChangeListener=(0,react.useCallback)((function(listener){setGridChangeListeners((function(listeners){return[].concat((0,toConsumableArray.Z)(listeners),[listener])}))}),[]),removeGridChangeListener=(0,react.useCallback)((function(listener){editor.removeEventListener(types.v8.GRID_CHANGE,listener),setGridChangeListeners((function(listeners){return listeners.filter((function(l){return l!==listener}))}))}),[editor]),addBrushChangeListener=(0,react.useCallback)((function(listener){setBrushChangeListeners((function(listeners){return[].concat((0,toConsumableArray.Z)(listeners),[listener])}))}),[]),removeBrushChangeListener=(0,react.useCallback)((function(listener){editor.removeEventListener(types.v8.BRUSH_CHANGE,listener),setBrushChangeListeners((function(listeners){return listeners.filter((function(l){return l!==listener}))}))}),[editor]),addStrokeEndListener=(0,react.useCallback)((function(listener){setStrokeEndListeners((function(listeners){return[].concat((0,toConsumableArray.Z)(listeners),[listener])}))}),[]),removeStrokeEndListener=(0,react.useCallback)((function(listener){editor.removeEventListener(types.v8.STROKE_END,listener),setStrokeEndListeners((function(listeners){return listeners.filter((function(l){return l!==listener}))}))}),[editor]),addHoverPixelChangeListener=(0,react.useCallback)((function(listener){setHoverPixelChangeListeners((function(listeners){return[].concat((0,toConsumableArray.Z)(listeners),[listener])}))}),[]),removeHoverPixelChangeListener=(0,react.useCallback)((function(listener){editor.removeEventListener(types.v8.HOVER_PIXEL_CHANGE,listener),setHoverPixelChangeListeners((function(listeners){return listeners.filter((function(l){return l!==listener}))}))}),[editor]),addCanvasInfoChangeEventListener=(0,react.useCallback)((function(listener){setCanvasInfoChangeListeners((function(listeners){return[].concat((0,toConsumableArray.Z)(listeners),[listener])}))}),[]),removeCanvasInfoChangeEventListener=(0,react.useCallback)((function(listener){editor.removeEventListener(types.v8.CANVAS_INFO_CHANGE,listener),setCanvasInfoChangeListeners((function(listeners){return listeners.filter((function(l){return l!==listener}))}))}),[editor]),addCanvasElementEventListener=(0,react.useCallback)((function(type,listener){setCanvasElementEventListeners((function(listeners){return[].concat((0,toConsumableArray.Z)(listeners),[{type,listener}])}))}),[editor]),removeCanvasElementEventListener=(0,react.useCallback)((function(type,listener){editor&&(editor.getCanvasElement().removeEventListener(type,listener),setCanvasElementEventListeners((function(listeners){return listeners.filter((function(l){return l.type!==type&&l.listener!==listener}))})))}),[editor]),addLayerChangeEventListener=(0,react.useCallback)((function(listener){setLayerChangeListeners((function(listeners){return[].concat((0,toConsumableArray.Z)(listeners),[listener])}))}),[]),removeLayerChangeEventListener=(0,react.useCallback)((function(listener){editor&&(editor.removeEventListener(types.v8.LAYER_CHANGE,listener),setLayerChangeListeners((function(listeners){return listeners.filter((function(l){return l!==listener}))})))}),[editor]),clear=(0,react.useCallback)((function(){return null==editor?void 0:editor.clear()}),[editor]),colorPixels=(0,react.useCallback)((function(changes){null==editor||editor.colorPixels(changes)}),[editor]),erasePixels=(0,react.useCallback)((function(changes){null==editor||editor.erasePixels(changes)}),[editor]),setIndicatorPixels=(0,react.useCallback)((function(indicators){null==editor||editor.setIndicatorPixels(indicators)}),[editor]),downloadImage=(0,react.useCallback)((function(options){null==editor||editor.downloadImage(options)}),[editor]),changeBrushColor=(0,react.useCallback)((function(color){null==editor||editor.changeBrushColor(color)}),[editor]),changeBrushPattern=(0,react.useCallback)((function(pattern){null==editor||editor.setBrushPattern(pattern)}),[editor]),changeBrushTool=(0,react.useCallback)((function(brushTool){null==editor||editor.setBrushTool(brushTool)}),[editor]),undo=(0,react.useCallback)((function(){null==editor||editor.undo()}),[editor]),redo=(0,react.useCallback)((function(){null==editor||editor.redo()}),[editor]),setData=(0,react.useCallback)((function(data){null==editor||editor.setData(data)}),[editor]),addLayer=(0,react.useCallback)((function(layerId,insertPosition,data){null==editor||editor.addLayer(layerId,insertPosition,data,!0)}),[editor]),removeLayer=(0,react.useCallback)((function(layerId){null==editor||editor.removeLayer(layerId,!0)}),[editor]),changeLayerPosition=(0,react.useCallback)((function(layerId,insertPosition){null==editor||editor.changeLayerPosition(layerId,insertPosition)}),[editor]),showLayer=(0,react.useCallback)((function(layerId){null==editor||editor.showLayer(layerId)}),[editor]),hideLayer=(0,react.useCallback)((function(layerId){null==editor||editor.hideLayer(layerId)}),[editor]),isolateLayer=(0,react.useCallback)((function(layerId){null==editor||editor.isolateLayer(layerId)}),[editor]),showAllLayers=(0,react.useCallback)((function(){null==editor||editor.showAllLayers()}),[editor]),setCurrentLayer=(0,react.useCallback)((function(layerId){null==editor||editor.setCurrentLayer(layerId)}),[editor]),reorderLayersByIds=(0,react.useCallback)((function(layerIds){null==editor||editor.reorderLayersByIds(layerIds)}),[editor]),addGridIndices=(0,react.useCallback)((function(_ref3){var rowIndices=_ref3.rowIndices,columnIndices=_ref3.columnIndices,data=_ref3.data,layerId=_ref3.layerId,_ref3$isLocalChange=_ref3.isLocalChange,isLocalChange=void 0!==_ref3$isLocalChange&&_ref3$isLocalChange;null==editor||editor.addGridIndices({rowIndices,columnIndices,data,layerId,isLocalChange})}),[editor]),deleteGridIndices=(0,react.useCallback)((function(_ref4){var rowIndices=_ref4.rowIndices,columnIndices=_ref4.columnIndices,layerId=_ref4.layerId,_ref4$isLocalChange=_ref4.isLocalChange,isLocalChange=void 0!==_ref4$isLocalChange&&_ref4$isLocalChange;null==editor||editor.deleteGridIndices({rowIndices,columnIndices,layerId,isLocalChange})}),[editor]),getLayers=(0,react.useCallback)((function(){return null==editor?void 0:editor.getLayers()}),[editor]),getLayersAsArray=(0,react.useCallback)((function(){return null==editor?void 0:editor.getLayersAsArray()}),[editor]),setLayers=(0,react.useCallback)((function(layers){null==editor||editor.setLayers(layers)}),[editor]),onMouseDown=(0,react.useCallback)((function(e){var fakeMouseEvent=new MouseEvent("mousedown",{clientX:e.offsetX,clientY:e.offsetY});null==editor||editor.onMouseDown(fakeMouseEvent)}),[editor]),onMouseMove=(0,react.useCallback)((function(e){var fakeMouseEvent=new MouseEvent("mousemove",{clientX:e.offsetX,clientY:e.offsetY});null==editor||editor.onMouseMove(fakeMouseEvent)}),[editor]),onMouseUp=(0,react.useCallback)((function(e){var fakeMouseEvent=new MouseEvent("mouseup",{clientX:e.offsetX,clientY:e.offsetY});null==editor||editor.onMouseUp(fakeMouseEvent)}),[editor]),getForegroundCanvas=(0,react.useCallback)((function(){return foregroundCanvas}),[foregroundCanvas]),getBackgroundCanvas=(0,react.useCallback)((function(){return backgroundCanvas}),[backgroundCanvas]),convertWorldPosToCanvasOffset=(0,react.useCallback)((function(x,y){return null==editor?void 0:editor.convertWorldPosToCanvasOffset({x,y})}),[editor]);return(0,react.useImperativeHandle)(ref,(function(){return{clear,colorPixels,erasePixels,downloadImage,setIndicatorPixels,undo,redo,setData,addGridIndices,deleteGridIndices,changeBrushColor,changeBrushTool,changeBrushPattern,addLayer,removeLayer,changeLayerPosition,showLayer,hideLayer,isolateLayer,showAllLayers,setCurrentLayer,reorderLayersByIds,addDataChangeListener,removeDataChangeListener,addGridChangeListener,removeGridChangeListener,addBrushChangeListener,removeBrushChangeListener,addStrokeEndListener,removeStrokeEndListener,addHoverPixelChangeListener,removeHoverPixelChangeListener,addLayerChangeEventListener,removeLayerChangeEventListener,addCanvasInfoChangeEventListener,removeCanvasInfoChangeEventListener,addCanvasElementEventListener,removeCanvasElementEventListener,getLayers,getLayersAsArray,setLayers,onMouseDown,onMouseMove,onMouseUp,getForegroundCanvas,getBackgroundCanvas,convertWorldPosToCanvasOffset}}),[clear,colorPixels,erasePixels,downloadImage,setIndicatorPixels,undo,redo,setData,addGridIndices,deleteGridIndices,changeBrushColor,changeBrushTool,changeBrushPattern,addLayer,removeLayer,changeLayerPosition,showLayer,hideLayer,isolateLayer,showAllLayers,reorderLayersByIds,addDataChangeListener,removeDataChangeListener,addGridChangeListener,removeGridChangeListener,addBrushChangeListener,removeBrushChangeListener,addStrokeEndListener,removeStrokeEndListener,addHoverPixelChangeListener,removeHoverPixelChangeListener,addLayerChangeEventListener,removeLayerChangeEventListener,addCanvasInfoChangeEventListener,removeCanvasInfoChangeEventListener,addCanvasElementEventListener,removeCanvasElementEventListener,getLayers,getLayersAsArray,setLayers,onMouseDown,onMouseMove,onMouseUp,getForegroundCanvas,getBackgroundCanvas,convertWorldPosToCanvasOffset]),react.createElement("div",{style:{width:props.width,height:props.height,position:"relative",outline:"none"},ref:containerRef,tabIndex:1,onMouseDown:function onMouseDown(){var _containerRef$current2;null===(_containerRef$current2=containerRef.current)||void 0===_containerRef$current2||_containerRef$current2.focus()},onKeyDown:function onKeyDown(e){null==editor||editor.onKeyDown(e)},onKeyUp:function onKeyUp(e){null==editor||editor.onKeyUp(e)}},react.createElement("canvas",{id:"dotting-background-canvas",ref:gotBackgroundCanvasRef,style:(0,objectSpread2.Z)({position:"absolute",border:"1px solid #555555",pointerEvents:"none",backgroundColor:props.backgroundColor?props.backgroundColor:config.XM},props.style)}),react.createElement("canvas",{id:"dotting-data-canvas",ref:gotDataCanvasRef,style:(0,objectSpread2.Z)({position:"absolute",pointerEvents:"none",border:"1px solid #555555"},props.style)}),react.createElement("canvas",{id:"dotting-interaction-canvas",ref:gotInteractionCanvasRef,style:(0,objectSpread2.Z)({position:"absolute",border:"1px solid #555555"},props.style)}),react.createElement("canvas",{id:"dotting-grid-canvas",ref:gotGridCanvasRef,style:(0,objectSpread2.Z)({position:"absolute",pointerEvents:"none",border:"1px solid #555555"},props.style)}),react.createElement("canvas",{ref:gotForeGroundCanvasRef,id:"dotting-foreground-canvas",style:(0,objectSpread2.Z)({position:"absolute",pointerEvents:"none",border:"1px solid #555555"},props.style)}))}))},"./src/hooks/useBrush.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var _home_runner_work_dotting_dotting_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_useHandlers__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/hooks/useHandlers.ts"),_components_Canvas_types__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/components/Canvas/types.ts");const __WEBPACK_DEFAULT_EXPORT__=function useBrush(ref){var _useState=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(_components_Canvas_types__WEBPACK_IMPORTED_MODULE_2__.G3.DOT),_useState2=(0,_home_runner_work_dotting_dotting_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_3__.Z)(_useState,2),brushTool=_useState2[0],setBrushTool=_useState2[1],_useState3=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(""),_useState4=(0,_home_runner_work_dotting_dotting_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_3__.Z)(_useState3,2),brushColor=_useState4[0],setBrushColor=_useState4[1],_useState5=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)([[_components_Canvas_types__WEBPACK_IMPORTED_MODULE_2__.a3.FILL]]),_useState6=(0,_home_runner_work_dotting_dotting_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_3__.Z)(_useState5,2),brushPattern=_useState6[0],setBrushPattern=_useState6[1],_useHandlers=(0,_useHandlers__WEBPACK_IMPORTED_MODULE_1__.Z)(ref),addBrushChangeListener=_useHandlers.addBrushChangeListener,removeBrushChangeListener=_useHandlers.removeBrushChangeListener;(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((function(){var listener=function listener(_ref){var brushColor=_ref.brushColor,brushTool=_ref.brushTool,brushPattern=_ref.brushPattern;setBrushTool(brushTool),setBrushColor(brushColor),setBrushPattern(brushPattern)};return addBrushChangeListener(listener),function(){removeBrushChangeListener(listener)}}),[addBrushChangeListener,removeBrushChangeListener]);var changeBrushColor=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(brushColor){var _ref$current;null===(_ref$current=ref.current)||void 0===_ref$current||_ref$current.changeBrushColor(brushColor)}),[ref]),changeBrushPattern=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(brushPattern){var _ref$current2;null===(_ref$current2=ref.current)||void 0===_ref$current2||_ref$current2.changeBrushPattern(brushPattern)}),[ref]);return{changeBrushColor,changeBrushTool:(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(brushMode){var _ref$current3;null===(_ref$current3=ref.current)||void 0===_ref$current3||_ref$current3.changeBrushTool(brushMode)}),[ref]),changeBrushPattern,brushTool,brushColor,brushPattern}}},"./src/hooks/useData.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});__webpack_require__("./node_modules/core-js/modules/es.map.js"),__webpack_require__("./node_modules/core-js/modules/es.object.to-string.js"),__webpack_require__("./node_modules/core-js/modules/es.string.iterator.js"),__webpack_require__("./node_modules/core-js/modules/es.array.iterator.js"),__webpack_require__("./node_modules/core-js/modules/web.dom-collections.iterator.js"),__webpack_require__("./node_modules/core-js/modules/es.array.from.js");var _home_runner_work_dotting_dotting_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),react__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/react/index.js"),_useHandlers__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./src/hooks/useHandlers.ts");const __WEBPACK_DEFAULT_EXPORT__=function useData(ref){var _useHandlers=(0,_useHandlers__WEBPACK_IMPORTED_MODULE_7__.Z)(ref),addDataChangeListener=_useHandlers.addDataChangeListener,removeDataChangeListener=_useHandlers.removeDataChangeListener,_useState=(0,react__WEBPACK_IMPORTED_MODULE_6__.useState)(new Map),_useState2=(0,_home_runner_work_dotting_dotting_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_8__.Z)(_useState,2),data=_useState2[0],setData=_useState2[1],_useState3=(0,react__WEBPACK_IMPORTED_MODULE_6__.useState)([]),_useState4=(0,_home_runner_work_dotting_dotting_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_8__.Z)(_useState3,2),dataArray=_useState4[0],setDataArray=_useState4[1];return(0,react__WEBPACK_IMPORTED_MODULE_6__.useEffect)((function(){var listener=function listener(_ref){var canvasData=_ref.data;setData(canvasData);for(var allRowKeys=Array.from(canvasData.keys()),allColumnKeys=Array.from(canvasData.get(allRowKeys[0]).keys()),currentTopIndex=Math.min.apply(Math,allRowKeys),currentLeftIndex=Math.min.apply(Math,allColumnKeys),currentBottomIndex=Math.max.apply(Math,allRowKeys),currentRightIndex=Math.max.apply(Math,allColumnKeys),tempArray=[],i=currentTopIndex;i<=currentBottomIndex;i++){for(var row=[],j=currentLeftIndex;j<=currentRightIndex;j++){var _canvasData$get,pixel=null===(_canvasData$get=canvasData.get(i))||void 0===_canvasData$get?void 0:_canvasData$get.get(j);pixel&&row.push({rowIndex:i,columnIndex:j,color:pixel.color})}tempArray.push(row)}setDataArray(tempArray)};return addDataChangeListener(listener),function(){removeDataChangeListener(listener)}}),[addDataChangeListener,removeDataChangeListener]),{data,dataArray}}},"./src/hooks/useDotting.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js");const __WEBPACK_DEFAULT_EXPORT__=function useDotting(ref){return{clear:(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(){var _ref$current;null===(_ref$current=ref.current)||void 0===_ref$current||_ref$current.clear()}),[ref]),colorPixels:(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(changes){var _ref$current2;null===(_ref$current2=ref.current)||void 0===_ref$current2||_ref$current2.colorPixels(changes)}),[ref]),erasePixels:(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(changes){var _ref$current3;null===(_ref$current3=ref.current)||void 0===_ref$current3||_ref$current3.erasePixels(changes)}),[ref]),downloadImage:(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(options){var _ref$current4;null===(_ref$current4=ref.current)||void 0===_ref$current4||_ref$current4.downloadImage(options)}),[ref]),setIndicatorPixels:(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(indicators){var _ref$current5;null===(_ref$current5=ref.current)||void 0===_ref$current5||_ref$current5.setIndicatorPixels(indicators)}),[ref]),undo:(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(){var _ref$current6;null===(_ref$current6=ref.current)||void 0===_ref$current6||_ref$current6.undo()}),[ref]),redo:(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(){var _ref$current7;null===(_ref$current7=ref.current)||void 0===_ref$current7||_ref$current7.redo()}),[ref]),setData:(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(data){var _ref$current8;null===(_ref$current8=ref.current)||void 0===_ref$current8||_ref$current8.setData(data)}),[ref]),setLayers:(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(layers){var _ref$current9;null===(_ref$current9=ref.current)||void 0===_ref$current9||_ref$current9.setLayers(layers)}),[ref]),addGridIndices:(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(params){var _ref$current10;null===(_ref$current10=ref.current)||void 0===_ref$current10||_ref$current10.addGridIndices(params)}),[ref]),deleteGridIndices:(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(params){var _ref$current11;null===(_ref$current11=ref.current)||void 0===_ref$current11||_ref$current11.deleteGridIndices(params)}),[ref]),getForegroundCanvas:(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(){var _ref$current12;return null===(_ref$current12=ref.current)||void 0===_ref$current12?void 0:_ref$current12.getForegroundCanvas()}),[ref]),getBackgroundCanvas:(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(){var _ref$current13;return null===(_ref$current13=ref.current)||void 0===_ref$current13?void 0:_ref$current13.getBackgroundCanvas()}),[ref]),convertWorldPosToCanvasOffset:(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(x,y){var _ref$current14;return null===(_ref$current14=ref.current)||void 0===_ref$current14?void 0:_ref$current14.convertWorldPosToCanvasOffset(x,y)}),[ref])}}},"./src/hooks/useGrids.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var _home_runner_work_dotting_dotting_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_useHandlers__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/hooks/useHandlers.ts");const __WEBPACK_DEFAULT_EXPORT__=function useGrids(ref){var _useHandlers=(0,_useHandlers__WEBPACK_IMPORTED_MODULE_1__.Z)(ref),addGridChangeListener=_useHandlers.addGridChangeListener,removeGridChangeListener=_useHandlers.removeGridChangeListener,_useState=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)({columnCount:0,rowCount:0}),_useState2=(0,_home_runner_work_dotting_dotting_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_2__.Z)(_useState,2),dimensions=_useState2[0],setDimensions=_useState2[1],_useState3=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)({topRowIndex:0,bottomRowIndex:0,leftColumnIndex:0,rightColumnIndex:0}),_useState4=(0,_home_runner_work_dotting_dotting_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_2__.Z)(_useState3,2),indices=_useState4[0],setIndices=_useState4[1];return(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((function(){var listener=function listener(_ref){var dimensions=_ref.dimensions,indices=_ref.indices;setDimensions({columnCount:dimensions.columnCount,rowCount:dimensions.rowCount}),setIndices({topRowIndex:indices.topRowIndex,bottomRowIndex:indices.bottomRowIndex,leftColumnIndex:indices.leftColumnIndex,rightColumnIndex:indices.rightColumnIndex})};return addGridChangeListener(listener),function(){removeGridChangeListener(listener)}}),[addGridChangeListener,removeGridChangeListener]),{dimensions,indices}}},"./src/hooks/useHandlers.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js");const __WEBPACK_DEFAULT_EXPORT__=function useHandlers(ref){return{addDataChangeListener:(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(listener){var _ref$current;null===(_ref$current=ref.current)||void 0===_ref$current||_ref$current.addDataChangeListener(listener)}),[ref]),removeDataChangeListener:(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(listener){var _ref$current2;null===(_ref$current2=ref.current)||void 0===_ref$current2||_ref$current2.removeDataChangeListener(listener)}),[ref]),addGridChangeListener:(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(listener){var _ref$current3;null===(_ref$current3=ref.current)||void 0===_ref$current3||_ref$current3.addGridChangeListener(listener)}),[ref]),removeGridChangeListener:(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(listener){var _ref$current4;null===(_ref$current4=ref.current)||void 0===_ref$current4||_ref$current4.removeGridChangeListener(listener)}),[ref]),addBrushChangeListener:(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(listener){var _ref$current5;null===(_ref$current5=ref.current)||void 0===_ref$current5||_ref$current5.addBrushChangeListener(listener)}),[ref]),removeBrushChangeListener:(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(listener){var _ref$current6;null===(_ref$current6=ref.current)||void 0===_ref$current6||_ref$current6.removeBrushChangeListener(listener)}),[ref]),addStrokeEndListener:(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(listener){var _ref$current7;null===(_ref$current7=ref.current)||void 0===_ref$current7||_ref$current7.addStrokeEndListener(listener)}),[ref]),removeStrokeEndListener:(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(listener){var _ref$current8;null===(_ref$current8=ref.current)||void 0===_ref$current8||_ref$current8.removeStrokeEndListener(listener)}),[ref]),addHoverPixelChangeListener:(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(listener){var _ref$current9;null===(_ref$current9=ref.current)||void 0===_ref$current9||_ref$current9.addHoverPixelChangeListener(listener)}),[ref]),removeHoverPixelChangeListener:(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(listener){var _ref$current10;null===(_ref$current10=ref.current)||void 0===_ref$current10||_ref$current10.removeHoverPixelChangeListener(listener)}),[ref]),addLayerChangeEventListener:(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(listener){var _ref$current11;null===(_ref$current11=ref.current)||void 0===_ref$current11||_ref$current11.addLayerChangeEventListener(listener)}),[ref]),removeLayerChangeEventListener:(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(listener){var _ref$current12;null===(_ref$current12=ref.current)||void 0===_ref$current12||_ref$current12.removeLayerChangeEventListener(listener)}),[ref]),addCanvasInfoChangeEventListener:(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(listener){var _ref$current13;null===(_ref$current13=ref.current)||void 0===_ref$current13||_ref$current13.addCanvasInfoChangeEventListener(listener)}),[ref]),removeCanvasInfoChangeEventListener:(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(listener){var _ref$current14;null===(_ref$current14=ref.current)||void 0===_ref$current14||_ref$current14.removeCanvasInfoChangeEventListener(listener)}),[ref]),addCanvasElementEventListener:(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(event,listener){var _ref$current15;null===(_ref$current15=ref.current)||void 0===_ref$current15||_ref$current15.addCanvasElementEventListener(event,listener)}),[ref]),removeCanvasElementEventListener:(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(event,listener){var _ref$current16;null===(_ref$current16=ref.current)||void 0===_ref$current16||_ref$current16.removeCanvasElementEventListener(event,listener)}),[ref])}}},"./src/hooks/useLayers.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});__webpack_require__("./node_modules/core-js/modules/es.array.map.js");var _home_runner_work_dotting_dotting_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/index.js"),_useHandlers__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/hooks/useHandlers.ts");const __WEBPACK_DEFAULT_EXPORT__=function useLayers(ref){var _useState=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(),_useState2=(0,_home_runner_work_dotting_dotting_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_3__.Z)(_useState,2),currentLayer=_useState2[0],setCurrentLayerHook=_useState2[1],_useState3=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)([]),_useState4=(0,_home_runner_work_dotting_dotting_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_3__.Z)(_useState3,2),layersInfo=_useState4[0],setLayersInfo=_useState4[1],_useHandlers=(0,_useHandlers__WEBPACK_IMPORTED_MODULE_2__.Z)(ref),addLayerChangeEventListener=_useHandlers.addLayerChangeEventListener,removeLayerChangeEventListener=_useHandlers.removeLayerChangeEventListener;return(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)((function(){var listener=function listener(_ref){var currentLayer=_ref.currentLayer,layers=_ref.layers;setCurrentLayerHook({id:currentLayer.getId(),data:currentLayer.getDataArray(),isVisible:currentLayer.getIsVisible()}),setLayersInfo(layers.map((function(layer){return{id:layer.getId(),data:layer.getDataArray(),isVisible:layer.getIsVisible()}})))};return addLayerChangeEventListener(listener),function(){removeLayerChangeEventListener(listener)}}),[addLayerChangeEventListener,removeLayerChangeEventListener]),{currentLayer,layers:layersInfo,addLayer:(0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)((function(layerId,insertPosition,data){var _ref$current;null===(_ref$current=ref.current)||void 0===_ref$current||_ref$current.addLayer(layerId,insertPosition,data)}),[ref]),removeLayer:(0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)((function(layerId){var _ref$current2;null===(_ref$current2=ref.current)||void 0===_ref$current2||_ref$current2.removeLayer(layerId)}),[ref]),changeLayerPosition:(0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)((function(layerId,toIndex){var _ref$current3;null===(_ref$current3=ref.current)||void 0===_ref$current3||_ref$current3.changeLayerPosition(layerId,toIndex)}),[ref]),showLayer:(0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)((function(layerId){var _ref$current4;null===(_ref$current4=ref.current)||void 0===_ref$current4||_ref$current4.showLayer(layerId)}),[ref]),hideLayer:(0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)((function(layerId){var _ref$current5;null===(_ref$current5=ref.current)||void 0===_ref$current5||_ref$current5.hideLayer(layerId)}),[ref]),isolateLayer:(0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)((function(layerId){var _ref$current6;null===(_ref$current6=ref.current)||void 0===_ref$current6||_ref$current6.isolateLayer(layerId)}),[ref]),showAllLayers:(0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)((function(){var _ref$current7;null===(_ref$current7=ref.current)||void 0===_ref$current7||_ref$current7.showAllLayers()}),[ref]),setCurrentLayer:(0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)((function(layerId){var _ref$current8;null===(_ref$current8=ref.current)||void 0===_ref$current8||_ref$current8.setCurrentLayer(layerId)}),[ref]),reorderLayersByIds:(0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)((function(layerIds){var _ref$current9;null===(_ref$current9=ref.current)||void 0===_ref$current9||_ref$current9.reorderLayersByIds(layerIds)}),[ref])}}},"./src/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{G3:()=>types.G3,DX:()=>useBrush.Z,NU:()=>useDotting.Z,eJ:()=>useHandlers.Z});__webpack_require__("./src/components/Dotting.tsx");var types=__webpack_require__("./src/components/Canvas/types.ts"),useBrush=__webpack_require__("./src/hooks/useBrush.ts"),useDotting=(__webpack_require__("./src/hooks/useData.ts"),__webpack_require__("./src/hooks/useDotting.ts")),useHandlers=(__webpack_require__("./src/hooks/useGrids.ts"),__webpack_require__("./src/hooks/useHandlers.ts"));__webpack_require__("./src/hooks/useLayers.ts")},"./stories/useBrushComponents/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{tq:()=>useBrushComponents_ChangeBrushColor,lz:()=>useBrushComponents_ChangeBrushPattern,jg:()=>useBrushComponents_ChangeBrushTool});__webpack_require__("./node_modules/core-js/modules/es.array.map.js"),__webpack_require__("./node_modules/core-js/modules/es.function.bind.js");var react=__webpack_require__("./node_modules/react/index.js"),Dotting=__webpack_require__("./src/components/Dotting.tsx"),useBrush=__webpack_require__("./src/hooks/useBrush.ts");const useBrushComponents_ChangeBrushColor=function ChangeBrushColor(){var ref=(0,react.useRef)(null),_useBrush=(0,useBrush.Z)(ref),changeBrushColor=_useBrush.changeBrushColor,brushColor=_useBrush.brushColor;return react.createElement("div",{style:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center",fontFamily:"'Nunito Sans', 'Helvetica Neue', Helvetica, Arial, sans-serif",marginBottom:50}},react.createElement(Dotting.Z,{ref,width:"100%",height:300}),react.createElement("div",{style:{display:"flex",alignItems:"center",marginTop:10,marginBottom:3}},react.createElement("span",{style:{fontSize:13}},"Brush Color"),react.createElement("div",{style:{borderRadius:"50%",width:20,height:20,marginLeft:15,backgroundColor:brushColor}})),react.createElement("div",null,["#FF0000","#0000FF","#00FF00","#FF00FF","#00FFFF","#FFFF00","#000000","#FFFFFF"].map((function(color){return react.createElement("div",{key:color,onClick:changeBrushColor.bind(null,color),style:{width:25,height:25,margin:10,border:"1px solid black",backgroundColor:color,display:"inline-block"}})}))))};var slicedToArray=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/slicedToArray.js");const useBrushComponents_ChangeBrushPattern=function ChangeBrushPattern(){var ref=(0,react.useRef)(null),_useBrush=(0,useBrush.Z)(ref),changeBrushColor=_useBrush.changeBrushColor,changeBrushPattern=_useBrush.changeBrushPattern,brushColor=_useBrush.brushColor,handleColorChange=(0,react.useCallback)((function(e){changeBrushColor.bind(null,e.target.value)()}),[]),_useState=(0,react.useState)(0),_useState2=(0,slicedToArray.Z)(_useState,2),selectedPatternIndex=_useState2[0],setSelectedPatternIndex=_useState2[1],patterns=(0,react.useMemo)((function(){return[[[1]],[[0,1,0],[1,1,1],[0,1,0]],[[1,1,1],[1,1,1],[1,1,1]],[[0,0,1,0,0],[0,1,1,1,0],[1,1,1,1,1],[0,1,1,1,0],[0,0,1,0,0]],[[0,1,1,1,0],[1,1,1,1,1],[1,1,1,1,1],[1,1,1,1,1],[0,1,1,1,0]],[[1,1,1,1,1],[1,1,1,1,1],[1,1,1,1,1],[1,1,1,1,1],[1,1,1,1,1]]]}),[]);return react.createElement("div",{style:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center",fontFamily:"'Nunito Sans', 'Helvetica Neue', Helvetica, Arial, sans-serif"}},react.createElement(Dotting.Z,{ref,width:"100%",height:300}),react.createElement("div",{style:{display:"flex",alignItems:"center",marginTop:10,marginBottom:3,fontSize:13}},react.createElement("span",null,"Brush Mode"),react.createElement("div",{style:{display:"flex",alignItems:"center",marginTop:10}},patterns.map((function(pattern,index){return react.createElement("div",{key:index,style:{display:"flex",backgroundColor:selectedPatternIndex===index?"grey":"",marginLeft:5,marginRight:5,width:80,height:80,alignItems:"center",justifyContent:"center"},onClick:function onClick(){setSelectedPatternIndex(index),changeBrushPattern(pattern)}},pattern.map((function(row,key){return react.createElement("div",{key,style:{display:"flex",flexDirection:"column"}},row.map((function(cell,idx){return react.createElement("div",{key:idx,style:{width:10,height:10,backgroundColor:1===cell?"black":"",margin:1}})})))})))})))),react.createElement("div",{style:{display:"flex",alignItems:"center",marginTop:10,marginBottom:3}},react.createElement("span",{style:{fontSize:13}},"Brush Color"),react.createElement("div",{style:{borderRadius:"50%",width:20,height:20,marginLeft:15,marginRight:15,backgroundColor:brushColor}}),react.createElement("input",{type:"color",value:brushColor,onChange:handleColorChange})),react.createElement("div",null))};var src=__webpack_require__("./src/index.ts"),types=__webpack_require__("./src/components/Canvas/types.ts");const useBrushComponents_ChangeBrushTool=function ChangeBrushTool(){var ref=(0,react.useRef)(null),_useBrush=(0,useBrush.Z)(ref),changeBrushColor=_useBrush.changeBrushColor,changeBrushTool=_useBrush.changeBrushTool,brushTool=_useBrush.brushTool,brushColor=_useBrush.brushColor,_useDotting=(0,src.NU)(ref),handleColorChange=(_useDotting.undo,_useDotting.redo,(0,react.useCallback)((function(e){changeBrushColor.bind(null,e.target.value)()}),[]));return react.createElement("div",{style:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center",fontFamily:"'Nunito Sans', 'Helvetica Neue', Helvetica, Arial, sans-serif",position:"relative",marginBottom:50}},react.createElement(Dotting.Z,{ref,width:"100%",height:300}),react.createElement("div",{style:{display:"flex",alignItems:"center",marginTop:10,marginBottom:3,fontSize:13}},react.createElement("span",null,"Brush Mode"),react.createElement("select",{style:{marginLeft:15},value:brushTool,onChange:function onChange(e){changeBrushTool(e.target.value)}},react.createElement("option",{value:types.G3.DOT},types.G3.DOT),react.createElement("option",{value:types.G3.ERASER},types.G3.ERASER),react.createElement("option",{value:types.G3.PAINT_BUCKET},types.G3.PAINT_BUCKET),react.createElement("option",{value:types.G3.SELECT},types.G3.SELECT))),react.createElement("div",{style:{display:"flex",alignItems:"center",marginTop:10,marginBottom:3}},react.createElement("span",{style:{fontSize:13}},"Brush Color"),react.createElement("div",{style:{borderRadius:"50%",width:20,height:20,marginLeft:15,marginRight:15,backgroundColor:brushColor}}),react.createElement("input",{type:"color",value:brushColor,onChange:handleColorChange})),react.createElement("div",null))}},"./stories/useDottingComponents/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{UZ:()=>useDottingComponents_Clear,aF:()=>ColorPixels,sQ:()=>useDottingComponents_DownloadImage,U6:()=>useDottingComponents_GridChange,P$:()=>useDottingComponents_SetData,Z_:()=>useDottingComponents_SetIndicatorPixels,$x:()=>useDottingComponents_SetLayers,QA:()=>useDottingComponents_UndoRedo});var react=__webpack_require__("./node_modules/react/index.js"),components_Dotting=__webpack_require__("./src/components/Dotting.tsx"),useDotting=__webpack_require__("./src/hooks/useDotting.ts");const useDottingComponents_Clear=function Clear(){var ref=(0,react.useRef)(null),clear=(0,useDotting.Z)(ref).clear;return react.createElement("div",{style:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center"}},react.createElement(components_Dotting.Z,{ref,width:"100%",height:300}),react.createElement("button",{style:{padding:"5px 10px",background:"none",marginTop:10,marginBottom:50},onClick:clear},"Clear Canvas"))};__webpack_require__("./node_modules/core-js/modules/es.number.constructor.js");var slicedToArray=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/slicedToArray.js");const ColorPixels=function ChangePixelColor(){var ref=(0,react.useRef)(null),_useDotting=(0,useDotting.Z)(ref),colorPixels=_useDotting.colorPixels,erasePixels=_useDotting.erasePixels,_React$useState=react.useState(0),_React$useState2=(0,slicedToArray.Z)(_React$useState,2),rowIndex=_React$useState2[0],setRowIndex=_React$useState2[1],_React$useState3=react.useState(0),_React$useState4=(0,slicedToArray.Z)(_React$useState3,2),columnIndex=_React$useState4[0],setColumnIndex=_React$useState4[1],_React$useState5=react.useState(0),_React$useState6=(0,slicedToArray.Z)(_React$useState5,2),rowIndex2=_React$useState6[0],setRowIndex2=_React$useState6[1],_React$useState7=react.useState(0),_React$useState8=(0,slicedToArray.Z)(_React$useState7,2),columnIndex2=_React$useState8[0],setColumnIndex2=_React$useState8[1];return react.createElement("div",{style:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center",fontFamily:"'Nunito Sans', 'Helvetica Neue', Helvetica, Arial, sans-serif"}},react.createElement(components_Dotting.Z,{ref,width:"100%",height:300}),react.createElement("div",null,react.createElement("div",{style:{padding:"20px 0",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"}},react.createElement("div",{style:{display:"flex",flexWrap:"wrap"}},react.createElement("div",{style:{margin:"0 10px"}},react.createElement("span",null,"Row Index: "),react.createElement("input",{style:{width:40,height:20},type:"number",value:rowIndex,onChange:function onChange(e){return setRowIndex(Number(e.target.value))}})),react.createElement("div",{style:{margin:"0 10px"}},react.createElement("span",null,"Column Index: "),react.createElement("input",{style:{width:40,height:20},type:"number",value:columnIndex,onChange:function onChange(e){return setColumnIndex(Number(e.target.value))}}))),react.createElement("button",{style:{padding:"5px 10px",background:"none",marginTop:15},onClick:function onClick(){return colorPixels([{rowIndex,columnIndex,color:"red"}])}},"Color Pixel")),react.createElement("div",{style:{padding:"20px 0",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"}},react.createElement("div",{style:{display:"flex",flexWrap:"wrap"}},react.createElement("div",{style:{margin:"0 10px"}},react.createElement("span",null,"Row Index: "),react.createElement("input",{style:{width:40,height:20},type:"number",value:rowIndex2,onChange:function onChange(e){return setRowIndex2(Number(e.target.value))}})),react.createElement("div",{style:{margin:"0 10px"}},react.createElement("span",null,"Column Index: "),react.createElement("input",{style:{width:40,height:20},type:"number",value:columnIndex2,onChange:function onChange(e){return setColumnIndex2(Number(e.target.value))}}))),react.createElement("button",{style:{padding:"5px 10px",background:"none",marginTop:15,marginBottom:30},onClick:function onClick(){return erasePixels([{rowIndex:rowIndex2,columnIndex:columnIndex2}])}},"Erase Pixel"))))};const useDottingComponents_DownloadImage=function DownloadImage(){var ref=(0,react.useRef)(null),downloadImage=(0,useDotting.Z)(ref).downloadImage;return react.createElement("div",{style:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center"}},react.createElement(components_Dotting.Z,{ref,width:"100%",height:300}),react.createElement("button",{style:{padding:"5px 10px",background:"none",marginTop:15},onClick:function onClick(){return downloadImage({type:"png"})}},"Download as PNG"),react.createElement("button",{style:{padding:"5px 10px",background:"none",marginTop:10,marginBottom:50},onClick:function onClick(){return downloadImage({type:"svg"})}},"Download as SVG"))};const useDottingComponents_GridChange=function GridChange(){var ref=(0,react.useRef)(null),_useDotting=(0,useDotting.Z)(ref),addGridIndices=(_useDotting.colorPixels,_useDotting.erasePixels,_useDotting.addGridIndices),deleteGridIndices=_useDotting.deleteGridIndices,_React$useState=react.useState(0),_React$useState2=(0,slicedToArray.Z)(_React$useState,2),rowIndex=_React$useState2[0],setRowIndex=_React$useState2[1],_React$useState3=react.useState(0),_React$useState4=(0,slicedToArray.Z)(_React$useState3,2),columnIndex=_React$useState4[0],setColumnIndex=_React$useState4[1];return react.createElement("div",{style:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center",fontFamily:"'Nunito Sans', 'Helvetica Neue', Helvetica, Arial, sans-serif"}},react.createElement(components_Dotting.Z,{ref,width:"100%",height:300}),react.createElement("div",null,react.createElement("div",{style:{padding:"20px 0",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"}},react.createElement("div",{style:{display:"flex",flexWrap:"wrap"}},react.createElement("div",{style:{margin:"0 10px"}},react.createElement("span",null,"Target row index: "),react.createElement("input",{style:{width:40,height:20},type:"number",value:rowIndex,onChange:function onChange(e){return setRowIndex(Number(e.target.value))}}))),react.createElement("div",null,react.createElement("button",{style:{padding:"5px 10px",background:"none",marginTop:15},onClick:function onClick(){return addGridIndices({columnIndices:[],rowIndices:[rowIndex]})}},"Add Row"),react.createElement("button",{style:{padding:"5px 10px",background:"none",marginTop:15},onClick:function onClick(){return deleteGridIndices({columnIndices:[],rowIndices:[rowIndex]})}},"Remove Row"))),react.createElement("div",{style:{padding:"20px 0",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"}},react.createElement("div",{style:{display:"flex",flexWrap:"wrap"}},react.createElement("div",{style:{margin:"0 10px"}},react.createElement("span",null,"Target column index: "),react.createElement("input",{style:{width:40,height:20},type:"number",value:columnIndex,onChange:function onChange(e){return setColumnIndex(Number(e.target.value))}}))),react.createElement("div",null,react.createElement("button",{style:{padding:"5px 10px",background:"none",marginTop:15,marginBottom:30},onClick:function onClick(){addGridIndices({columnIndices:[columnIndex],rowIndices:[]})}},"Add Column"),react.createElement("button",{style:{padding:"5px 10px",background:"none",marginTop:15,marginBottom:30},onClick:function onClick(){deleteGridIndices({columnIndices:[columnIndex],rowIndices:[]})}},"Remove Column")))))};var dataCreator=__webpack_require__("./stories/utils/dataCreator.ts");const useDottingComponents_SetData=function SetData(){var ref=(0,react.useRef)(null),_useDotting=(0,useDotting.Z)(ref),setData=_useDotting.setData;_useDotting.setLayers;return react.createElement("div",{style:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center",fontFamily:"'Nunito Sans', 'Helvetica Neue', Helvetica, Arial, sans-serif"}},react.createElement(components_Dotting.Z,{ref,width:"100%",height:300}),react.createElement("div",null,react.createElement("div",{style:{padding:"20px 0",display:"flex",justifyContent:"center",alignItems:"center",marginBottom:50,gap:5}},react.createElement("button",{style:{padding:"5px 10px",background:"none"},onClick:function onClick(){setData((0,dataCreator.n)(5))}},"Set Data to 5 X 5"),react.createElement("button",{style:{padding:"5px 10px",background:"none"},onClick:function onClick(){setData((0,dataCreator.n)(64))}},"Set Data to 64 X 64"),react.createElement("button",{style:{padding:"5px 10px",background:"none"},onClick:function onClick(){setData((0,dataCreator.n)(100))}},"Set Data to 100 X 100"))))};const useDottingComponents_SetIndicatorPixels=function SetIndicatorPixels(){var ref=(0,react.useRef)(null),setIndicatorPixels=(0,useDotting.Z)(ref).setIndicatorPixels,_React$useState=react.useState(!1),_React$useState2=(0,slicedToArray.Z)(_React$useState,2),areIndicatorsShown=_React$useState2[0],setAreIndicatorsShown=_React$useState2[1],showIndicators=(0,react.useCallback)((function(){setIndicatorPixels([{rowIndex:0,columnIndex:0,color:"#ff0000"},{rowIndex:1,columnIndex:1,color:"#ff0000"}])}),[setIndicatorPixels,setAreIndicatorsShown]),hideIndicators=(0,react.useCallback)((function(){setIndicatorPixels([])}),[setIndicatorPixels,setAreIndicatorsShown]);return react.createElement("div",{style:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center",fontFamily:"'Nunito Sans', 'Helvetica Neue', Helvetica, Arial, sans-serif"}},react.createElement(components_Dotting.Z,{ref,width:"100%",height:300}),react.createElement("div",null,react.createElement("div",{style:{padding:"20px 0",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"}},react.createElement("button",{style:{padding:"5px 10px",background:"none",marginTop:15,marginBottom:30},onClick:function onClick(){areIndicatorsShown?(setAreIndicatorsShown(!1),hideIndicators()):(setAreIndicatorsShown(!0),showIndicators())}},areIndicatorsShown?"Hide Indicators":"Show Indicators"))))};__webpack_require__("./node_modules/core-js/modules/es.array.splice.js"),__webpack_require__("./node_modules/core-js/modules/es.array.map.js"),__webpack_require__("./node_modules/core-js/modules/es.function.bind.js");var toConsumableArray=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),src=__webpack_require__("./src/index.ts"),useLayers=__webpack_require__("./src/hooks/useLayers.ts");const useDottingComponents_SetLayers=function SetLayers(){var ref=(0,react.useRef)(null),changeBrushColor=(0,src.DX)(ref).changeBrushColor,_useLayers=(0,useLayers.Z)(ref),layers=_useLayers.layers,removeLayer=_useLayers.removeLayer,changeLayerPosition=_useLayers.changeLayerPosition,currentLayer=_useLayers.currentLayer,setCurrentLayer=_useLayers.setCurrentLayer,reorderLayersByIds=_useLayers.reorderLayersByIds,setLayers=(0,src.NU)(ref).setLayers,_useState=(0,react.useState)(null),_useState2=(0,slicedToArray.Z)(_useState,2),draggingSectionId=_useState2[0],setDraggingSectionId=_useState2[1],draggingItemIndex=(0,react.useRef)(null),draggingOverItemIndex=(0,react.useRef)(null),onDragEnd=function onDragEnd(e){reorderLayersByIds(layers.map((function(layer){return layer.id}))),setDraggingSectionId(null)},onDragOver=function onDragOver(e){e.preventDefault()};return react.createElement("div",{style:{marginTop:20,width:"100%",display:"flex",fontFamily:"'Nunito Sans', 'Helvetica Neue', Helvetica, Arial, sans-serif",marginBottom:50}},react.createElement("div",{style:{display:"flex",flexDirection:"column",paddingRight:10,maxWidth:150}},react.createElement("div",{style:{fontSize:18,marginBottom:5}},"Layers"),react.createElement("div",{style:{fontSize:12,marginBottom:5}},"Drag and Drop the layers to move their positions"),react.createElement("ul",{style:{width:"100%",height:440,overflowY:"scroll",overflow:"auto",display:"flex",gap:5,flexDirection:"column",listStyleType:"none",padding:0,margin:0}},layers.map((function(layer,index){return react.createElement("li",{style:{display:"flex",flexDirection:"column",listStyle:"none",textAlign:"center",border:"1px solid black",padding:5,gap:5,backgroundColor:currentLayer.id===layer.id?"grey":"white",color:currentLayer.id===layer.id?"white":"black",cursor:"pointer",opacity:draggingSectionId===layer.id?.5:1},key:layer.id,onClick:function onClick(e){return function onClickHandler(e,id){e.stopPropagation(),setCurrentLayer(id)}(e,layer.id)},onDragStart:function onDragStart(e){return function onDragStart(e,index,id){draggingItemIndex.current=index,setDraggingSectionId(id)}(0,index,layer.id)},onDragEnter:function onDragEnter(e){return function onAvailableItemDragEnter(e,index){draggingOverItemIndex.current=index;var copyListItems=(0,toConsumableArray.Z)(layers),draggingItemContent=copyListItems[draggingItemIndex.current];copyListItems.splice(draggingItemIndex.current,1),copyListItems.splice(draggingOverItemIndex.current,0,draggingItemContent),draggingItemIndex.current=draggingOverItemIndex.current,draggingOverItemIndex.current=null,changeLayerPosition(draggingItemContent.id,index)}(0,index)},onDragEnd,onDragOver,draggable:!0},react.createElement("div",null,layer.id),react.createElement("div",null,react.createElement("button",{onClick:function onClick(e){e.stopPropagation(),removeLayer(layer.id)}},"remove")))})))),react.createElement("div",{style:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center"}},react.createElement(components_Dotting.Z,{ref,width:"100%",height:500,initLayers:[{id:"layer1",data:(0,dataCreator.n)(15)},{id:"layer2",data:(0,dataCreator.n)(15)},{id:"layer3",data:(0,dataCreator.n)(15)}]}),react.createElement("div",null,["#FF0000","#0000FF","#00FF00","#FF00FF","#00FFFF","#FFFF00","#000000","#FFFFFF"].map((function(color){return react.createElement("div",{key:color,onClick:changeBrushColor.bind(null,color),style:{width:25,height:25,margin:10,border:"1px solid black",backgroundColor:color,display:"inline-block"}})}))),react.createElement("div",null,react.createElement("button",{style:{padding:"5px 10px",background:"none"},onClick:function onClick(){setLayers([{id:"layer1",data:(0,dataCreator.n)(15)}])}},"Set Single Layer"),react.createElement("button",{style:{padding:"5px 10px",background:"none"},onClick:function onClick(){setLayers([{id:"layer1",data:(0,dataCreator.n)(15)},{id:"layer2",data:(0,dataCreator.n)(15)}])}},"Set Two Layers"))))};const useDottingComponents_UndoRedo=function UndoRedo(){var ref=(0,react.useRef)(null),_useDotting=(0,useDotting.Z)(ref),undo=_useDotting.undo,redo=_useDotting.redo;return react.createElement("div",{style:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center"}},react.createElement(components_Dotting.Z,{ref,width:"100%",height:300}),react.createElement("div",{style:{marginTop:10,marginBottom:50,display:"flex"}},react.createElement("button",{style:{padding:"5px 10px",background:"none"},onClick:undo},"undo"),react.createElement("button",{style:{padding:"5px 10px",background:"none"},onClick:redo},"redo")))}},"./stories/utils/dataCreator.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{n:()=>CreateEmptySquareData});var CreateEmptySquareData=function CreateEmptySquareData(size){for(var data=[],i=0;i<size;i++){for(var row=[],j=0;j<size;j++)row.push({rowIndex:i,columnIndex:j,color:""});data.push(row)}return data}},"./storybook-init-framework-entry.js":(__unused_webpack_module,__unused_webpack___webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__("./node_modules/@storybook/react/dist/esm/client/index.js")},"./stories/CustomRender.stories.mdx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{__namedExportsOrder:()=>__namedExportsOrder,__page:()=>__page,default:()=>CustomRender_stories});__webpack_require__("./node_modules/core-js/modules/es.object.assign.js");var react=__webpack_require__("./node_modules/react/index.js"),esm=__webpack_require__("./node_modules/@storybook/addon-docs/dist/esm/index.js"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),dist_esm=__webpack_require__("./node_modules/@mdx-js/react/dist/esm.js"),stackalt=(__webpack_require__("./stories/assets/code-brackets.svg"),__webpack_require__("./stories/assets/colors.svg"),__webpack_require__("./stories/assets/comments.svg"),__webpack_require__("./stories/assets/direction.svg"),__webpack_require__("./stories/assets/flow.svg"),__webpack_require__("./stories/assets/plugin.svg"),__webpack_require__("./stories/assets/repo.svg"),__webpack_require__("./stories/assets/stackalt.svg")),Dotting=__webpack_require__("./src/components/Dotting.tsx"),src=(__webpack_require__("./stories/useBrushComponents/index.ts"),__webpack_require__("./node_modules/core-js/modules/es.array.fill.js"),__webpack_require__("./src/index.ts"));const customization_CustomRender=function CustomRender(){var ref=(0,react.useRef)(null),_useDotting=(0,src.NU)(ref),getForegroundCanvas=_useDotting.getForegroundCanvas,getBackgroundCanvas=_useDotting.getBackgroundCanvas,convertWorldPosToCanvasOffset=_useDotting.convertWorldPosToCanvasOffset,_useHandlers=(0,src.eJ)(ref),addCanvasInfoChangeEventListener=_useHandlers.addCanvasInfoChangeEventListener,removeCanvasInfoChangeEventListener=_useHandlers.removeCanvasInfoChangeEventListener,addCanvasElementEventListener=_useHandlers.addCanvasElementEventListener,removeCanvasElementEventListener=_useHandlers.removeCanvasElementEventListener;return(0,react.useEffect)((function(){var renderer=function renderer(e){var fgCanvas=getForegroundCanvas(),width=fgCanvas.width,height=fgCanvas.height,fgCtx=fgCanvas.getContext("2d");fgCtx.clearRect(0,0,width,height),fgCtx.fillStyle="#FFFFFF",fgCtx.strokeStyle="#000000";var mouseOffset={x:e.offsetX,y:e.offsetY};fgCtx.beginPath(),fgCtx.arc(mouseOffset.x,mouseOffset.y,20,0,2*Math.PI),fgCtx.closePath(),fgCtx.fill(),fgCtx.stroke()};return addCanvasElementEventListener("mousemove",renderer),function(){removeCanvasElementEventListener("mousemove",renderer)}}),[]),(0,react.useEffect)((function(){var renderer=function renderer(_ref){_ref.topLeftCornerOffset;var gridSquareSize=_ref.gridSquareSize,bgCanvas=getBackgroundCanvas(),width=bgCanvas.width,height=bgCanvas.height,bgCtx=bgCanvas.getContext("2d"),img=new Image;img.src="https://www.cosy.sbg.ac.at/~pmeerw/Watermarking/lena_gray.gif";var _convertWorldPosToCan=convertWorldPosToCanvasOffset(0,0),x=_convertWorldPosToCan.x,y=_convertWorldPosToCan.y,imageWidth=10*gridSquareSize,imageHeight=10*gridSquareSize;img.onload=function(){bgCtx.clearRect(0,0,width,height),bgCtx.drawImage(img,x,y,imageWidth,imageHeight)}};return addCanvasInfoChangeEventListener(renderer),function(){removeCanvasInfoChangeEventListener(renderer)}}),[getForegroundCanvas,getBackgroundCanvas,addCanvasInfoChangeEventListener,removeCanvasInfoChangeEventListener]),react.createElement("div",{style:{width:"100%",display:"flex",fontFamily:"'Nunito Sans', 'Helvetica Neue', Helvetica, Arial, sans-serif",marginBottom:50}},react.createElement("div",{style:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center"}},react.createElement(Dotting.Z,{ref,width:"100%",height:500,defaultPixelColor:"transparent"})))};function _createMdxContent(props){var _components=Object.assign({h1:"h1",h4:"h4",p:"p",code:"code",h3:"h3",pre:"pre"},(0,dist_esm.ah)(),props.components);return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(esm.h_,{title:"Customization/CustomRender"}),"\n",(0,jsx_runtime.jsx)("style",{children:"\n  .subheading {\n    --mediumdark: '#999999';\n    font-weight: 900;\n    font-size: 13px;\n    color: #999;\n    letter-spacing: 6px;\n    line-height: 24px;\n    text-transform: uppercase;\n    margin-bottom: 12px;\n    margin-top: 40px;\n    font-family: 'Nunito Sans', 'Helvetica Neue', Helvetica, Arial, sans-serif;\n  }\n\n  .link-list {\n    display: grid;\n    grid-template-columns: 1fr;\n    grid-template-rows: 1fr 1fr;\n    row-gap: 10px;\n  }\n\n  @media (min-width: 620px) {\n    .link-list {\n      row-gap: 20px;\n      column-gap: 20px;\n      grid-template-columns: 1fr 1fr;\n    }\n  }\n\n  @media all and (-ms-high-contrast:none) {\n  .link-list {\n      display: -ms-grid;\n      -ms-grid-columns: 1fr 1fr;\n      -ms-grid-rows: 1fr 1fr;\n    }\n  }\n\n  .link-item {\n    display: block;\n    padding: 20px 30px 20px 15px;\n    border: 1px solid #00000010;\n    border-radius: 5px;\n    transition: background 150ms ease-out, border 150ms ease-out, transform 150ms ease-out;\n    color: #333333;\n    display: flex;\n    align-items: flex-start;\n  }\n\n  .link-item:hover {\n    border-color: #1EA7FD50;\n    transform: translate3d(0, -3px, 0);\n    box-shadow: rgba(0, 0, 0, 0.08) 0 3px 10px 0;\n  }\n\n  .link-item:active {\n    border-color: #1EA7FD;\n    transform: translate3d(0, 0, 0);\n  }\n\n  .link-item strong {\n    font-weight: 700;\n    display: block;\n    margin-bottom: 2px;\n  }\n  \n  .link-item img {\n    height: 40px;\n    width: 40px;\n    margin-right: 15px;\n    flex: none;\n  }\n\n  .link-item span {\n    font-size: 14px;\n    line-height: 20px;\n  }\n\n  .tip {\n    display: inline-block;\n    border-radius: 1em;\n    font-size: 11px;\n    line-height: 12px;\n    font-weight: 700;\n    background: #E7FDD8;\n    color: #66BF3C;\n    padding: 4px 12px;\n    margin-right: 10px;\n    vertical-align: top;\n  }\n\n  .tip-wrapper {\n    font-size: 13px;\n    line-height: 20px;\n    margin-top: 40px;\n    margin-bottom: 40px;\n  }\n\n  .tip-wrapper code {\n    font-size: 12px;\n    display: inline-block;\n  }\n"}),"\n",(0,jsx_runtime.jsx)(_components.h1,{children:"Adding your own render logic"}),"\n",(0,jsx_runtime.jsx)(_components.h4,{children:"Manipulating foreground or background canvas rendering context"}),"\n",(0,jsx_runtime.jsxs)(_components.p,{children:["Dotting provides users to manipulate the rendering context of the foreground and background canvas.\nUsers can access the foreground canvas and background canvas by using ",(0,jsx_runtime.jsx)(_components.code,{children:"getForegroundCanvas"})," and ",(0,jsx_runtime.jsx)(_components.code,{children:"getBackgroundCanvas"})," methods from ",(0,jsx_runtime.jsx)(_components.code,{children:"useDotting"})]}),"\n",(0,jsx_runtime.jsxs)(_components.h3,{children:["To get the foreground or background canvas, you must use ",(0,jsx_runtime.jsx)(_components.code,{children:"useDotting"})," hook"]}),"\n",(0,jsx_runtime.jsx)(_components.pre,{children:(0,jsx_runtime.jsx)(_components.code,{className:"language-tsx",children:'import { useDotting, DottingRef, Dotting } from "dotting";\n\nconst DottingComponent = () => {\n  const { getForegroundCanvas, getBackgroundCanvas } =\n    useDotting<DottingRef>(ref);\n\n  // use getForegroundCanvas or getBackgroundCanvas\n\n  return <Dotting ref={ref} width={300} height={300} />;\n};\n'})}),"\n",(0,jsx_runtime.jsx)(customization_CustomRender,{}),"\n",(0,jsx_runtime.jsx)(_components.p,{children:"Code Base"}),"\n",(0,jsx_runtime.jsx)(_components.pre,{children:(0,jsx_runtime.jsx)(_components.code,{className:"language-tsx",children:'import React, { useEffect, useRef } from "react";\n\nimport {\n  Dotting,\n  DottingRef,\n  CanvasInfoChangeParams,\n  useDotting,\n  useHandlers,\n} from "dotting";\n\nconst CustomRender = () => {\n  const ref = useRef<DottingRef>(null);\n  const {\n    getForegroundCanvas,\n    getBackgroundCanvas,\n    convertWorldPosToCanvasOffset,\n  } = useDotting(ref);\n  const {\n    addCanvasInfoChangeEventListener,\n    removeCanvasInfoChangeEventListener,\n    addCanvasElementEventListener,\n    removeCanvasElementEventListener,\n  } = useHandlers(ref);\n\n  useEffect(() => {\n    const renderer: EventListenerOrEventListenerObject = (e: any) => {\n      const fgCanvas = getForegroundCanvas();\n      const width = fgCanvas.width;\n      const height = fgCanvas.height;\n      const fgCtx = fgCanvas.getContext("2d");\n      fgCtx.clearRect(0, 0, width, height);\n      fgCtx.fillStyle = "#FFFFFF";\n      fgCtx.strokeStyle = "#000000";\n      const offsetX = e.offsetX;\n      const offsetY = e.offsetY;\n      const mouseOffset = {\n        x: offsetX,\n        y: offsetY,\n      };\n      fgCtx.beginPath();\n      fgCtx.arc(mouseOffset.x, mouseOffset.y, 20, 0, 2 * Math.PI);\n      fgCtx.closePath();\n\n      fgCtx.fill();\n      fgCtx.stroke();\n    };\n    addCanvasElementEventListener("mousemove", renderer);\n    return () => {\n      removeCanvasElementEventListener("mousemove", renderer);\n    };\n  }, []);\n\n  useEffect(() => {\n    const renderer = ({\n      topLeftCornerOffset,\n      gridSquareSize,\n    }: CanvasInfoChangeParams) => {\n      const bgCanvas = getBackgroundCanvas();\n      const width = bgCanvas.width;\n      const height = bgCanvas.height;\n      const bgCtx = bgCanvas.getContext("2d");\n      const imgUrl =\n        "https://www.cosy.sbg.ac.at/~pmeerw/Watermarking/lena_gray.gif";\n      const img = new Image();\n      img.src = imgUrl;\n      const imageWorldPosX = 0;\n      const imageWorldPosY = 0;\n\n      const { x, y } = convertWorldPosToCanvasOffset(\n        imageWorldPosX,\n        imageWorldPosY,\n      );\n\n      const imageWidth = gridSquareSize * 10;\n      const imageHeight = gridSquareSize * 10;\n\n      img.onload = () => {\n        bgCtx.clearRect(0, 0, width, height);\n        bgCtx.drawImage(img, x, y, imageWidth, imageHeight);\n      };\n    };\n    addCanvasInfoChangeEventListener(renderer);\n    return () => {\n      removeCanvasInfoChangeEventListener(renderer);\n    };\n  }, [\n    getForegroundCanvas,\n    getBackgroundCanvas,\n    addCanvasInfoChangeEventListener,\n    removeCanvasInfoChangeEventListener,\n  ]);\n\n  return (\n    <div\n      style={{\n        width: "100%",\n        display: "flex",\n        fontFamily: `\'Nunito Sans\', \'Helvetica Neue\', Helvetica, Arial, sans-serif`,\n        marginBottom: 50,\n      }}\n    >\n      <div\n        style={{\n          width: "100%",\n          display: "flex",\n          flexDirection: "column",\n          alignItems: "center",\n        }}\n      >\n        <Dotting\n          ref={ref}\n          width={"100%"}\n          height={500}\n          defaultPixelColor="transparent"\n        />\n      </div>\n    </div>\n  );\n};\n\nexport default CustomRender;\n'})}),"\n",(0,jsx_runtime.jsx)("div",{className:"subheading",children:"Resources"}),"\n",(0,jsx_runtime.jsx)("div",{className:"link-list",children:(0,jsx_runtime.jsxs)("a",{className:"link-item",href:"https://github.com/hunkim98/dotting/tree/main/stories/customization/CustomRender.tsx",target:"_blank",children:[(0,jsx_runtime.jsx)("img",{src:stackalt,alt:"Build"}),(0,jsx_runtime.jsx)("span",{children:(0,jsx_runtime.jsxs)(_components.p,{children:[(0,jsx_runtime.jsx)("strong",{children:"Github Source Code"}),"\nView the source code and contribute to the project!"]})})]})}),"\n",(0,jsx_runtime.jsx)("div",{className:"tip-wrapper"}),"\n",(0,jsx_runtime.jsx)(_components.pre,{children:(0,jsx_runtime.jsx)(_components.code,{})})]})}function MDXContent(){var props=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},MDXLayout=Object.assign({},(0,dist_esm.ah)(),props.components).wrapper;return MDXLayout?(0,jsx_runtime.jsx)(MDXLayout,Object.assign({},props,{children:(0,jsx_runtime.jsx)(_createMdxContent,props)})):_createMdxContent(props)}var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Customization/CustomRender",includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return react.createElement(esm.aT,{mdxStoryNameToKey,mdxComponentAnnotations:componentMeta},react.createElement(MDXContent,null))}});const CustomRender_stories=componentMeta;var __namedExportsOrder=["__page"]},"./stories/Hooks.stories.mdx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{__namedExportsOrder:()=>__namedExportsOrder,__page:()=>__page,default:()=>__WEBPACK_DEFAULT_EXPORT__});__webpack_require__("./node_modules/core-js/modules/es.object.assign.js");var react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/index.js"),_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@storybook/addon-docs/dist/esm/index.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/react/jsx-runtime.js"),_mdx_js_react__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@mdx-js/react/dist/esm.js"),_useDottingComponents__WEBPACK_IMPORTED_MODULE_14__=(__webpack_require__("./stories/assets/code-brackets.svg"),__webpack_require__("./stories/assets/colors.svg"),__webpack_require__("./stories/assets/comments.svg"),__webpack_require__("./stories/assets/direction.svg"),__webpack_require__("./stories/assets/flow.svg"),__webpack_require__("./stories/assets/plugin.svg"),__webpack_require__("./stories/assets/repo.svg"),__webpack_require__("./stories/assets/stackalt.svg"),__webpack_require__("./src/components/Dotting.tsx"),__webpack_require__("./stories/useDottingComponents/index.ts"));function _createMdxContent(props){var _components=Object.assign({h1:"h1",h4:"h4",p:"p",code:"code",pre:"pre"},(0,_mdx_js_react__WEBPACK_IMPORTED_MODULE_4__.ah)(),props.components);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_2__.h_,{title:"Hooks/Setup"}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("style",{children:"\n  .subheading {\n    --mediumdark: '#999999';\n    font-weight: 900;\n    font-size: 13px;\n    color: #999;\n    letter-spacing: 6px;\n    line-height: 24px;\n    text-transform: uppercase;\n    margin-bottom: 12px;\n    margin-top: 40px;\n    font-family: 'Nunito Sans', 'Helvetica Neue', Helvetica, Arial, sans-serif;\n  }\n\n  .link-list {\n    display: grid;\n    grid-template-columns: 1fr;\n    grid-template-rows: 1fr 1fr;\n    row-gap: 10px;\n  }\n\n  @media (min-width: 620px) {\n    .link-list {\n      row-gap: 20px;\n      column-gap: 20px;\n      grid-template-columns: 1fr 1fr;\n    }\n  }\n\n  @media all and (-ms-high-contrast:none) {\n  .link-list {\n      display: -ms-grid;\n      -ms-grid-columns: 1fr 1fr;\n      -ms-grid-rows: 1fr 1fr;\n    }\n  }\n\n  .link-item {\n    display: block;\n    padding: 20px 30px 20px 15px;\n    border: 1px solid #00000010;\n    border-radius: 5px;\n    transition: background 150ms ease-out, border 150ms ease-out, transform 150ms ease-out;\n    color: #333333;\n    display: flex;\n    align-items: flex-start;\n  }\n\n  .link-item:hover {\n    border-color: #1EA7FD50;\n    transform: translate3d(0, -3px, 0);\n    box-shadow: rgba(0, 0, 0, 0.08) 0 3px 10px 0;\n  }\n\n  .link-item:active {\n    border-color: #1EA7FD;\n    transform: translate3d(0, 0, 0);\n  }\n\n  .link-item strong {\n    font-weight: 700;\n    display: block;\n    margin-bottom: 2px;\n  }\n  \n  .link-item img {\n    height: 40px;\n    width: 40px;\n    margin-right: 15px;\n    flex: none;\n  }\n\n  .link-item span {\n    font-size: 14px;\n    line-height: 20px;\n  }\n\n  .tip {\n    display: inline-block;\n    border-radius: 1em;\n    font-size: 11px;\n    line-height: 12px;\n    font-weight: 700;\n    background: #E7FDD8;\n    color: #66BF3C;\n    padding: 4px 12px;\n    margin-right: 10px;\n    vertical-align: top;\n  }\n\n  .tip-wrapper {\n    font-size: 13px;\n    line-height: 20px;\n    margin-top: 40px;\n    margin-bottom: 40px;\n  }\n\n  .tip-wrapper code {\n    font-size: 12px;\n    display: inline-block;\n  }\n"}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.h1,{children:"Using hooks for interaction!"}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.h4,{children:"How to setup hooks"}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)(_components.p,{children:["To manipulate the Dotting component you should have a ref object attached to the Dotting Component.\nYou can use React's ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"useRef"})," to get the DottingRef refobject of the Dotting Component.\nAfter the ref object is set, you can use the ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"useDotting"})," or ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"useBrush"})," hook and pass the ref as its parameter."]}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)(_components.p,{children:["Below is the example setup for using the ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"useDotting"})," hook.\nThe example below shows how you can clear the canvas."]}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.h4,{children:"Setup Example (Clearing the Canvas)"}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.pre,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{className:"language-ts",children:'export const Component = () => {\n  const ref = useRef<DottingRef>(null);\n  const { clear } = useDotting(ref);\n  return (\n    <div>\n      <Dotting ref={ref} width={"100%"} height={300} />\n      <button onClick={clear}>Clear Canvas</button>\n    </div>\n  );\n};\n'})}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_useDottingComponents__WEBPACK_IMPORTED_MODULE_14__.UZ,{})]})}function MDXContent(){var props=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},MDXLayout=Object.assign({},(0,_mdx_js_react__WEBPACK_IMPORTED_MODULE_4__.ah)(),props.components).wrapper;return MDXLayout?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(MDXLayout,Object.assign({},props,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_createMdxContent,props)})):_createMdxContent(props)}var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Hooks/Setup",includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return react__WEBPACK_IMPORTED_MODULE_1__.createElement(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_2__.aT,{mdxStoryNameToKey,mdxComponentAnnotations:componentMeta},react__WEBPACK_IMPORTED_MODULE_1__.createElement(MDXContent,null))}});const __WEBPACK_DEFAULT_EXPORT__=componentMeta;var __namedExportsOrder=["__page"]},"./stories/Introduction.stories.mdx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{__namedExportsOrder:()=>__namedExportsOrder,__page:()=>__page,default:()=>Introduction_stories});__webpack_require__("./node_modules/core-js/modules/es.object.assign.js");var react=__webpack_require__("./node_modules/react/index.js"),esm=__webpack_require__("./node_modules/@storybook/addon-docs/dist/esm/index.js"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),dist_esm=__webpack_require__("./node_modules/@mdx-js/react/dist/esm.js"),stackalt=(__webpack_require__("./stories/assets/code-brackets.svg"),__webpack_require__("./stories/assets/colors.svg"),__webpack_require__("./stories/assets/comments.svg"),__webpack_require__("./stories/assets/direction.svg"),__webpack_require__("./stories/assets/flow.svg"),__webpack_require__("./stories/assets/plugin.svg"),__webpack_require__("./stories/assets/repo.svg"),__webpack_require__("./stories/assets/stackalt.svg")),Dotting=__webpack_require__("./src/components/Dotting.tsx"),src=(__webpack_require__("./stories/useBrushComponents/index.ts"),__webpack_require__("./node_modules/core-js/modules/es.array.map.js"),__webpack_require__("./node_modules/core-js/modules/es.function.bind.js"),__webpack_require__("./src/index.ts"));const custom_CustomExample=function CustomExample(){var ref=(0,react.useRef)(null),_useDotting=(0,src.NU)(ref),undo=_useDotting.undo,redo=_useDotting.redo,_useBrush=(0,src.DX)(ref),changeBrushColor=_useBrush.changeBrushColor,brushTool=_useBrush.brushTool,changeBrushTool=_useBrush.changeBrushTool;return react.createElement("div",{style:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center",position:"relative"}},react.createElement(Dotting.Z,{ref,width:"100%",height:300}),react.createElement("div",null,["#FF0000","#0000FF","#00FF00","#FF00FF","#00FFFF","#FFFF00","#000000","#FFFFFF"].map((function(color){return react.createElement("div",{key:color,onClick:changeBrushColor.bind(null,color),style:{width:25,height:25,margin:10,border:"1px solid black",backgroundColor:color,display:"inline-block"}})}))),react.createElement("div",null,react.createElement("select",{style:{marginLeft:15},value:brushTool,onChange:function onChange(e){changeBrushTool(e.target.value)}},react.createElement("option",{value:src.G3.NONE},src.G3.NONE),react.createElement("option",{value:src.G3.DOT},src.G3.DOT),react.createElement("option",{value:src.G3.ERASER},src.G3.ERASER),react.createElement("option",{value:src.G3.PAINT_BUCKET},src.G3.PAINT_BUCKET),react.createElement("option",{value:src.G3.SELECT},src.G3.SELECT))),react.createElement("div",{style:{marginTop:10,marginBottom:50,display:"flex"}},react.createElement("button",{style:{padding:"5px 10px",background:"none"},onClick:undo},"undo"),react.createElement("button",{style:{padding:"5px 10px",background:"none"},onClick:redo},"redo")))};function _createMdxContent(props){var _components=Object.assign({h1:"h1",h4:"h4",p:"p",strong:"strong",a:"a",pre:"pre",code:"code"},(0,dist_esm.ah)(),props.components);return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(esm.h_,{title:"Introduction/About"}),"\n",(0,jsx_runtime.jsx)("style",{children:"\n  .subheading {\n    --mediumdark: '#999999';\n    font-weight: 900;\n    font-size: 13px;\n    color: #999;\n    letter-spacing: 6px;\n    line-height: 24px;\n    text-transform: uppercase;\n    margin-bottom: 12px;\n    margin-top: 40px;\n    font-family: 'Nunito Sans', 'Helvetica Neue', Helvetica, Arial, sans-serif;\n  }\n\n  .link-list {\n    display: grid;\n    grid-template-columns: 1fr;\n    grid-template-rows: 1fr 1fr;\n    row-gap: 10px;\n  }\n\n  @media (min-width: 620px) {\n    .link-list {\n      row-gap: 20px;\n      column-gap: 20px;\n      grid-template-columns: 1fr 1fr;\n    }\n  }\n\n  @media all and (-ms-high-contrast:none) {\n  .link-list {\n      display: -ms-grid;\n      -ms-grid-columns: 1fr 1fr;\n      -ms-grid-rows: 1fr 1fr;\n    }\n  }\n\n  .link-item {\n    display: block;\n    padding: 20px 30px 20px 15px;\n    border: 1px solid #00000010;\n    border-radius: 5px;\n    transition: background 150ms ease-out, border 150ms ease-out, transform 150ms ease-out;\n    color: #333333;\n    display: flex;\n    align-items: flex-start;\n  }\n\n  .link-item:hover {\n    border-color: #1EA7FD50;\n    transform: translate3d(0, -3px, 0);\n    box-shadow: rgba(0, 0, 0, 0.08) 0 3px 10px 0;\n  }\n\n  .link-item:active {\n    border-color: #1EA7FD;\n    transform: translate3d(0, 0, 0);\n  }\n\n  .link-item strong {\n    font-weight: 700;\n    display: block;\n    margin-bottom: 2px;\n  }\n  \n  .link-item img {\n    height: 40px;\n    width: 40px;\n    margin-right: 15px;\n    flex: none;\n  }\n\n  .link-item span {\n    font-size: 14px;\n    line-height: 20px;\n  }\n\n  .tip {\n    display: inline-block;\n    border-radius: 1em;\n    font-size: 11px;\n    line-height: 12px;\n    font-weight: 700;\n    background: #E7FDD8;\n    color: #66BF3C;\n    padding: 4px 12px;\n    margin-right: 10px;\n    vertical-align: top;\n  }\n\n  .tip-wrapper {\n    font-size: 13px;\n    line-height: 20px;\n    margin-top: 40px;\n    margin-bottom: 40px;\n  }\n\n  .tip-wrapper code {\n    font-size: 12px;\n    display: inline-block;\n  }\n"}),"\n",(0,jsx_runtime.jsx)(_components.h1,{children:"Welcome to Dotting!"}),"\n",(0,jsx_runtime.jsx)(_components.h4,{children:"Finding a pixel art editor for your website? Look no further!"}),"\n",(0,jsx_runtime.jsxs)(_components.p,{children:["Dotting is a pixel art drawing component for React for creators who want to implement a pixel canvas editor to their websites.\nDotting works for ",(0,jsx_runtime.jsx)(_components.strong,{children:"both PC and mobile environments"}),". You can freely pan & zoom around the using your mouse or your fingers.\nThe canvas grid size is changeable. You can extend your canvas grid to any size by extending the grid from any edges. Make your websites interactive by adding a simple pixel art canvas editor to your website!"]}),"\n",(0,jsx_runtime.jsxs)(_components.p,{children:["Dotting welcomes all contributions!\nIf you are interested in contributing, visit ",(0,jsx_runtime.jsx)(_components.a,{href:"https://github.com/hunkim98/dotting",children:(0,jsx_runtime.jsx)(_components.strong,{children:"Dotting Github"})})," to view the source code!"]}),"\n",(0,jsx_runtime.jsx)(custom_CustomExample,{}),"\n",(0,jsx_runtime.jsx)(_components.h1,{children:"Quick Start"}),"\n",(0,jsx_runtime.jsx)(_components.p,{children:(0,jsx_runtime.jsx)(_components.strong,{children:"Step 1. Install the package"})}),"\n",(0,jsx_runtime.jsx)(_components.pre,{children:(0,jsx_runtime.jsx)(_components.code,{className:"language-bash",children:"$ yarn add dotting\n"})}),"\n",(0,jsx_runtime.jsx)(_components.p,{children:(0,jsx_runtime.jsx)(_components.strong,{children:"Step 2. Implement the component in your React project"})}),"\n",(0,jsx_runtime.jsx)(_components.pre,{children:(0,jsx_runtime.jsx)(_components.code,{className:"language-jsx",children:'import { Dotting } from "dotting";\n\nconst DottingExample = () => {\n  return (\n    <div>\n      <Dotting width={300} height={300} />\n    </div>\n  );\n};\n'})}),"\n",(0,jsx_runtime.jsx)("div",{className:"subheading",children:"Resources"}),"\n",(0,jsx_runtime.jsx)("div",{className:"link-list",children:(0,jsx_runtime.jsxs)("a",{className:"link-item",href:"https://github.com/hunkim98/dotting",target:"_blank",children:[(0,jsx_runtime.jsx)("img",{src:stackalt,alt:"Build"}),(0,jsx_runtime.jsx)("span",{children:(0,jsx_runtime.jsxs)(_components.p,{children:[(0,jsx_runtime.jsx)("strong",{children:"Github Source Code"}),"\nView the source code and contribute to the project!"]})})]})}),"\n",(0,jsx_runtime.jsx)("div",{className:"tip-wrapper"}),"\n",(0,jsx_runtime.jsx)(_components.pre,{children:(0,jsx_runtime.jsx)(_components.code,{})})]})}function MDXContent(){var props=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},MDXLayout=Object.assign({},(0,dist_esm.ah)(),props.components).wrapper;return MDXLayout?(0,jsx_runtime.jsx)(MDXLayout,Object.assign({},props,{children:(0,jsx_runtime.jsx)(_createMdxContent,props)})):_createMdxContent(props)}var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Introduction/About",includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return react.createElement(esm.aT,{mdxStoryNameToKey,mdxComponentAnnotations:componentMeta},react.createElement(MDXContent,null))}});const Introduction_stories=componentMeta;var __namedExportsOrder=["__page"]},"./stories/Layers.stories.mdx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{__namedExportsOrder:()=>__namedExportsOrder,__page:()=>__page,default:()=>Layers_stories});__webpack_require__("./node_modules/core-js/modules/es.object.assign.js");var react=__webpack_require__("./node_modules/react/index.js"),esm=__webpack_require__("./node_modules/@storybook/addon-docs/dist/esm/index.js"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),dist_esm=__webpack_require__("./node_modules/@mdx-js/react/dist/esm.js"),stackalt=(__webpack_require__("./stories/assets/code-brackets.svg"),__webpack_require__("./stories/assets/colors.svg"),__webpack_require__("./stories/assets/comments.svg"),__webpack_require__("./stories/assets/direction.svg"),__webpack_require__("./stories/assets/flow.svg"),__webpack_require__("./stories/assets/plugin.svg"),__webpack_require__("./stories/assets/repo.svg"),__webpack_require__("./stories/assets/stackalt.svg")),Dotting=__webpack_require__("./src/components/Dotting.tsx"),toConsumableArray=(__webpack_require__("./stories/useBrushComponents/index.ts"),__webpack_require__("./node_modules/core-js/modules/es.array.splice.js"),__webpack_require__("./node_modules/core-js/modules/es.array.map.js"),__webpack_require__("./node_modules/core-js/modules/es.function.bind.js"),__webpack_require__("./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js")),slicedToArray=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),src=__webpack_require__("./src/index.ts"),useLayers=__webpack_require__("./src/hooks/useLayers.ts"),dataCreator=__webpack_require__("./stories/utils/dataCreator.ts");const customization_Layers=function Layers(){var ref=(0,react.useRef)(null),changeBrushColor=(0,src.DX)(ref).changeBrushColor,_useLayers=(0,useLayers.Z)(ref),layers=_useLayers.layers,addLayer=_useLayers.addLayer,removeLayer=_useLayers.removeLayer,changeLayerPosition=_useLayers.changeLayerPosition,currentLayer=_useLayers.currentLayer,setCurrentLayer=_useLayers.setCurrentLayer,isolateLayer=_useLayers.isolateLayer,showLayer=_useLayers.showLayer,hideLayer=_useLayers.hideLayer,reorderLayersByIds=_useLayers.reorderLayersByIds,_useState=(0,react.useState)(null),_useState2=(0,slicedToArray.Z)(_useState,2),draggingSectionId=_useState2[0],setDraggingSectionId=_useState2[1],draggingItemIndex=(0,react.useRef)(null),draggingOverItemIndex=(0,react.useRef)(null),_useState3=(0,react.useState)(3),_useState4=(0,slicedToArray.Z)(_useState3,2),createdLayerCount=_useState4[0],setCreatedLayerCount=_useState4[1],_useState5=(0,react.useState)(src.G3.DOT),_useState6=(0,slicedToArray.Z)(_useState5,2),brushTool=_useState6[0],setBrushTool=_useState6[1],onDragEnd=function onDragEnd(e){reorderLayersByIds(layers.map((function(layer){return layer.id}))),setDraggingSectionId(null)},onDragOver=function onDragOver(e){e.preventDefault()};return react.createElement("div",{style:{width:"100%",display:"flex",fontFamily:"'Nunito Sans', 'Helvetica Neue', Helvetica, Arial, sans-serif",marginBottom:50}},react.createElement("div",{style:{display:"flex",flexDirection:"column",paddingRight:10,maxWidth:150}},react.createElement("div",{style:{fontSize:18,marginBottom:5}},"Layers"),react.createElement("div",{style:{fontSize:12,marginBottom:5}},"Drag and Drop the layers to move their positions"),react.createElement("ul",{style:{width:"100%",height:440,overflowY:"scroll",overflow:"auto",display:"flex",gap:5,flexDirection:"column",listStyleType:"none",padding:0,margin:0}},layers.map((function(layer,index){return react.createElement("li",{style:{display:"flex",flexDirection:"column",listStyle:"none",textAlign:"center",border:"1px solid black",padding:5,gap:5,backgroundColor:currentLayer.id===layer.id?"grey":"white",color:currentLayer.id===layer.id?"white":"black",cursor:"pointer",opacity:draggingSectionId===layer.id?.5:1},key:layer.id,onClick:function onClick(e){return function onClickHandler(e,id){e.stopPropagation(),setCurrentLayer(id)}(e,layer.id)},onDragStart:function onDragStart(e){return function onDragStart(e,index,id){draggingItemIndex.current=index,setDraggingSectionId(id)}(0,index,layer.id)},onDragEnter:function onDragEnter(e){return function onAvailableItemDragEnter(e,index){draggingOverItemIndex.current=index;var copyListItems=(0,toConsumableArray.Z)(layers),draggingItemContent=copyListItems[draggingItemIndex.current];copyListItems.splice(draggingItemIndex.current,1),copyListItems.splice(draggingOverItemIndex.current,0,draggingItemContent),draggingItemIndex.current=draggingOverItemIndex.current,draggingOverItemIndex.current=null,changeLayerPosition(draggingItemContent.id,index)}(0,index)},onDragEnd,onDragOver,draggable:!0},react.createElement("div",null,layer.id),react.createElement("div",null,react.createElement("button",{style:{fontSize:12,opacity:layer.isVisible?1:.5},onClick:function onClick(e){e.stopPropagation(),layer.isVisible?hideLayer(layer.id):showLayer(layer.id)}},layer.isVisible?"hide":"show"),react.createElement("button",{onClick:function onClick(e){e.stopPropagation(),removeLayer(layer.id)}},"remove"),react.createElement("button",{onClick:function onClick(){isolateLayer(layer.id)}},"isolate")))})),react.createElement("button",{onClick:function onClick(){addLayer("layer"+(createdLayerCount+1),layers.length),setCreatedLayerCount(createdLayerCount+1)}},"Add Layer"))),react.createElement("div",{style:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center"}},react.createElement(Dotting.Z,{ref,width:"100%",height:500,brushTool,initLayers:[{id:"layer1",data:(0,dataCreator.n)(100)},{id:"layer2",data:(0,dataCreator.n)(100)},{id:"layer3",data:(0,dataCreator.n)(100)}]}),react.createElement("select",{style:{marginLeft:15,marginTop:10},value:brushTool,onChange:function onChange(e){setBrushTool(e.target.value)}},react.createElement("option",{value:src.G3.DOT},src.G3.DOT),react.createElement("option",{value:src.G3.ERASER},src.G3.ERASER),react.createElement("option",{value:src.G3.PAINT_BUCKET},src.G3.PAINT_BUCKET),react.createElement("option",{value:src.G3.SELECT},src.G3.SELECT)),react.createElement("div",null,["#FF0000","#0000FF","#00FF00","#FF00FF","#00FFFF","#FFFF00","#000000","#FFFFFF"].map((function(color){return react.createElement("div",{key:color,onClick:changeBrushColor.bind(null,color),style:{width:25,height:25,margin:10,border:"1px solid black",backgroundColor:color,display:"inline-block"}})})))))};function _createMdxContent(props){var _components=Object.assign({h1:"h1",h4:"h4",p:"p",h3:"h3",code:"code",strong:"strong",pre:"pre"},(0,dist_esm.ah)(),props.components);return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(esm.h_,{title:"Customization/Layers"}),"\n",(0,jsx_runtime.jsx)("style",{children:"\n  .subheading {\n    --mediumdark: '#999999';\n    font-weight: 900;\n    font-size: 13px;\n    color: #999;\n    letter-spacing: 6px;\n    line-height: 24px;\n    text-transform: uppercase;\n    margin-bottom: 12px;\n    margin-top: 40px;\n    font-family: 'Nunito Sans', 'Helvetica Neue', Helvetica, Arial, sans-serif;\n  }\n\n  .link-list {\n    display: grid;\n    grid-template-columns: 1fr;\n    grid-template-rows: 1fr 1fr;\n    row-gap: 10px;\n  }\n\n  @media (min-width: 620px) {\n    .link-list {\n      row-gap: 20px;\n      column-gap: 20px;\n      grid-template-columns: 1fr 1fr;\n    }\n  }\n\n  @media all and (-ms-high-contrast:none) {\n  .link-list {\n      display: -ms-grid;\n      -ms-grid-columns: 1fr 1fr;\n      -ms-grid-rows: 1fr 1fr;\n    }\n  }\n\n  .link-item {\n    display: block;\n    padding: 20px 30px 20px 15px;\n    border: 1px solid #00000010;\n    border-radius: 5px;\n    transition: background 150ms ease-out, border 150ms ease-out, transform 150ms ease-out;\n    color: #333333;\n    display: flex;\n    align-items: flex-start;\n  }\n\n  .link-item:hover {\n    border-color: #1EA7FD50;\n    transform: translate3d(0, -3px, 0);\n    box-shadow: rgba(0, 0, 0, 0.08) 0 3px 10px 0;\n  }\n\n  .link-item:active {\n    border-color: #1EA7FD;\n    transform: translate3d(0, 0, 0);\n  }\n\n  .link-item strong {\n    font-weight: 700;\n    display: block;\n    margin-bottom: 2px;\n  }\n  \n  .link-item img {\n    height: 40px;\n    width: 40px;\n    margin-right: 15px;\n    flex: none;\n  }\n\n  .link-item span {\n    font-size: 14px;\n    line-height: 20px;\n  }\n\n  .tip {\n    display: inline-block;\n    border-radius: 1em;\n    font-size: 11px;\n    line-height: 12px;\n    font-weight: 700;\n    background: #E7FDD8;\n    color: #66BF3C;\n    padding: 4px 12px;\n    margin-right: 10px;\n    vertical-align: top;\n  }\n\n  .tip-wrapper {\n    font-size: 13px;\n    line-height: 20px;\n    margin-top: 40px;\n    margin-bottom: 40px;\n  }\n\n  .tip-wrapper code {\n    font-size: 12px;\n    display: inline-block;\n  }\n"}),"\n",(0,jsx_runtime.jsx)(_components.h1,{children:"Layer Setup"}),"\n",(0,jsx_runtime.jsx)(_components.h4,{children:"Setting up the layers"}),"\n",(0,jsx_runtime.jsx)(_components.p,{children:"Dotting provides user to have a layer system if needed. To manipulate the layers in Dotting editor, you must add listeners to changes on the layers."}),"\n",(0,jsx_runtime.jsx)(customization_Layers,{}),"\n",(0,jsx_runtime.jsxs)(_components.h3,{children:["To use layers, you must use ",(0,jsx_runtime.jsx)(_components.code,{children:"useLayers"})," hook"]}),"\n",(0,jsx_runtime.jsx)(_components.p,{children:(0,jsx_runtime.jsxs)(_components.strong,{children:["1. If you want to initialize the layers before the editor renders, pass ",(0,jsx_runtime.jsx)(_components.code,{children:"initLayers"})," the adequate data"]})}),"\n",(0,jsx_runtime.jsx)(_components.pre,{children:(0,jsx_runtime.jsx)(_components.code,{className:"language-tsx",children:"export interface DottingProps {\n  //...\n  initLayers?: Array<LayerProps>;\n  //...\n}\n"})}),"\n",(0,jsx_runtime.jsx)(_components.p,{children:"initLayers should be an array of objects with the following properties:"}),"\n",(0,jsx_runtime.jsx)(_components.pre,{children:(0,jsx_runtime.jsx)(_components.code,{className:"language-tsx",children:"export interface LayerProps {\n  id: string;\n  data: Array<Array<PixelModifyItem>>;\n}\n"})}),"\n",(0,jsx_runtime.jsx)(_components.p,{children:"PixelModifyItem is an object with the following properties:"}),"\n",(0,jsx_runtime.jsx)(_components.pre,{children:(0,jsx_runtime.jsx)(_components.code,{className:"language-tsx",children:"export interface PixelModifyItem {\n  rowIndex: number;\n  columnIndex: number;\n  color: string;\n}\n"})}),"\n",(0,jsx_runtime.jsx)(_components.p,{children:"An example of initLayers:"}),"\n",(0,jsx_runtime.jsx)(_components.pre,{children:(0,jsx_runtime.jsx)(_components.code,{className:"language-tsx",children:'const Layers = () => {\n  const CreateEmptySquareData = (\n    size: number,\n  ): Array<Array<PixelModifyItem>> => {\n    const data: Array<Array<PixelModifyItem>> = [];\n    for (let i = 0; i < size; i++) {\n      const row: Array<PixelModifyItem> = [];\n      for (let j = 0; j < size; j++) {\n        row.push({ rowIndex: i, columnIndex: j, color: "" });\n      }\n      data.push(row);\n    }\n    return data;\n  };\n\n  return (\n    <Dotting\n      ref={ref}\n      width={"100%"}\n      height={500}\n      initLayers={[\n        {\n          id: "layer1",\n          data: CreateEmptySquareData(15),\n        },\n        {\n          id: "layer2",\n          data: CreateEmptySquareData(15),\n        },\n        {\n          id: "layer3",\n          data: CreateEmptySquareData(15),\n        },\n      ]}\n    />\n  );\n};\n'})}),"\n",(0,jsx_runtime.jsx)(_components.p,{children:(0,jsx_runtime.jsx)(_components.strong,{children:"2. Manipulating layers with useLayers"})}),"\n",(0,jsx_runtime.jsxs)(_components.p,{children:["To use layers, you must use ",(0,jsx_runtime.jsx)(_components.code,{children:"useLayers"})," hook. This hook returns an object with the following properties:"]}),"\n",(0,jsx_runtime.jsx)(_components.pre,{children:(0,jsx_runtime.jsx)(_components.code,{className:"language-tsx",children:"const {\n  currentLayer,\n  layers,\n  addLayer,\n  removeLayer,\n  changeLayerPosition,\n  showLayer,\n  hideLayer,\n  isolateLayer,\n  showAllLayers,\n  setCurrentLayer,\n  reorderLayersByIds,\n} = useLayers(ref);\n"})}),"\n",(0,jsx_runtime.jsxs)(_components.p,{children:["For a detailed explanation on the ",(0,jsx_runtime.jsx)(_components.code,{children:"useLayers"})," hook, refer to the ",(0,jsx_runtime.jsx)(_components.code,{children:"useLayers"})," section."]}),"\n",(0,jsx_runtime.jsx)("div",{className:"subheading",children:"Resources"}),"\n",(0,jsx_runtime.jsx)("div",{className:"link-list",children:(0,jsx_runtime.jsxs)("a",{className:"link-item",href:"https://github.com/hunkim98/dotting/tree/main/stories/customization/Layers.tsx",target:"_blank",children:[(0,jsx_runtime.jsx)("img",{src:stackalt,alt:"Build"}),(0,jsx_runtime.jsx)("span",{children:(0,jsx_runtime.jsxs)(_components.p,{children:[(0,jsx_runtime.jsx)("strong",{children:"Github Source Code"}),"\nView the source code and contribute to the project!"]})})]})}),"\n",(0,jsx_runtime.jsx)("div",{className:"tip-wrapper"}),"\n",(0,jsx_runtime.jsx)(_components.pre,{children:(0,jsx_runtime.jsx)(_components.code,{})})]})}function MDXContent(){var props=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},MDXLayout=Object.assign({},(0,dist_esm.ah)(),props.components).wrapper;return MDXLayout?(0,jsx_runtime.jsx)(MDXLayout,Object.assign({},props,{children:(0,jsx_runtime.jsx)(_createMdxContent,props)})):_createMdxContent(props)}var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Customization/Layers",includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return react.createElement(esm.aT,{mdxStoryNameToKey,mdxComponentAnnotations:componentMeta},react.createElement(MDXContent,null))}});const Layers_stories=componentMeta;var __namedExportsOrder=["__page"]},"./stories/useBrush.stories.mdx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{__namedExportsOrder:()=>__namedExportsOrder,__page:()=>__page,default:()=>__WEBPACK_DEFAULT_EXPORT__});__webpack_require__("./node_modules/core-js/modules/es.object.assign.js");var react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/index.js"),_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@storybook/addon-docs/dist/esm/index.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/react/jsx-runtime.js"),_mdx_js_react__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@mdx-js/react/dist/esm.js"),_assets_stackalt_svg__WEBPACK_IMPORTED_MODULE_12__=(__webpack_require__("./stories/assets/code-brackets.svg"),__webpack_require__("./stories/assets/colors.svg"),__webpack_require__("./stories/assets/comments.svg"),__webpack_require__("./stories/assets/direction.svg"),__webpack_require__("./stories/assets/flow.svg"),__webpack_require__("./stories/assets/plugin.svg"),__webpack_require__("./stories/assets/repo.svg"),__webpack_require__("./stories/assets/stackalt.svg")),_useBrushComponents__WEBPACK_IMPORTED_MODULE_14__=(__webpack_require__("./src/components/Dotting.tsx"),__webpack_require__("./stories/useBrushComponents/index.ts"));function _createMdxContent(props){var _components=Object.assign({h1:"h1",code:"code",p:"p",h4:"h4",pre:"pre",h3:"h3"},(0,_mdx_js_react__WEBPACK_IMPORTED_MODULE_4__.ah)(),props.components);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_2__.h_,{title:"Hooks/useBrush"}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("style",{children:'\n  .subheading {\n    --mediumdark: \'#999999\';\n    font-weight: 900;\n    font-size: 13px;\n    color: #999;\n    letter-spacing: 6px;\n    line-height: 24px;\n    text-transform: uppercase;\n    margin-bottom: 12px;\n    margin-top: 40px;\n    font-family: \'Nunito Sans\', \'Helvetica Neue\', Helvetica, Arial, sans-serif;\n  }\n\n  .link-list {\n    display: grid;\n    grid-template-columns: 1fr;\n    grid-template-rows: 1fr 1fr;\n    row-gap: 10px;\n  }\n\n  @media (min-width: 620px) {\n    .link-list {\n      row-gap: 20px;\n      column-gap: 20px;\n      grid-template-columns: 1fr 1fr;\n    }\n  }\n\n  @media all and (-ms-high-contrast:none) {\n  .link-list {\n      display: -ms-grid;\n      -ms-grid-columns: 1fr 1fr;\n      -ms-grid-rows: 1fr 1fr;\n    }\n  }\n\n  .link-item {\n    display: block;\n    padding: 20px 30px 20px 15px;\n    border: 1px solid #00000010;\n    border-radius: 5px;\n    transition: background 150ms ease-out, border 150ms ease-out, transform 150ms ease-out;\n    color: #333333;\n    display: flex;\n    align-items: flex-start;\n  }\n\n  .link-item:hover {\n    border-color: #1EA7FD50;\n    transform: translate3d(0, -3px, 0);\n    box-shadow: rgba(0, 0, 0, 0.08) 0 3px 10px 0;\n  }\n\n  .link-item:active {\n    border-color: #1EA7FD;\n    transform: translate3d(0, 0, 0);\n  }\n\n  .link-item strong {\n    font-weight: 700;\n    display: block;\n    margin-bottom: 2px;\n  }\n  \n  .link-item img {\n    height: 40px;\n    width: 40px;\n    margin-right: 15px;\n    flex: none;\n  }\n\n  .link-item span {\n    font-size: 14px;\n    line-height: 20px;\n  }\n\n  .tip {\n    display: inline-block;\n    border-radius: 1em;\n    font-size: 11px;\n    line-height: 12px;\n    font-weight: 700;\n    background: #E7FDD8;\n    color: #66BF3C;\n    padding: 4px 12px;\n    margin-right: 10px;\n    vertical-align: top;\n  }\n\n  .tip-wrapper {\n    font-size: 13px;\n    line-height: 20px;\n    margin-top: 40px;\n    margin-bottom: 40px;\n  }\n\n  .tip-wrapper code {\n    font-size: 12px;\n    display: inline-block;\n  }\n  \ntable {\n  width: 100%;\n  border-collapse: collapse;\n  border: 1px solid #cccccc;\n  margin: 15px auto;\n  margin-bottom: 80px;\n  background: white;\n  color: #333333;\n  font-family: "Nunito Sans",-apple-system,".SFNSText-Regular","San Francisco",BlinkMacSystemFont,"Segoe UI","Helvetica Neue",Helvetica,Arial,sans-serif;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);\n}\n\nthead {\n  border-bottom: 1px solid #cccccc;\n}\n\ntable .css-1p8ieni {\n  margin: 0;\n}\n\nh4 {\n  margin-top: 15px;\n}\n\nth {\n  background: steelblue;\n  height: 54px;\n  width: 25%;\n  font-weight: lighter;\n  text-shadow: 0 1px 0 #38678f;\n  color: white;\n  border: 1px solid black;\n  box-shadow: inset 0px 1px 2px #cccccc;\n  transition: all 0.2s;\n}\ntr {\n  border-bottom: 1px solid #cccccc;\n}\ntr:last-child {\n  border-bottom: 0px;\n}\ntd {\n  border-right: 1px solid #cccccc;\n  padding: 10px;\n  transition: all 0.2s;\n  font-size: 14px;\n}\ntd:first-child {\n  font-size: 12px;\n  font-family: monospace\n\n}\ntd:last-child {\n  border-right: 0px;\n}\ntd.selected {\n  background: #d7e4ef;\n  z-index: ;\n}\ntd input {\n  font-size: 14px;\n  background: none;\n  outline: none;\n  border: 0;\n  display: table-cell;\n  height: 100%;\n  width: 100%;\n}\ntd input:focus {\n  box-shadow: 0 1px 0 steelblue;\n  color: steelblue;\n}\n::-moz-selection {\n  background: steelblue;\n  color: white;\n}\n::selection {\n  background: steelblue;\n  color: white;\n}\n'}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.h1,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"useBrush"})}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)(_components.p,{children:["With ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"useBrush"}),", you can change the brush color and mode."]}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)(_components.h4,{children:["Features provided by ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"useBrush"})]}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)("table",{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("thead",{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)("tr",{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("td",{}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("td",{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("strong",{children:"Description"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("td",{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("strong",{children:"Parameters"})})]})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)("tbody",{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)("tr",{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("td",{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"changeBrushColor(color: string)"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("td",{children:"Allows you to change the brush color"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("td",{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"string"})})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)("tr",{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("td",{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"changeBrushTool(brushTool: BrushTool)"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)("td",{children:["Allows you to change the brush mode to ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"DOT"}),", ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"ERASER"}),", ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"PAINT_BUCKET"}),", ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"SELECT"}),", or ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"NONE"})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)("td",{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.p,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"BrushTool"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.pre,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{className:"language-ts",children:'export enum BrushTool {\n  DOT = "DOT",\n  ERASER = "ERASER",\n  PAINT_BUCKET = "PAINT_BUCKET",\n  SELECT = "SELECT",\n  NONE = "NONE",\n}\n'})})]})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)("tr",{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("td",{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"changeBrushPattern(brushPattern: Array<Array<BRUSH_PATTERN_ELEMENT>>)"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("td",{children:"Allows you to change the brush pattern (the parameter should be a square array)"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)("td",{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.p,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"Array<Array<BRUSH_PATTERN_ELEMENT>>"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.pre,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{className:"language-ts",children:"export enum BRUSH_PATTERN_ELEMENT {\n  EMPTY = 0,\n  FILLED = 1,\n}\n"})})]})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)("tr",{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("td",{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"brushTool"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)("td",{children:["Allows you to know the current brush mode. Variable type is ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"BrushTool"})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("td",{})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)("tr",{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("td",{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"brushColor"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)("td",{children:["Allows you to know the current brush color. Variable type is ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"string"})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("td",{})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)("tr",{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("td",{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"brushPattern"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)("td",{children:["Allows you to know the current brush pattern. Variable type is ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"Array<Array<BRUSH_PATTERN_ELEMENT>>"})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("td",{})]})]})]}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.h3,{children:"Examples"}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)(_components.h4,{children:["1. Change Brush Color Example ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"changeBrushColor(color: string)"})]}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)(_components.p,{children:["With ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"changeBrushColor"})," method, you can change the color of the brush."]}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_useBrushComponents__WEBPACK_IMPORTED_MODULE_14__.tq,{}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)(_components.h4,{children:["2. Change Brush Tool Example ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"changeBrushTool(brushTool: BrushTool)"})]}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)(_components.p,{children:["With ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"changeBrushTool"})," method, you can change the brush tool."]}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_useBrushComponents__WEBPACK_IMPORTED_MODULE_14__.jg,{}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)(_components.h4,{children:["3. Change Brush Pattern Example ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"changeBrushPattern(brushPattern: Array<Array<BRUSH_PATTERN_ELEMENT>>)"})]}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)(_components.p,{children:["With ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"changeBrushPattern"})," method, you can change the brush tool."]}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_useBrushComponents__WEBPACK_IMPORTED_MODULE_14__.lz,{}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("div",{className:"subheading",children:"Example Source Codes"}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("div",{className:"link-list",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)("a",{className:"link-item",href:"https://github.com/hunkim98/dotting/tree/main/stories/useBrushComponents",target:"_blank",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("img",{src:_assets_stackalt_svg__WEBPACK_IMPORTED_MODULE_12__,alt:"Build"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("span",{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)(_components.p,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("strong",{children:"Github Source Code"}),"\nView the source code and contribute to the project!"]})})]})}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("div",{className:"tip-wrapper"}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.pre,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{})})]})}function MDXContent(){var props=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},MDXLayout=Object.assign({},(0,_mdx_js_react__WEBPACK_IMPORTED_MODULE_4__.ah)(),props.components).wrapper;return MDXLayout?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(MDXLayout,Object.assign({},props,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_createMdxContent,props)})):_createMdxContent(props)}var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Hooks/useBrush",includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return react__WEBPACK_IMPORTED_MODULE_1__.createElement(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_2__.aT,{mdxStoryNameToKey,mdxComponentAnnotations:componentMeta},react__WEBPACK_IMPORTED_MODULE_1__.createElement(MDXContent,null))}});const __WEBPACK_DEFAULT_EXPORT__=componentMeta;var __namedExportsOrder=["__page"]},"./stories/useData.stories.mdx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{__namedExportsOrder:()=>__namedExportsOrder,__page:()=>__page,default:()=>useData_stories});__webpack_require__("./node_modules/core-js/modules/es.object.assign.js");var react=__webpack_require__("./node_modules/react/index.js"),esm=__webpack_require__("./node_modules/@storybook/addon-docs/dist/esm/index.js"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),dist_esm=__webpack_require__("./node_modules/@mdx-js/react/dist/esm.js"),stackalt=(__webpack_require__("./stories/assets/code-brackets.svg"),__webpack_require__("./stories/assets/colors.svg"),__webpack_require__("./stories/assets/comments.svg"),__webpack_require__("./stories/assets/direction.svg"),__webpack_require__("./stories/assets/flow.svg"),__webpack_require__("./stories/assets/plugin.svg"),__webpack_require__("./stories/assets/repo.svg"),__webpack_require__("./stories/assets/stackalt.svg")),Dotting=__webpack_require__("./src/components/Dotting.tsx"),slicedToArray=(__webpack_require__("./node_modules/core-js/modules/es.map.js"),__webpack_require__("./node_modules/core-js/modules/es.object.to-string.js"),__webpack_require__("./node_modules/core-js/modules/es.string.iterator.js"),__webpack_require__("./node_modules/core-js/modules/es.array.iterator.js"),__webpack_require__("./node_modules/core-js/modules/web.dom-collections.iterator.js"),__webpack_require__("./node_modules/core-js/modules/es.array.for-each.js"),__webpack_require__("./node_modules/core-js/modules/web.dom-collections.for-each.js"),__webpack_require__("./node_modules/core-js/modules/es.array.from.js"),__webpack_require__("./node_modules/core-js/modules/es.array.map.js"),__webpack_require__("./node_modules/core-js/modules/es.function.bind.js"),__webpack_require__("./node_modules/@babel/runtime/helpers/esm/slicedToArray.js")),useBrush=__webpack_require__("./src/hooks/useBrush.ts"),useData=__webpack_require__("./src/hooks/useData.ts");const useDataComponents_DataInformation=function DataInformation(){var ref=(0,react.useRef)(null),dataArray=(0,useData.Z)(ref).dataArray,changeBrushColor=(0,useBrush.Z)(ref).changeBrushColor,_useState=(0,react.useState)(new Map),_useState2=(0,slicedToArray.Z)(_useState,2),groupData=_useState2[0],setGroupData=_useState2[1];(0,react.useEffect)((function(){var map=new Map;dataArray.forEach((function(row){row.forEach((function(pixel){pixel.color&&(map.has(pixel.color)?map.set(pixel.color,map.get(pixel.color)+1):map.set(pixel.color,1))}))})),setGroupData(map)}),[dataArray]);var entries=(0,react.useMemo)((function(){return Array.from(groupData.entries())}),[groupData]);return react.createElement("div",{style:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center",fontFamily:"'Nunito Sans', 'Helvetica Neue', Helvetica, Arial, sans-serif"}},react.createElement(Dotting.Z,{ref,width:"100%",height:300}),react.createElement("div",null,["#FF0000","#0000FF","#00FF00","#FF00FF","#00FFFF","#FFFF00","#000000","#FFFFFF"].map((function(color){return react.createElement("div",{key:color,onClick:changeBrushColor.bind(null,color),style:{width:25,height:25,margin:10,border:"1px solid black",backgroundColor:color,display:"inline-block"}})}))),0===entries.length&&react.createElement("div",{style:{padding:10}},"Color some pixels to see color groups!"),react.createElement("div",null,entries.map((function(entry){return react.createElement("div",null,react.createElement("span",{style:{marginRight:10,color:entry[0]}},entry[0]),react.createElement("span",null,entry[1]))}))))};function _createMdxContent(props){var _components=Object.assign({h1:"h1",code:"code",p:"p",h4:"h4",pre:"pre",h3:"h3"},(0,dist_esm.ah)(),props.components);return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(esm.h_,{title:"Hooks/useData"}),"\n",(0,jsx_runtime.jsx)("style",{children:'\n  .subheading {\n    --mediumdark: \'#999999\';\n    font-weight: 900;\n    font-size: 13px;\n    color: #999;\n    letter-spacing: 6px;\n    line-height: 24px;\n    text-transform: uppercase;\n    margin-bottom: 12px;\n    margin-top: 40px;\n    font-family: \'Nunito Sans\', \'Helvetica Neue\', Helvetica, Arial, sans-serif;\n  }\n\n  .link-list {\n    display: grid;\n    grid-template-columns: 1fr;\n    grid-template-rows: 1fr 1fr;\n    row-gap: 10px;\n  }\n\n  @media (min-width: 620px) {\n    .link-list {\n      row-gap: 20px;\n      column-gap: 20px;\n      grid-template-columns: 1fr 1fr;\n    }\n  }\n\n  @media all and (-ms-high-contrast:none) {\n  .link-list {\n      display: -ms-grid;\n      -ms-grid-columns: 1fr 1fr;\n      -ms-grid-rows: 1fr 1fr;\n    }\n  }\n\n  .link-item {\n    display: block;\n    padding: 20px 30px 20px 15px;\n    border: 1px solid #00000010;\n    border-radius: 5px;\n    transition: background 150ms ease-out, border 150ms ease-out, transform 150ms ease-out;\n    color: #333333;\n    display: flex;\n    align-items: flex-start;\n  }\n\n  .link-item:hover {\n    border-color: #1EA7FD50;\n    transform: translate3d(0, -3px, 0);\n    box-shadow: rgba(0, 0, 0, 0.08) 0 3px 10px 0;\n  }\n\n  .link-item:active {\n    border-color: #1EA7FD;\n    transform: translate3d(0, 0, 0);\n  }\n\n  .link-item strong {\n    font-weight: 700;\n    display: block;\n    margin-bottom: 2px;\n  }\n  \n  .link-item img {\n    height: 40px;\n    width: 40px;\n    margin-right: 15px;\n    flex: none;\n  }\n\n  .link-item span {\n    font-size: 14px;\n    line-height: 20px;\n  }\n\n  .tip {\n    display: inline-block;\n    border-radius: 1em;\n    font-size: 11px;\n    line-height: 12px;\n    font-weight: 700;\n    background: #E7FDD8;\n    color: #66BF3C;\n    padding: 4px 12px;\n    margin-right: 10px;\n    vertical-align: top;\n  }\n\n  .tip-wrapper {\n    font-size: 13px;\n    line-height: 20px;\n    margin-top: 40px;\n    margin-bottom: 40px;\n  }\n\n  .tip-wrapper code {\n    font-size: 12px;\n    display: inline-block;\n  }\n  \ntable {\n  width: 100%;\n  border-collapse: collapse;\n  border: 1px solid #cccccc;\n  margin: 15px auto;\n  margin-bottom: 80px;\n  background: white;\n  color: #333333;\n  font-family: "Nunito Sans",-apple-system,".SFNSText-Regular","San Francisco",BlinkMacSystemFont,"Segoe UI","Helvetica Neue",Helvetica,Arial,sans-serif;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);\n}\n\nthead {\n  border-bottom: 1px solid #cccccc;\n}\n\ntable .css-1p8ieni {\n  margin: 0;\n}\n\nh4 {\n  margin-top: 15px;\n}\n\nth {\n  background: steelblue;\n  height: 54px;\n  width: 25%;\n  font-weight: lighter;\n  text-shadow: 0 1px 0 #38678f;\n  color: white;\n  border: 1px solid black;\n  box-shadow: inset 0px 1px 2px #cccccc;\n  transition: all 0.2s;\n}\ntr {\n  border-bottom: 1px solid #cccccc;\n}\ntr:last-child {\n  border-bottom: 0px;\n}\ntd {\n  border-right: 1px solid #cccccc;\n  padding: 10px;\n  transition: all 0.2s;\n  font-size: 14px;\n}\ntd:first-child {\n  font-size: 12px;\n  font-family: monospace\n\n}\ntd:last-child {\n  border-right: 0px;\n}\ntd.selected {\n  background: #d7e4ef;\n  z-index: ;\n}\ntd input {\n  font-size: 14px;\n  background: none;\n  outline: none;\n  border: 0;\n  display: table-cell;\n  height: 100%;\n  width: 100%;\n}\ntd input:focus {\n  box-shadow: 0 1px 0 steelblue;\n  color: steelblue;\n}\n::-moz-selection {\n  background: steelblue;\n  color: white;\n}\n::selection {\n  background: steelblue;\n  color: white;\n}\n'}),"\n",(0,jsx_runtime.jsx)(_components.h1,{children:(0,jsx_runtime.jsx)(_components.code,{children:"useData"})}),"\n",(0,jsx_runtime.jsxs)(_components.p,{children:["With ",(0,jsx_runtime.jsx)(_components.code,{children:"useData"}),", you can get the current status of data"]}),"\n",(0,jsx_runtime.jsxs)(_components.h4,{children:["Features provided by ",(0,jsx_runtime.jsx)(_components.code,{children:"useData"})]}),"\n",(0,jsx_runtime.jsxs)("table",{children:[(0,jsx_runtime.jsx)("thead",{children:(0,jsx_runtime.jsxs)("tr",{children:[(0,jsx_runtime.jsx)("td",{}),(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsx)("strong",{children:"Description"})}),(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsx)("strong",{children:"Parameters"})})]})}),(0,jsx_runtime.jsxs)("tbody",{children:[(0,jsx_runtime.jsxs)("tr",{children:[(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsx)(_components.code,{children:"data"})}),(0,jsx_runtime.jsxs)("td",{children:[(0,jsx_runtime.jsxs)(_components.p,{children:["Allows you to know the current pixel data. The variable type is ",(0,jsx_runtime.jsx)(_components.code,{children:"Map<number, Map<number, PixelData>>"})]}),(0,jsx_runtime.jsx)(_components.pre,{children:(0,jsx_runtime.jsx)(_components.code,{className:"language-ts",children:"type PixelData = {\n  color: string;\n};\n"})})]}),(0,jsx_runtime.jsx)("td",{})]}),(0,jsx_runtime.jsxs)("tr",{children:[(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsx)(_components.code,{children:"dataArray"})}),(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsxs)(_components.p,{children:["Allows you to know the 2d array of the pixel data. If you are not fond with Maps, you may use this instead. The variable type is ",(0,jsx_runtime.jsx)(_components.code,{children:"<Array<Array<PixelModifyItem>>>"})]})}),(0,jsx_runtime.jsx)("td",{})]})]})]}),"\n",(0,jsx_runtime.jsx)(_components.h3,{children:"Examples"}),"\n",(0,jsx_runtime.jsxs)(_components.h4,{children:["1. Data Array Example ",(0,jsx_runtime.jsx)(_components.code,{children:"dataArray"})]}),"\n",(0,jsx_runtime.jsxs)(_components.p,{children:["With ",(0,jsx_runtime.jsx)(_components.code,{children:"dataArray"})," method, you can check the current status of the canvas"]}),"\n",(0,jsx_runtime.jsx)(useDataComponents_DataInformation,{}),"\n",(0,jsx_runtime.jsx)("div",{className:"subheading",children:"Example Source Codes"}),"\n",(0,jsx_runtime.jsx)("div",{className:"link-list",children:(0,jsx_runtime.jsxs)("a",{className:"link-item",href:"https://github.com/hunkim98/dotting/tree/main/stories/useDataComponents",target:"_blank",children:[(0,jsx_runtime.jsx)("img",{src:stackalt,alt:"Build"}),(0,jsx_runtime.jsx)("span",{children:(0,jsx_runtime.jsxs)(_components.p,{children:[(0,jsx_runtime.jsx)("strong",{children:"Github Source Code"}),"\nView the source code and contribute to the project!"]})})]})}),"\n",(0,jsx_runtime.jsx)("div",{className:"tip-wrapper"}),"\n",(0,jsx_runtime.jsx)(_components.pre,{children:(0,jsx_runtime.jsx)(_components.code,{})})]})}function MDXContent(){var props=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},MDXLayout=Object.assign({},(0,dist_esm.ah)(),props.components).wrapper;return MDXLayout?(0,jsx_runtime.jsx)(MDXLayout,Object.assign({},props,{children:(0,jsx_runtime.jsx)(_createMdxContent,props)})):_createMdxContent(props)}var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Hooks/useData",includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return react.createElement(esm.aT,{mdxStoryNameToKey,mdxComponentAnnotations:componentMeta},react.createElement(MDXContent,null))}});const useData_stories=componentMeta;var __namedExportsOrder=["__page"]},"./stories/useDotting.stories.mdx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{__namedExportsOrder:()=>__namedExportsOrder,__page:()=>__page,default:()=>__WEBPACK_DEFAULT_EXPORT__});__webpack_require__("./node_modules/core-js/modules/es.object.assign.js");var react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/index.js"),_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@storybook/addon-docs/dist/esm/index.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/react/jsx-runtime.js"),_mdx_js_react__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@mdx-js/react/dist/esm.js"),_assets_stackalt_svg__WEBPACK_IMPORTED_MODULE_12__=(__webpack_require__("./stories/assets/code-brackets.svg"),__webpack_require__("./stories/assets/colors.svg"),__webpack_require__("./stories/assets/comments.svg"),__webpack_require__("./stories/assets/direction.svg"),__webpack_require__("./stories/assets/flow.svg"),__webpack_require__("./stories/assets/plugin.svg"),__webpack_require__("./stories/assets/repo.svg"),__webpack_require__("./stories/assets/stackalt.svg")),_useDottingComponents__WEBPACK_IMPORTED_MODULE_14__=(__webpack_require__("./src/components/Dotting.tsx"),__webpack_require__("./stories/useDottingComponents/index.ts"));function _createMdxContent(props){var _components=Object.assign({h1:"h1",code:"code",p:"p",h4:"h4",h3:"h3",pre:"pre"},(0,_mdx_js_react__WEBPACK_IMPORTED_MODULE_4__.ah)(),props.components);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_2__.h_,{title:"Hooks/useDotting"}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("style",{children:'\n  .subheading {\n    --mediumdark: \'#999999\';\n    font-weight: 900;\n    font-size: 13px;\n    color: #999;\n    letter-spacing: 6px;\n    line-height: 24px;\n    text-transform: uppercase;\n    margin-bottom: 12px;\n    margin-top: 40px;\n    font-family: \'Nunito Sans\', \'Helvetica Neue\', Helvetica, Arial, sans-serif;\n  }\n\n  .link-list {\n    display: grid;\n    grid-template-columns: 1fr;\n    grid-template-rows: 1fr 1fr;\n    row-gap: 10px;\n  }\n\n  @media (min-width: 620px) {\n    .link-list {\n      row-gap: 20px;\n      column-gap: 20px;\n      grid-template-columns: 1fr 1fr;\n    }\n  }\n\n  @media all and (-ms-high-contrast:none) {\n  .link-list {\n      display: -ms-grid;\n      -ms-grid-columns: 1fr 1fr;\n      -ms-grid-rows: 1fr 1fr;\n    }\n  }\n\n  .link-item {\n    display: block;\n    padding: 20px 30px 20px 15px;\n    border: 1px solid #00000010;\n    border-radius: 5px;\n    transition: background 150ms ease-out, border 150ms ease-out, transform 150ms ease-out;\n    color: #333333;\n    display: flex;\n    align-items: flex-start;\n  }\n\n  .link-item:hover {\n    border-color: #1EA7FD50;\n    transform: translate3d(0, -3px, 0);\n    box-shadow: rgba(0, 0, 0, 0.08) 0 3px 10px 0;\n  }\n\n  .link-item:active {\n    border-color: #1EA7FD;\n    transform: translate3d(0, 0, 0);\n  }\n\n  .link-item strong {\n    font-weight: 700;\n    display: block;\n    margin-bottom: 2px;\n  }\n  \n  .link-item img {\n    height: 40px;\n    width: 40px;\n    margin-right: 15px;\n    flex: none;\n  }\n\n  .link-item span {\n    font-size: 14px;\n    line-height: 20px;\n  }\n\n  .tip {\n    display: inline-block;\n    border-radius: 1em;\n    font-size: 11px;\n    line-height: 12px;\n    font-weight: 700;\n    background: #E7FDD8;\n    color: #66BF3C;\n    padding: 4px 12px;\n    margin-right: 10px;\n    vertical-align: top;\n  }\n\n  .tip-wrapper {\n    font-size: 13px;\n    line-height: 20px;\n    margin-top: 40px;\n    margin-bottom: 40px;\n  }\n\n  .tip-wrapper code {\n    font-size: 12px;\n    display: inline-block;\n  }\n  \ntable {\n  width: 100%;\n  border-collapse: collapse;\n  border: 1px solid #cccccc;\n  margin: 15px auto;\n  margin-bottom: 80px;\n  background: white;\n  color: #333333;\n  font-family: "Nunito Sans",-apple-system,".SFNSText-Regular","San Francisco",BlinkMacSystemFont,"Segoe UI","Helvetica Neue",Helvetica,Arial,sans-serif;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);\n}\n\nthead {\n  border-bottom: 1px solid #cccccc;\n}\n\ntable .css-1p8ieni {\n  margin: 0;\n}\n\nh4 {\n  margin-top: 15px;\n}\n\nth {\n  background: steelblue;\n  height: 54px;\n  width: 25%;\n  font-weight: lighter;\n  text-shadow: 0 1px 0 #38678f;\n  color: white;\n  border: 1px solid black;\n  box-shadow: inset 0px 1px 2px #cccccc;\n  transition: all 0.2s;\n}\ntr {\n  border-bottom: 1px solid #cccccc;\n}\ntr:last-child {\n  border-bottom: 0px;\n}\ntd {\n  border-right: 1px solid #cccccc;\n  padding: 10px;\n  transition: all 0.2s;\n  font-size: 14px;\n}\ntd:first-child {\n  font-size: 12px;\n  font-family: monospace\n\n}\ntd:last-child {\n  border-right: 0px;\n}\ntd.selected {\n  background: #d7e4ef;\n  z-index: ;\n}\ntd input {\n  font-size: 14px;\n  background: none;\n  outline: none;\n  border: 0;\n  display: table-cell;\n  height: 100%;\n  width: 100%;\n}\ntd input:focus {\n  box-shadow: 0 1px 0 steelblue;\n  color: steelblue;\n}\n::-moz-selection {\n  background: steelblue;\n  color: white;\n}\n::selection {\n  background: steelblue;\n  color: white;\n}\n'}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.h1,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"useDotting"})}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)(_components.p,{children:["With ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"useDotting"}),", you can manipulate the ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"Dotting"})," canvas directly.\nYou can color pixels, change grid size, set data, and so on."]}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)(_components.h4,{children:["Callbacks provided by ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"useDotting"})]}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)("table",{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("thead",{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)("tr",{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("td",{}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("td",{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("strong",{children:"Description"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("td",{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("strong",{children:"Parameters"})})]})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)("tbody",{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)("tr",{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("td",{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"downloadImage"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("td",{children:"Allows you to download the pixel image"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("td",{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)(_components.p,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"ImageDownloadOptions"})," For more information about the parameters, please refer to\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("u",{onClick:function onClick(){var el=document.getElementById("section1");el&&el.scrollIntoView({behavior:"smooth"})},style:{cursor:"pointer"},children:"section 1"}),"."]})})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)("tr",{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("td",{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"clear"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("td",{children:"Allows you to clear the canvas"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("td",{})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)("tr",{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("td",{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"colorPixels"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("td",{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.p,{children:"Allows you to color pixels on specific indices. If the index provided is\nnot in the grid, the grid first extends its grid and then colors it"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("td",{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)(_components.p,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"Array<PixelModifyItem>"}),". For more information about the type, please refer to\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("u",{onClick:function onClick(){var el=document.getElementById("section2");el&&el.scrollIntoView({behavior:"smooth"})},style:{cursor:"pointer"},children:"section 2"}),"."]})})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)("tr",{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("td",{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"erasePixels"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("td",{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.p,{children:"Allows you to erase pixels on specific indices. If the index provided is\nnot in the grid, that data is ignored"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("td",{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"Array<{rowIndex: number; columnIndex: number}>"})})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)("tr",{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("td",{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"setIndicatorPixels"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("td",{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.p,{children:"Allows you to set the indicator pixels. If the index provided is not in\nthe grid, that data is ignored"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("td",{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)(_components.p,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"Array<PixelModifyItem>"})," For more information about the type, please refer to\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("u",{onClick:function onClick(){var el=document.getElementById("section5");el&&el.scrollIntoView({behavior:"smooth"})},style:{cursor:"pointer"},children:"section 5"}),"."]})})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)("tr",{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("td",{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"undo"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("td",{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.p,{children:"Allows you to undo the last action"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("td",{})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)("tr",{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("td",{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"redo"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("td",{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.p,{children:"Allows you to redo the last action"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("td",{})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)("tr",{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("td",{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"setData"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("td",{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.p,{children:"Allows you to set the data of the pixel canvas. (The 2d array should be a square array)"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("td",{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)(_components.p,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"Array<PixelModifyItem>"})," For more information about the type, please refer to\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("u",{onClick:function onClick(){var el=document.getElementById("section7");el&&el.scrollIntoView({behavior:"smooth"})},style:{cursor:"pointer"},children:"section 7"}),"."]})})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)("tr",{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("td",{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"addGridIndices"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("td",{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.p,{children:"Allows you to add grid indices to the grid."})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("td",{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)(_components.p,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"AddGridIndicesParams"}),". For more information about the type, please refer to\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("u",{onClick:function onClick(){var el=document.getElementById("section3");el&&el.scrollIntoView({behavior:"smooth"})},style:{cursor:"pointer"},children:"section 3"}),"."]})})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)("tr",{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("td",{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"deleteGridIndices"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("td",{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.p,{children:"Allows you to delete grid indices to the grid."})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("td",{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)(_components.p,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"DeleteGridIndicesParams"}),". For more information about the type, please refer to\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("u",{onClick:function onClick(){var el=document.getElementById("section3");el&&el.scrollIntoView({behavior:"smooth"})},style:{cursor:"pointer"},children:"section 3"}),"."]})})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)("tr",{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("td",{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"setLayers"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("td",{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)(_components.p,{children:["Allows you to set layers. You must provide an array of ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"LayerProps"})," to this method."]})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("td",{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)(_components.p,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"Array<LayerProps>"}),". For more information about the type, Please refer to\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("u",{onClick:function onClick(){var el=document.getElementById("section8");el&&el.scrollIntoView({behavior:"smooth"})},style:{cursor:"pointer"},children:"section 8"}),"."]})})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)("tr",{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("td",{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"getBackgroundCanvas"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("td",{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.p,{children:"Returns a customizable background canvas that a user can manipulate"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("td",{})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)("tr",{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("td",{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"getForegroundCanvas"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("td",{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.p,{children:"Returns a customizable foreground canvas that a user can manipulate"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("td",{})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)("tr",{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("td",{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"convertWorldPosToCanvasOffset"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("td",{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.p,{children:"Returns the canvas offset for the given world position. The left top corner world position of canvas is (0, 0)."})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("td",{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)(_components.p,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"x"}),": number, ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"y"}),": number"]})})]})]})]}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.h3,{children:"Examples"}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("div",{id:"section1"}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)(_components.h4,{children:["1. Download Image Example ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"downloadImage"})]}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)(_components.p,{children:["With ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"downloadImage(options?: ImageDownloadOptions)"})," method, you can download the image of the grid. The parameter that you can pass to the callback is ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"ImageDownloadOptions"}),".\nThe ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"ImageDownloadOptions"})," type is defined as follows:"]}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.pre,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{className:"language-ts",children:'export interface ImageDownloadOptions {\n  type: "png" | "svg";\n  isGridVisible?: boolean;\n}\n'})}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_useDottingComponents__WEBPACK_IMPORTED_MODULE_14__.sQ,{}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("div",{id:"section2"}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)(_components.h4,{children:["2. Change Pixel Color Example ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"colorPixels"}),", ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"erasePixels"})]}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)(_components.p,{children:["With ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"colorPixels(data: PixelModifyData)"})," method, you can change the color of specific pixels.\nThe ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"PixelModifyData"})," type is defined as follows:"]}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.pre,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{className:"language-ts",children:"export type PixelModifyData = Array<PixelModifyItem>;\n\nexport interface PixelModifyItem {\n  rowIndex: number;\n  columnIndex: number;\n  color: string;\n}\n"})}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)(_components.p,{children:["By passing an array of ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"PixelModifyItem"})," you are able to color the pixels.\nIf the rowIndex and columnIndex of the pixel is not in the grid, the grid\nfirst extends its grid and then colors it."]}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)(_components.p,{children:["You can also erase pixels using ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"erasePixels"})," method. The ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"erasePixels(data: Array<{rowIndex: number; columnIndex: number}>)"})," method\ntakes an array of ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"{rowIndex: number; columnIndex: number}"})," as a parameter. If the rowIndex and\ncolumnIndex of the pixel is not in the grid, that data is ignored."]}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_useDottingComponents__WEBPACK_IMPORTED_MODULE_14__.aF,{}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("div",{id:"section3"}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)(_components.h4,{children:["3. Grid Change Example ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"addGridIndices"}),",",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"deleteGridIndices"})]}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)(_components.p,{children:["With ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"addGridIndices(params: AddGridIndicesParams)"})," method, you can add grid indices to the grid.\nThe ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"AddGridIndicesParams"})," type is defined as follows:"]}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.pre,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{className:"language-ts",children:"export type AddGridIndicesParams = {\n  rowIndices: Array<number>;\n  columnIndices: Array<number>;\n  data?: Array<PixelModifyItem>;\n  layerId?: string;\n  isLocalChange?: boolean;\n};\n"})}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)(_components.p,{children:["By passing an array of ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"rowIndices"})," and ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"columnIndices"})," you are able to add grid indices to the grid."]}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)(_components.p,{children:["With ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"deleteGridIndices(params: DeleteGridIndicesParams)"})," method, you can delete grid indices to the grid.\nThe ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"DeleteGridIndicesParams"})," type is defined as follows:"]}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.pre,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{className:"language-ts",children:"export type DeleteGridIndicesParams = {\n  rowIndices: Array<number>;\n  columnIndices: Array<number>;\n  layerId?: string;\n  isLocalChange?: boolean;\n};\n"})}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_useDottingComponents__WEBPACK_IMPORTED_MODULE_14__.U6,{}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("div",{id:"section4"}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)(_components.h4,{children:["4. Clear Example ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"clear"})]}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)(_components.p,{children:["With ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"clear()"})," method, you can clear all the pixels in the grid."]}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_useDottingComponents__WEBPACK_IMPORTED_MODULE_14__.UZ,{}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("div",{id:"section5"}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)(_components.h4,{children:["5. Set Indicator Pixels ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"setIndicatorPixels"})]}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)(_components.p,{children:["With ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"setIndicatorPixels(data: Array<PixelModifyItem>)"})," method, you can set the indicator pixels. The indicator pixels are\nthe pixels that are shwon as indicators in the grid. Their opacity is lower than the real pixel data.\nThey do not affect the data of the grid."]}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)(_components.p,{children:["By the way, if you want to initially have the indicator pixels before the canvas mounts,\nyou need to pass the ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"initIndicatorData"})," prop to the ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"Dotting"})," component.\nThe data type of the ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"initIndicatorData"})," is the ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"Array<PixelModifyItem>"}),"."]}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.p,{children:"PixelModifyItem is defined as follows:"}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.pre,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{className:"language-ts",children:"export interface PixelModifyItem {\n  rowIndex: number;\n  columnIndex: number;\n  color: string;\n}\n"})}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_useDottingComponents__WEBPACK_IMPORTED_MODULE_14__.Z_,{}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("div",{id:"section6"}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)(_components.h4,{children:["6. Undo and Redo Example ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"undo"}),", ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"redo"})]}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)(_components.p,{children:["With ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"undo()"})," and ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"redo()"})," methods, you can undo and redo the last action."]}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_useDottingComponents__WEBPACK_IMPORTED_MODULE_14__.QA,{}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("div",{id:"section7"}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)(_components.h4,{children:["7. SetData Example ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"setData"})]}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)(_components.p,{children:["With ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"setData(data: Array<Array<PixelModifyItem>>)"}),", you can set the data of the pixel canvas. You must pass a 2d array of ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"PixelModifyItem"})," to this method.\nThe type of ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"PixelModifyItem"})," is defined as follows:"]}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.pre,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{className:"language-ts",children:"export interface PixelModifyItem {\n  rowIndex: number;\n  columnIndex: number;\n  color: string;\n}\n"})}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.p,{children:"The 2d array should be a square array."}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_useDottingComponents__WEBPACK_IMPORTED_MODULE_14__.P$,{}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("div",{id:"section8"}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)(_components.h4,{children:["8. SetLayers Example ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"setLayers"})]}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)(_components.p,{children:["With ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"setLayers(data: Array<LayerProps>)"}),", you can set the layers of the pixel canvas. You must pass an array of ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"LayerProps"})," to this method.\nThe ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"LayerProps"})," type is defined as follows:"]}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.pre,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{className:"language-ts",children:"export interface LayerProps {\n  id: string;\n  data: Array<Array<PixelModifyItem>>;\n}\n"})}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)(_components.p,{children:["By passing an array of ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"LayerProps"})," you are able to set the layers of the pixel canvas.\nThe type of ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{children:"PixelModifyItem"})," is defined as follows:"]}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.pre,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{className:"language-ts",children:"export interface PixelModifyItem {\n  rowIndex: number;\n  columnIndex: number;\n  color: string;\n}\n"})}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_useDottingComponents__WEBPACK_IMPORTED_MODULE_14__.$x,{}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("div",{className:"subheading",children:"Example Source Codes"}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("div",{className:"link-list",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)("a",{className:"link-item",href:"https://github.com/hunkim98/dotting/tree/main/stories/useDottingComponents",target:"_blank",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("img",{src:_assets_stackalt_svg__WEBPACK_IMPORTED_MODULE_12__,alt:"Build"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("span",{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)(_components.p,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("strong",{children:"Github Source Code"}),"\nView the source code and contribute to the project!"]})})]})}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("div",{className:"tip-wrapper"}),"\n",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.pre,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components.code,{})})]})}function MDXContent(){var props=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},MDXLayout=Object.assign({},(0,_mdx_js_react__WEBPACK_IMPORTED_MODULE_4__.ah)(),props.components).wrapper;return MDXLayout?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(MDXLayout,Object.assign({},props,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_createMdxContent,props)})):_createMdxContent(props)}var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Hooks/useDotting",includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return react__WEBPACK_IMPORTED_MODULE_1__.createElement(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_2__.aT,{mdxStoryNameToKey,mdxComponentAnnotations:componentMeta},react__WEBPACK_IMPORTED_MODULE_1__.createElement(MDXContent,null))}});const __WEBPACK_DEFAULT_EXPORT__=componentMeta;var __namedExportsOrder=["__page"]},"./stories/useGrids.stories.mdx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{__namedExportsOrder:()=>__namedExportsOrder,__page:()=>__page,default:()=>useGrids_stories});__webpack_require__("./node_modules/core-js/modules/es.object.assign.js");var react=__webpack_require__("./node_modules/react/index.js"),esm=__webpack_require__("./node_modules/@storybook/addon-docs/dist/esm/index.js"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),dist_esm=__webpack_require__("./node_modules/@mdx-js/react/dist/esm.js"),stackalt=(__webpack_require__("./stories/assets/code-brackets.svg"),__webpack_require__("./stories/assets/colors.svg"),__webpack_require__("./stories/assets/comments.svg"),__webpack_require__("./stories/assets/direction.svg"),__webpack_require__("./stories/assets/flow.svg"),__webpack_require__("./stories/assets/plugin.svg"),__webpack_require__("./stories/assets/repo.svg"),__webpack_require__("./stories/assets/stackalt.svg")),Dotting=__webpack_require__("./src/components/Dotting.tsx"),useGrids=(__webpack_require__("./stories/useBrushComponents/index.ts"),__webpack_require__("./src/hooks/useGrids.ts"));const useGridComponents_GridInformation=function GridInformation(){var ref=(0,react.useRef)(null),_useGrids=(0,useGrids.Z)(ref),dimensions=_useGrids.dimensions,indices=_useGrids.indices;return react.createElement("div",{style:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center",fontFamily:"'Nunito Sans', 'Helvetica Neue', Helvetica, Arial, sans-serif"}},react.createElement(Dotting.Z,{ref,width:"100%",height:300}),react.createElement("div",null,"column count: ",dimensions.columnCount),react.createElement("div",null,"row count: ",dimensions.rowCount),react.createElement("div",null,"top row index: ",indices.topRowIndex),react.createElement("div",null,"left column index: ",indices.leftColumnIndex),react.createElement("div",null,"bottom row index: ",indices.bottomRowIndex),react.createElement("div",null,"right column index: ",indices.rightColumnIndex))};function _createMdxContent(props){var _components=Object.assign({h1:"h1",code:"code",p:"p",h4:"h4",h3:"h3",pre:"pre"},(0,dist_esm.ah)(),props.components);return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(esm.h_,{title:"Hooks/useGrids"}),"\n",(0,jsx_runtime.jsx)("style",{children:'\n  .subheading {\n    --mediumdark: \'#999999\';\n    font-weight: 900;\n    font-size: 13px;\n    color: #999;\n    letter-spacing: 6px;\n    line-height: 24px;\n    text-transform: uppercase;\n    margin-bottom: 12px;\n    margin-top: 40px;\n    font-family: \'Nunito Sans\', \'Helvetica Neue\', Helvetica, Arial, sans-serif;\n  }\n\n  .link-list {\n    display: grid;\n    grid-template-columns: 1fr;\n    grid-template-rows: 1fr 1fr;\n    row-gap: 10px;\n  }\n\n  @media (min-width: 620px) {\n    .link-list {\n      row-gap: 20px;\n      column-gap: 20px;\n      grid-template-columns: 1fr 1fr;\n    }\n  }\n\n  @media all and (-ms-high-contrast:none) {\n  .link-list {\n      display: -ms-grid;\n      -ms-grid-columns: 1fr 1fr;\n      -ms-grid-rows: 1fr 1fr;\n    }\n  }\n\n  .link-item {\n    display: block;\n    padding: 20px 30px 20px 15px;\n    border: 1px solid #00000010;\n    border-radius: 5px;\n    transition: background 150ms ease-out, border 150ms ease-out, transform 150ms ease-out;\n    color: #333333;\n    display: flex;\n    align-items: flex-start;\n  }\n\n  .link-item:hover {\n    border-color: #1EA7FD50;\n    transform: translate3d(0, -3px, 0);\n    box-shadow: rgba(0, 0, 0, 0.08) 0 3px 10px 0;\n  }\n\n  .link-item:active {\n    border-color: #1EA7FD;\n    transform: translate3d(0, 0, 0);\n  }\n\n  .link-item strong {\n    font-weight: 700;\n    display: block;\n    margin-bottom: 2px;\n  }\n  \n  .link-item img {\n    height: 40px;\n    width: 40px;\n    margin-right: 15px;\n    flex: none;\n  }\n\n  .link-item span {\n    font-size: 14px;\n    line-height: 20px;\n  }\n\n  .tip {\n    display: inline-block;\n    border-radius: 1em;\n    font-size: 11px;\n    line-height: 12px;\n    font-weight: 700;\n    background: #E7FDD8;\n    color: #66BF3C;\n    padding: 4px 12px;\n    margin-right: 10px;\n    vertical-align: top;\n  }\n\n  .tip-wrapper {\n    font-size: 13px;\n    line-height: 20px;\n    margin-top: 40px;\n    margin-bottom: 40px;\n  }\n\n  .tip-wrapper code {\n    font-size: 12px;\n    display: inline-block;\n  }\n  \ntable {\n  width: 100%;\n  border-collapse: collapse;\n  border: 1px solid #cccccc;\n  margin: 15px auto;\n  margin-bottom: 80px;\n  background: white;\n  color: #333333;\n  font-family: "Nunito Sans",-apple-system,".SFNSText-Regular","San Francisco",BlinkMacSystemFont,"Segoe UI","Helvetica Neue",Helvetica,Arial,sans-serif;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);\n}\n\nthead {\n  border-bottom: 1px solid #cccccc;\n}\n\ntable .css-1p8ieni {\n  margin: 0;\n}\n\nh4 {\n  margin-top: 15px;\n}\n\nth {\n  background: steelblue;\n  height: 54px;\n  width: 25%;\n  font-weight: lighter;\n  text-shadow: 0 1px 0 #38678f;\n  color: white;\n  border: 1px solid black;\n  box-shadow: inset 0px 1px 2px #cccccc;\n  transition: all 0.2s;\n}\ntr {\n  border-bottom: 1px solid #cccccc;\n}\ntr:last-child {\n  border-bottom: 0px;\n}\ntd {\n  border-right: 1px solid #cccccc;\n  padding: 10px;\n  transition: all 0.2s;\n  font-size: 14px;\n}\ntd:first-child {\n  font-size: 12px;\n  font-family: monospace\n\n}\ntd:last-child {\n  border-right: 0px;\n}\ntd.selected {\n  background: #d7e4ef;\n  z-index: ;\n}\ntd input {\n  font-size: 14px;\n  background: none;\n  outline: none;\n  border: 0;\n  display: table-cell;\n  height: 100%;\n  width: 100%;\n}\ntd input:focus {\n  box-shadow: 0 1px 0 steelblue;\n  color: steelblue;\n}\n::-moz-selection {\n  background: steelblue;\n  color: white;\n}\n::selection {\n  background: steelblue;\n  color: white;\n}\n'}),"\n",(0,jsx_runtime.jsx)(_components.h1,{children:(0,jsx_runtime.jsx)(_components.code,{children:"useGrids"})}),"\n",(0,jsx_runtime.jsxs)(_components.p,{children:["With ",(0,jsx_runtime.jsx)(_components.code,{children:"useGrids"}),", you can get information about the the canvas columns and rows.\nYou also get information about the indices of the top row, left column, bottom row, and the right column."]}),"\n",(0,jsx_runtime.jsxs)(_components.h4,{children:["Features provided by ",(0,jsx_runtime.jsx)(_components.code,{children:"useGrids"})]}),"\n",(0,jsx_runtime.jsxs)("table",{children:[(0,jsx_runtime.jsx)("thead",{children:(0,jsx_runtime.jsxs)("tr",{children:[(0,jsx_runtime.jsx)("td",{}),(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsx)("strong",{children:"Description"})}),(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsx)("strong",{children:"Parameters"})})]})}),(0,jsx_runtime.jsxs)("tbody",{children:[(0,jsx_runtime.jsxs)("tr",{children:[(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsx)(_components.code,{children:"dimensions"})}),(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsxs)(_components.p,{children:["Allows you to know the ",(0,jsx_runtime.jsx)(_components.code,{children:"columnCount"})," and ",(0,jsx_runtime.jsx)(_components.code,{children:"rowCount"})," of the current grid"]})}),(0,jsx_runtime.jsx)("td",{})]}),(0,jsx_runtime.jsxs)("tr",{children:[(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsx)(_components.code,{children:"indices"})}),(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsxs)(_components.p,{children:["Allows you to know the ",(0,jsx_runtime.jsx)(_components.code,{children:"topRowIndex"}),", ",(0,jsx_runtime.jsx)(_components.code,{children:"bottomRowIndex"}),",\n",(0,jsx_runtime.jsx)(_components.code,{children:"leftColumnIndex"}),", and ",(0,jsx_runtime.jsx)(_components.code,{children:"rightColumnIndex"})," of the grids. This is useful\nwhen you want to implement ",(0,jsx_runtime.jsx)(_components.code,{children:"colorPixels"})," method provided by ",(0,jsx_runtime.jsx)(_components.code,{children:"useDotting"}),"\nhook."]})}),(0,jsx_runtime.jsx)("td",{})]})]})]}),"\n",(0,jsx_runtime.jsx)(_components.h3,{children:"Examples"}),"\n",(0,jsx_runtime.jsxs)(_components.h4,{children:["1. Grid Information Example ",(0,jsx_runtime.jsx)(_components.code,{children:"dimensions"}),", ",(0,jsx_runtime.jsx)(_components.code,{children:"indices"})]}),"\n",(0,jsx_runtime.jsxs)(_components.p,{children:["With ",(0,jsx_runtime.jsx)(_components.code,{children:"dimensions"})," and ",(0,jsx_runtime.jsx)(_components.code,{children:"indices"}),", you can get the information about the current grid."]}),"\n",(0,jsx_runtime.jsx)(useGridComponents_GridInformation,{}),"\n",(0,jsx_runtime.jsx)("div",{className:"subheading",children:"Example Source Codes"}),"\n",(0,jsx_runtime.jsx)("div",{className:"link-list",children:(0,jsx_runtime.jsxs)("a",{className:"link-item",href:"https://github.com/hunkim98/dotting/tree/main/stories/useGridComponents",target:"_blank",children:[(0,jsx_runtime.jsx)("img",{src:stackalt,alt:"Build"}),(0,jsx_runtime.jsx)("span",{children:(0,jsx_runtime.jsxs)(_components.p,{children:[(0,jsx_runtime.jsx)("strong",{children:"Github Source Code"}),"\nView the source code and contribute to the project!"]})})]})}),"\n",(0,jsx_runtime.jsx)("div",{className:"tip-wrapper"}),"\n",(0,jsx_runtime.jsx)(_components.pre,{children:(0,jsx_runtime.jsx)(_components.code,{})})]})}function MDXContent(){var props=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},MDXLayout=Object.assign({},(0,dist_esm.ah)(),props.components).wrapper;return MDXLayout?(0,jsx_runtime.jsx)(MDXLayout,Object.assign({},props,{children:(0,jsx_runtime.jsx)(_createMdxContent,props)})):_createMdxContent(props)}var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Hooks/useGrids",includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return react.createElement(esm.aT,{mdxStoryNameToKey,mdxComponentAnnotations:componentMeta},react.createElement(MDXContent,null))}});const useGrids_stories=componentMeta;var __namedExportsOrder=["__page"]},"./stories/useHandlers.stories.mdx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{__namedExportsOrder:()=>__namedExportsOrder,__page:()=>__page,default:()=>useHandlers_stories});__webpack_require__("./node_modules/core-js/modules/es.object.assign.js");var react=__webpack_require__("./node_modules/react/index.js"),esm=__webpack_require__("./node_modules/@storybook/addon-docs/dist/esm/index.js"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),dist_esm=__webpack_require__("./node_modules/@mdx-js/react/dist/esm.js"),stackalt=(__webpack_require__("./stories/assets/code-brackets.svg"),__webpack_require__("./stories/assets/colors.svg"),__webpack_require__("./stories/assets/comments.svg"),__webpack_require__("./stories/assets/direction.svg"),__webpack_require__("./stories/assets/flow.svg"),__webpack_require__("./stories/assets/plugin.svg"),__webpack_require__("./stories/assets/repo.svg"),__webpack_require__("./stories/assets/stackalt.svg")),Dotting=__webpack_require__("./src/components/Dotting.tsx"),slicedToArray=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),useHandlers=__webpack_require__("./src/hooks/useHandlers.ts");const useHandlersComponents_CanvasElementEvents=function CanvasElementEvents(){var ref=(0,react.useRef)(null),_useHandlers=(0,useHandlers.Z)(ref),addCanvasElementEventListener=_useHandlers.addCanvasElementEventListener,removeCanvasElementEventListener=_useHandlers.removeCanvasElementEventListener,_useState=(0,react.useState)(!1),_useState2=(0,slicedToArray.Z)(_useState,2),isMouseDown=_useState2[0],setIsMouseDown=_useState2[1];return(0,react.useEffect)((function(){var handleMouseDown=function handleMouseDown(){setIsMouseDown(!0)},handleMouseUp=function handleMouseUp(){setIsMouseDown(!1)};return addCanvasElementEventListener("mousedown",handleMouseDown),addCanvasElementEventListener("mouseup",handleMouseUp),function(){removeCanvasElementEventListener("mousedown",handleMouseDown),removeCanvasElementEventListener("mouseup",handleMouseUp)}}),[]),react.createElement("div",{style:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center",fontFamily:"'Nunito Sans', 'Helvetica Neue', Helvetica, Arial, sans-serif"}},react.createElement(Dotting.Z,{ref,width:"100%",height:300}),react.createElement("div",{style:{marginTop:25,display:"flex",alignItems:"center",flexDirection:"column",marginBottom:50}},react.createElement("strong",null,"Is Mouse Down?"),react.createElement("div",null,isMouseDown?"Yes":"No")))};const useHandlersComponents_CanvasInfoChangeListener=function CanvasInfoChangeListener(){var ref=(0,react.useRef)(null),_useHandlers=(0,useHandlers.Z)(ref),addCanvasInfoChangeEventListener=_useHandlers.addCanvasInfoChangeEventListener,removeCanvasInfoChangeEventListener=_useHandlers.removeCanvasInfoChangeEventListener,_useState=(0,react.useState)(null),_useState2=(0,slicedToArray.Z)(_useState,2),canvasPanZoom=_useState2[0],setCanvasPanZoom=_useState2[1],_useState3=(0,react.useState)(0),_useState4=(0,slicedToArray.Z)(_useState3,2),setGridSquareSize=(_useState4[0],_useState4[1]),_useState5=(0,react.useState)(null),_useState6=(0,slicedToArray.Z)(_useState5,2),topLeftCornerOffset=_useState6[0],setTopLeftCornerOffset=_useState6[1];return(0,react.useEffect)((function(){var handleHoverPixelChangeHandler=function handleHoverPixelChangeHandler(_ref){var panZoom=_ref.panZoom,topLeftCornerOffset=_ref.topLeftCornerOffset,gridSquareSize=(_ref.topRightCornerOffset,_ref.bottomLeftCornerOffset,_ref.bottomRightCornerOffset,_ref.gridSquareSize);setCanvasPanZoom(panZoom),setGridSquareSize(gridSquareSize),setTopLeftCornerOffset(topLeftCornerOffset)};return addCanvasInfoChangeEventListener(handleHoverPixelChangeHandler),function(){removeCanvasInfoChangeEventListener(handleHoverPixelChangeHandler)}}),[]),react.createElement("div",{style:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center",fontFamily:"'Nunito Sans', 'Helvetica Neue', Helvetica, Arial, sans-serif"}},react.createElement(Dotting.Z,{ref,width:"100%",height:300}),react.createElement("div",{style:{marginTop:25,display:"flex",flexDirection:"column",gap:10,marginBottom:50}},react.createElement("div",{style:{display:"flex",alignItems:"center",gap:10}},react.createElement("strong",null,"Current Scale"),canvasPanZoom&&react.createElement("div",null,canvasPanZoom.scale)),react.createElement("div",{style:{display:"flex",alignItems:"center",gap:10}},react.createElement("strong",null,"Current Offset"),canvasPanZoom&&react.createElement("div",null,"x : ",canvasPanZoom.offset.x,", y: ",canvasPanZoom.offset.y)),react.createElement("div",{style:{display:"flex",alignItems:"center",gap:10}},react.createElement("strong",null,"Top Left Corner Canvas Offset"),canvasPanZoom&&react.createElement("div",null,"x : ",topLeftCornerOffset.x,", y: ",topLeftCornerOffset.y))))};__webpack_require__("./node_modules/core-js/modules/es.array.filter.js");var src=__webpack_require__("./src/index.ts"),types=__webpack_require__("./src/components/Canvas/types.ts");const useHandlersComponents_DataChangeListener=function DataChangeListener(){var ref=(0,react.useRef)(null),_useHandlers=(0,useHandlers.Z)(ref),addDataChangeListener=_useHandlers.addDataChangeListener,removeDataChangeListener=_useHandlers.removeDataChangeListener,_useState=(0,react.useState)(types.G3.DOT),_useState2=(0,slicedToArray.Z)(_useState,2),selectedBrushTool=_useState2[0],setSelectedBrushTool=_useState2[1],clear=(0,src.NU)(ref).clear,_useState3=(0,react.useState)(null),_useState4=(0,slicedToArray.Z)(_useState3,2),dataDelta=_useState4[0],setDataDelta=_useState4[1],handlDataChangeHandler=function handlDataChangeHandler(_ref){var delta=_ref.delta;setDataDelta(delta)};return(0,react.useEffect)((function(){return addDataChangeListener(handlDataChangeHandler),function(){removeDataChangeListener(handlDataChangeHandler)}}),[addDataChangeListener,removeDataChangeListener]),react.createElement("div",{style:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center",fontFamily:"'Nunito Sans', 'Helvetica Neue', Helvetica, Arial, sans-serif"}},react.createElement(Dotting.Z,{ref,width:"100%",height:300,brushTool:selectedBrushTool}),react.createElement("div",{style:{marginTop:25,display:"flex",alignItems:"center",flexDirection:"column",marginBottom:50}},react.createElement("div",{style:{padding:"10px 0",display:"flex",gap:10}},react.createElement("select",{value:selectedBrushTool,onChange:function onChange(e){setSelectedBrushTool(e.target.value)}},react.createElement("option",{value:types.G3.DOT},"DOT"),react.createElement("option",{value:types.G3.ERASER},"ERASER"),react.createElement("option",{value:types.G3.PAINT_BUCKET},"LINE"),react.createElement("option",{value:types.G3.SELECT},"SELECT")),react.createElement("div",{style:{}},react.createElement("button",{onClick:function onClick(){clear()}},"Clear"))),react.createElement("strong",null,"Data Delta"),dataDelta&&react.createElement(react.Fragment,null,0!==dataDelta.modifiedPixels.length&&react.createElement("div",null,"modified ",dataDelta.modifiedPixels.length," pixels"),0!==dataDelta.addedOrDeletedRows.length&&react.createElement(react.Fragment,null,0!==dataDelta.addedOrDeletedRows.filter((function(row){return!0===row.isDelete})).length&&react.createElement("div",null,"removed"," ",dataDelta.addedOrDeletedRows.filter((function(row){return!0===row.isDelete})).length," ","rows"),0!==dataDelta.addedOrDeletedRows.filter((function(row){return!1===row.isDelete})).length&&react.createElement("div",null,"added"," ",dataDelta.addedOrDeletedRows.filter((function(row){return!1===row.isDelete})).length," ","rows")),0!==dataDelta.addedOrDeletedColumns.length&&react.createElement(react.Fragment,null,0!==dataDelta.addedOrDeletedColumns.filter((function(column){return!0===column.isDelete})).length&&react.createElement("div",null,"removed"," ",dataDelta.addedOrDeletedColumns.filter((function(column){return!0===column.isDelete})).length," ","columns"),0!==dataDelta.addedOrDeletedColumns.filter((function(column){return!1===column.isDelete})).length&&react.createElement("div",null,"added"," ",dataDelta.addedOrDeletedColumns.filter((function(column){return!1===column.isDelete})).length," ","columns")))))};const useHandlersComponents_HoverPixelListener=function HoverPixelListener(){var ref=(0,react.useRef)(null),_useHandlers=(0,useHandlers.Z)(ref),addHoverPixelChangeListener=_useHandlers.addHoverPixelChangeListener,removeHoverPixelChangeListener=_useHandlers.removeHoverPixelChangeListener,_useState=(0,react.useState)(null),_useState2=(0,slicedToArray.Z)(_useState,2),hoveredPixel=_useState2[0],setHoveredPixel=_useState2[1],handleHoverPixelChangeHandler=function handleHoverPixelChangeHandler(_ref){var indices=_ref.indices;setHoveredPixel(indices)};return(0,react.useEffect)((function(){return addHoverPixelChangeListener(handleHoverPixelChangeHandler),function(){removeHoverPixelChangeListener(handleHoverPixelChangeHandler)}}),[]),react.createElement("div",{style:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center",fontFamily:"'Nunito Sans', 'Helvetica Neue', Helvetica, Arial, sans-serif"}},react.createElement(Dotting.Z,{ref,width:"100%",height:300}),react.createElement("div",{style:{marginTop:25,display:"flex",alignItems:"center",flexDirection:"column",marginBottom:50}},react.createElement("strong",null,"Hovered Pixel"),hoveredPixel&&react.createElement("div",null,"rowIndex: ",hoveredPixel.rowIndex,", columnIndex:"," ",hoveredPixel.columnIndex)))};__webpack_require__("./node_modules/core-js/modules/es.array.map.js");const useHandlersComponents_StrokeListener=function StrokeListener(){var ref=(0,react.useRef)(null),_useHandlers=(0,useHandlers.Z)(ref),addStrokeEndListener=_useHandlers.addStrokeEndListener,removeStrokeEndListener=_useHandlers.removeStrokeEndListener,_useState=(0,react.useState)([]),_useState2=(0,slicedToArray.Z)(_useState,2),strokedPixels=_useState2[0],setStrokedPixels=_useState2[1],handleStrokeEnd=function handleStrokeEnd(_ref){var strokedPixels=_ref.strokedPixels;_ref.strokeTool;setStrokedPixels(strokedPixels)};return(0,react.useEffect)((function(){return addStrokeEndListener(handleStrokeEnd),function(){removeStrokeEndListener(handleStrokeEnd)}}),[]),react.createElement("div",{style:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center",fontFamily:"'Nunito Sans', 'Helvetica Neue', Helvetica, Arial, sans-serif"}},react.createElement(Dotting.Z,{ref,width:"100%",height:300}),react.createElement("div",{style:{marginTop:25,display:"flex",alignItems:"center",flexDirection:"column",marginBottom:50}},react.createElement("div",null,react.createElement("strong",null,"Stroked Pixels")),strokedPixels.map((function(item,index){return react.createElement("div",{key:index},"rowIndex: ",item.rowIndex,", columnIndex: ",item.columnIndex,", color:"," ",item.color)}))))};function _createMdxContent(props){var _components=Object.assign({h1:"h1",code:"code",p:"p",ul:"ul",li:"li",h4:"h4",h3:"h3",pre:"pre"},(0,dist_esm.ah)(),props.components);return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(esm.h_,{title:"Hooks/useHandlers"}),"\n",(0,jsx_runtime.jsx)("style",{children:'\n  .subheading {\n    --mediumdark: \'#999999\';\n    font-weight: 900;\n    font-size: 13px;\n    color: #999;\n    letter-spacing: 6px;\n    line-height: 24px;\n    text-transform: uppercase;\n    margin-bottom: 12px;\n    margin-top: 40px;\n    font-family: \'Nunito Sans\', \'Helvetica Neue\', Helvetica, Arial, sans-serif;\n  }\n\n  .link-list {\n    display: grid;\n    grid-template-columns: 1fr;\n    grid-template-rows: 1fr 1fr;\n    row-gap: 10px;\n  }\n\n  @media (min-width: 620px) {\n    .link-list {\n      row-gap: 20px;\n      column-gap: 20px;\n      grid-template-columns: 1fr 1fr;\n    }\n  }\n\n  @media all and (-ms-high-contrast:none) {\n  .link-list {\n      display: -ms-grid;\n      -ms-grid-columns: 1fr 1fr;\n      -ms-grid-rows: 1fr 1fr;\n    }\n  }\n\n  .link-item {\n    display: block;\n    padding: 20px 30px 20px 15px;\n    border: 1px solid #00000010;\n    border-radius: 5px;\n    transition: background 150ms ease-out, border 150ms ease-out, transform 150ms ease-out;\n    color: #333333;\n    display: flex;\n    align-items: flex-start;\n  }\n\n  .link-item:hover {\n    border-color: #1EA7FD50;\n    transform: translate3d(0, -3px, 0);\n    box-shadow: rgba(0, 0, 0, 0.08) 0 3px 10px 0;\n  }\n\n  .link-item:active {\n    border-color: #1EA7FD;\n    transform: translate3d(0, 0, 0);\n  }\n\n  .link-item strong {\n    font-weight: 700;\n    display: block;\n    margin-bottom: 2px;\n  }\n  \n  .link-item img {\n    height: 40px;\n    width: 40px;\n    margin-right: 15px;\n    flex: none;\n  }\n\n  .link-item span {\n    font-size: 14px;\n    line-height: 20px;\n  }\n\n  .tip {\n    display: inline-block;\n    border-radius: 1em;\n    font-size: 11px;\n    line-height: 12px;\n    font-weight: 700;\n    background: #E7FDD8;\n    color: #66BF3C;\n    padding: 4px 12px;\n    margin-right: 10px;\n    vertical-align: top;\n  }\n\n  .tip-wrapper {\n    font-size: 13px;\n    line-height: 20px;\n    margin-top: 40px;\n    margin-bottom: 40px;\n  }\n\n  .tip-wrapper code {\n    font-size: 12px;\n    display: inline-block;\n  }\n  \ntable {\n  width: 100%;\n  border-collapse: collapse;\n  border: 1px solid #cccccc;\n  margin: 15px auto;\n  margin-bottom: 80px;\n  background: white;\n  color: #333333;\n  font-family: "Nunito Sans",-apple-system,".SFNSText-Regular","San Francisco",BlinkMacSystemFont,"Segoe UI","Helvetica Neue",Helvetica,Arial,sans-serif;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);\n}\n\nthead {\n  border-bottom: 1px solid #cccccc;\n}\n\ntable .css-1p8ieni {\n  margin: 0;\n}\n\nh4 {\n  margin-top: 15px;\n}\n\nth {\n  background: steelblue;\n  height: 54px;\n  width: 25%;\n  font-weight: lighter;\n  text-shadow: 0 1px 0 #38678f;\n  color: white;\n  border: 1px solid black;\n  box-shadow: inset 0px 1px 2px #cccccc;\n  transition: all 0.2s;\n}\ntr {\n  border-bottom: 1px solid #cccccc;\n}\ntr:last-child {\n  border-bottom: 0px;\n}\ntd {\n  border-right: 1px solid #cccccc;\n  padding: 10px;\n  transition: all 0.2s;\n  font-size: 14px;\n}\ntd:first-child {\n  font-size: 12px;\n  font-family: monospace\n\n}\ntd:last-child {\n  border-right: 0px;\n}\ntd.selected {\n  background: #d7e4ef;\n  z-index: ;\n}\ntd input {\n  font-size: 14px;\n  background: none;\n  outline: none;\n  border: 0;\n  display: table-cell;\n  height: 100%;\n  width: 100%;\n}\ntd input:focus {\n  box-shadow: 0 1px 0 steelblue;\n  color: steelblue;\n}\n::-moz-selection {\n  background: steelblue;\n  color: white;\n}\n::selection {\n  background: steelblue;\n  color: white;\n}\n'}),"\n",(0,jsx_runtime.jsx)(_components.h1,{children:(0,jsx_runtime.jsx)(_components.code,{children:"useHandlers"})}),"\n",(0,jsx_runtime.jsxs)(_components.p,{children:["With ",(0,jsx_runtime.jsx)(_components.code,{children:"useHandlers"}),", you can add event listeners to the canvas.\nThe events that you can listen to are:"]}),"\n",(0,jsx_runtime.jsxs)(_components.ul,{children:["\n",(0,jsx_runtime.jsx)(_components.li,{children:(0,jsx_runtime.jsx)(_components.code,{children:"data change"})}),"\n",(0,jsx_runtime.jsx)(_components.li,{children:(0,jsx_runtime.jsx)(_components.code,{children:"grid change"})}),"\n",(0,jsx_runtime.jsx)(_components.li,{children:(0,jsx_runtime.jsx)(_components.code,{children:"stroke end"})}),"\n",(0,jsx_runtime.jsx)(_components.li,{children:(0,jsx_runtime.jsx)(_components.code,{children:"hover pixel change"})}),"\n",(0,jsx_runtime.jsx)(_components.li,{children:(0,jsx_runtime.jsx)(_components.code,{children:"brush change"})}),"\n"]}),"\n",(0,jsx_runtime.jsxs)(_components.h4,{children:["Features provided by ",(0,jsx_runtime.jsx)(_components.code,{children:"useHandlers"})]}),"\n",(0,jsx_runtime.jsxs)("table",{children:[(0,jsx_runtime.jsx)("thead",{children:(0,jsx_runtime.jsxs)("tr",{children:[(0,jsx_runtime.jsx)("td",{}),(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsx)("strong",{children:"Description"})}),(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsx)("strong",{children:"Parameters"})})]})}),(0,jsx_runtime.jsxs)("tbody",{children:[(0,jsx_runtime.jsxs)("tr",{children:[(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsx)(_components.code,{children:"addDataChangeListener"})}),(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsxs)(_components.p,{children:["Allows you to listen to data change events. This event is triggered when the user draws on the canvas.\nThe ",(0,jsx_runtime.jsx)(_components.code,{children:"delta"})," parameter tells you the exact changes that happened on the canvas."]})}),(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsxs)(_components.p,{children:[(0,jsx_runtime.jsx)(_components.code,{children:"CanvasDataChangeHandler"})," For more information about the type, please refer to\n",(0,jsx_runtime.jsx)("u",{onClick:function onClick(){var el=document.getElementById("section1");el&&el.scrollIntoView({behavior:"smooth"})},style:{cursor:"pointer"},children:"section 1"}),"."]})})]}),(0,jsx_runtime.jsxs)("tr",{children:[(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsx)(_components.code,{children:"removeDataChangeListener"})}),(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsx)(_components.p,{children:"Allows you to remove a data change listener"})}),(0,jsx_runtime.jsxs)("td",{children:[(0,jsx_runtime.jsx)(_components.code,{children:"CanvasDataChangeHandler"})," For more information about the type, please refer to\n",(0,jsx_runtime.jsx)("u",{onClick:function onClick(){var el=document.getElementById("section1");el&&el.scrollIntoView({behavior:"smooth"})},style:{cursor:"pointer"},children:"section 1"}),"."]})]}),(0,jsx_runtime.jsxs)("tr",{children:[(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsx)(_components.code,{children:"addGridChangeListener"})}),(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsx)(_components.p,{children:"Allows you to the listen to grid change events."})}),(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsxs)(_components.p,{children:[(0,jsx_runtime.jsx)(_components.code,{children:"CanvasGridChangeHandler"})," For more information about the type, please refer to\n",(0,jsx_runtime.jsx)("u",{onClick:function onClick(){var el=document.getElementById("section2");el&&el.scrollIntoView({behavior:"smooth"})},style:{cursor:"pointer"},children:"section 2"}),"."]})})]}),(0,jsx_runtime.jsxs)("tr",{children:[(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsx)(_components.code,{children:"removeGridChangeListener"})}),(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsx)(_components.p,{children:"Allows you to remove a grid change listener"})}),(0,jsx_runtime.jsxs)("td",{children:[(0,jsx_runtime.jsx)(_components.code,{children:"CanvasGridChangeHandler"})," For more information about the type, please refer to\n",(0,jsx_runtime.jsx)("u",{onClick:function onClick(){var el=document.getElementById("section2");el&&el.scrollIntoView({behavior:"smooth"})},style:{cursor:"pointer"},children:"section 2"}),"."]})]}),(0,jsx_runtime.jsxs)("tr",{children:[(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsx)(_components.code,{children:"addBrushChangeListener"})}),(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsx)(_components.p,{children:"Allows you to listen to brush change events"})}),(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsxs)(_components.p,{children:[(0,jsx_runtime.jsx)(_components.code,{children:"CanvasBrushChangeHandler"})," For more information about the type, please refer to\n",(0,jsx_runtime.jsx)("u",{onClick:function onClick(){var el=document.getElementById("section3");el&&el.scrollIntoView({behavior:"smooth"})},style:{cursor:"pointer"},children:"section 3"}),"."]})})]}),(0,jsx_runtime.jsxs)("tr",{children:[(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsx)(_components.code,{children:"removeBrushChangeListener"})}),(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsx)(_components.p,{children:"Allows you to remove a brush change listener"})}),(0,jsx_runtime.jsxs)("td",{children:[(0,jsx_runtime.jsx)(_components.code,{children:"CanvasBrushChangeHandler"})," For more information about the type, please refer to\n",(0,jsx_runtime.jsx)("u",{onClick:function onClick(){var el=document.getElementById("section3");el&&el.scrollIntoView({behavior:"smooth"})},style:{cursor:"pointer"},children:"section 3"}),"."]})]}),(0,jsx_runtime.jsxs)("tr",{children:[(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsx)(_components.code,{children:"addStrokeEndListener"})}),(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsx)(_components.p,{children:"Allows you to add a listener to stroke end events"})}),(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsxs)(_components.p,{children:[(0,jsx_runtime.jsx)(_components.code,{children:"CanvasStrokeEndHandler"})," For more information about the type, please refer to\n",(0,jsx_runtime.jsx)("u",{onClick:function onClick(){var el=document.getElementById("section4");el&&el.scrollIntoView({behavior:"smooth"})},style:{cursor:"pointer"},children:"section 4"}),"."]})})]}),(0,jsx_runtime.jsxs)("tr",{children:[(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsx)(_components.code,{children:"removeStrokeEndListener"})}),(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsx)(_components.p,{children:"Allows you to remove a stroke end listener"})}),(0,jsx_runtime.jsxs)("td",{children:[(0,jsx_runtime.jsx)(_components.code,{children:"CanvasStrokeEndHandler"})," For more information about the type, please refer to\n",(0,jsx_runtime.jsx)("u",{onClick:function onClick(){var el=document.getElementById("section4");el&&el.scrollIntoView({behavior:"smooth"})},style:{cursor:"pointer"},children:"section 4"}),"."]})]}),(0,jsx_runtime.jsxs)("tr",{children:[(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsx)(_components.code,{children:"addHoverPixelChangeListener"})}),(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsx)(_components.p,{children:"Allows you to listen to hover pixel change events"})}),(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsxs)(_components.p,{children:[(0,jsx_runtime.jsx)(_components.code,{children:"CanvasHoverPixelChangeHandler"})," For more information about the type, please refer to\n",(0,jsx_runtime.jsx)("u",{onClick:function onClick(){var el=document.getElementById("section5");el&&el.scrollIntoView({behavior:"smooth"})},style:{cursor:"pointer"},children:"section 5"}),"."]})})]}),(0,jsx_runtime.jsxs)("tr",{children:[(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsx)(_components.code,{children:"removeHoverPixelChangeListener"})}),(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsx)(_components.p,{children:"Allows you to remove pixel change listener"})}),(0,jsx_runtime.jsxs)("td",{children:[(0,jsx_runtime.jsx)(_components.code,{children:"CanvasHoverPixelChangeHandler"})," For more information about the type, please refer to\n",(0,jsx_runtime.jsx)("u",{onClick:function onClick(){var el=document.getElementById("section5");el&&el.scrollIntoView({behavior:"smooth"})},style:{cursor:"pointer"},children:"section 5"}),"."]})]}),(0,jsx_runtime.jsxs)("tr",{children:[(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsx)(_components.code,{children:"addCanvasElementEventListener"})}),(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsxs)(_components.p,{children:["Allows you to directly add event listeners to the canvas element (E.g. ",(0,jsx_runtime.jsx)(_components.code,{children:"mousemove"}),")"]})}),(0,jsx_runtime.jsxs)("td",{children:[(0,jsx_runtime.jsx)(_components.code,{children:"string"}),", ",(0,jsx_runtime.jsx)(_components.code,{children:"EventListenerOrEventListenerObject"})," For more information about the type, please refer to\n",(0,jsx_runtime.jsx)("u",{onClick:function onClick(){var el=document.getElementById("section6");el&&el.scrollIntoView({behavior:"smooth"})},style:{cursor:"pointer"},children:"section 6"}),"."]})]}),(0,jsx_runtime.jsxs)("tr",{children:[(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsx)(_components.code,{children:"removeCanvasElementEventListener"})}),(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsx)(_components.p,{children:"Allows you to directly remove event listeners from the canvas element"})}),(0,jsx_runtime.jsxs)("td",{children:[(0,jsx_runtime.jsx)(_components.code,{children:"string"}),", ",(0,jsx_runtime.jsx)(_components.code,{children:"EventListenerOrEventListenerObject"})," For more information about the type, please refer to\n",(0,jsx_runtime.jsx)("u",{onClick:function onClick(){var el=document.getElementById("section6");el&&el.scrollIntoView({behavior:"smooth"})},style:{cursor:"pointer"},children:"section 6"}),"."]})]}),(0,jsx_runtime.jsxs)("tr",{children:[(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsx)(_components.code,{children:"addCanvasInfoChangeListener"})}),(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsxs)(_components.p,{children:["Allows you to listen to canvas info ",(0,jsx_runtime.jsx)(_components.code,{children:"panZoom"}),", ",(0,jsx_runtime.jsx)(_components.code,{children:"topLeftCornerOffset"}),", ",(0,jsx_runtime.jsx)(_components.code,{children:"topRightCornerOffset"}),", ",(0,jsx_runtime.jsx)(_components.code,{children:"bottomLeftCornerOffset"}),", ",(0,jsx_runtime.jsx)(_components.code,{children:"bottomRightCornerOffset"}),", ",(0,jsx_runtime.jsx)(_components.code,{children:"gridSquareSize"})," change events"]})}),(0,jsx_runtime.jsxs)("td",{children:[(0,jsx_runtime.jsx)(_components.code,{children:"CanvasInfoChangeHandler"})," For more information about the type, please refer to\n",(0,jsx_runtime.jsx)("u",{onClick:function onClick(){var el=document.getElementById("section7");el&&el.scrollIntoView({behavior:"smooth"})},style:{cursor:"pointer"},children:"section 7"}),"."]})]}),(0,jsx_runtime.jsxs)("tr",{children:[(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsx)(_components.code,{children:"removeCanvasInfoChangeListener"})}),(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsx)(_components.p,{children:"Allows you to remove listeners of canvas info change events"})}),(0,jsx_runtime.jsxs)("td",{children:[(0,jsx_runtime.jsx)(_components.code,{children:"CanvasInfoChangeHandler"})," For more information about the type, please refer to\n",(0,jsx_runtime.jsx)("u",{onClick:function onClick(){var el=document.getElementById("section7");el&&el.scrollIntoView({behavior:"smooth"})},style:{cursor:"pointer"},children:"section 7"}),"."]})]})]})]}),"\n",(0,jsx_runtime.jsx)(_components.h3,{children:"Examples"}),"\n",(0,jsx_runtime.jsx)("div",{id:"section1"}),"\n",(0,jsx_runtime.jsx)(_components.h4,{children:"1. Data change listener"}),"\n",(0,jsx_runtime.jsxs)(_components.p,{children:[(0,jsx_runtime.jsx)(_components.code,{children:"addDataChangeListener"}),", ",(0,jsx_runtime.jsx)(_components.code,{children:"removeDataChangeListener"})]}),"\n",(0,jsx_runtime.jsxs)(_components.p,{children:["With data change listeners, you can observe the changes when the user draws on the canvas.\nYou can check the ",(0,jsx_runtime.jsx)(_components.code,{children:"delta"})," parameter to see the exact changes that happened on the canvas."]}),"\n",(0,jsx_runtime.jsxs)(_components.p,{children:["The params you should pass to the listener is ",(0,jsx_runtime.jsx)(_components.code,{children:"CanvasDataChangeParams"}),":"]}),"\n",(0,jsx_runtime.jsx)(_components.pre,{children:(0,jsx_runtime.jsx)(_components.code,{className:"language-ts",children:"export type CanvasDataChangeParams = {\n  isLocalChange: boolean;\n  data: DottingData;\n  layerId: string;\n  delta?: CanvasDelta;\n};\n\nexport type CanvasDataChangeHandler = (params: CanvasDataChangeParams) => void;\n"})}),"\n",(0,jsx_runtime.jsxs)(_components.p,{children:[(0,jsx_runtime.jsx)(_components.code,{children:"DottingData"})," is a map of ",(0,jsx_runtime.jsx)(_components.code,{children:"rowIndex"})," to ",(0,jsx_runtime.jsx)(_components.code,{children:"columnIndex"})," to ",(0,jsx_runtime.jsx)(_components.code,{children:"PixelData"}),"\nIt contains information about the current colored areas of the canvas:"]}),"\n",(0,jsx_runtime.jsx)(_components.pre,{children:(0,jsx_runtime.jsx)(_components.code,{className:"language-ts",children:"export type DottingData = Map<number, Map<number, PixelData>>;\n\nexport type PixelData = {\n  color: string;\n};\n"})}),"\n",(0,jsx_runtime.jsxs)(_components.p,{children:[(0,jsx_runtime.jsx)(_components.code,{children:"CanvasDelta"})," is an object that contains information about the changes that happened on the canvas.\nThe ",(0,jsx_runtime.jsx)(_components.code,{children:"modifiedPixels"})," tells you what pixels have been modified.\nThe ",(0,jsx_runtime.jsx)(_components.code,{children:"addedOrDeletedRows"})," and ",(0,jsx_runtime.jsx)(_components.code,{children:"addedOrDeletedColumns"})," tell you what rows and columns have been added or deleted."]}),"\n",(0,jsx_runtime.jsx)(_components.pre,{children:(0,jsx_runtime.jsx)(_components.code,{className:"language-ts",children:"export type CanvasDelta = {\n  modifiedPixels: Array<PixelModifyItem>;\n  addedOrDeletedRows?: Array<{\n    isDelete: boolean;\n    index: number;\n  }>;\n  addedOrDeletedColumns?: Array<{\n    isDelete: boolean;\n    index: number;\n  }>;\n};\n"})}),"\n",(0,jsx_runtime.jsx)(useHandlersComponents_DataChangeListener,{}),"\n",(0,jsx_runtime.jsx)("div",{id:"section2"}),"\n",(0,jsx_runtime.jsx)(_components.h4,{children:"2. Grid Change listener"}),"\n",(0,jsx_runtime.jsxs)(_components.p,{children:[(0,jsx_runtime.jsx)(_components.code,{children:"addGridChangeListener"}),", ",(0,jsx_runtime.jsx)(_components.code,{children:"removeGridChangeListener"})]}),"\n",(0,jsx_runtime.jsx)(_components.p,{children:"With grid change listeners, you can observe changes in the grids"}),"\n",(0,jsx_runtime.jsxs)(_components.p,{children:["The params you should pass to the listener is ",(0,jsx_runtime.jsx)(_components.code,{children:"CanvasGridChangeParams"}),".\nWith the canvas grid change params, you can know the dimensions and the 4 indices of the canvas grid."]}),"\n",(0,jsx_runtime.jsx)(_components.pre,{children:(0,jsx_runtime.jsx)(_components.code,{className:"language-ts",children:"export type CanvasGridChangeParams = {\n  dimensions: {\n    columnCount: number;\n    rowCount: number;\n  };\n  indices: {\n    topRowIndex: number;\n    bottomRowIndex: number;\n    leftColumnIndex: number;\n    rightColumnIndex: number;\n  };\n};\n\nexport type CanvasGridChangeHandler = (params: CanvasGridChangeParams) => void;\n"})}),"\n",(0,jsx_runtime.jsx)("br",{}),"\n",(0,jsx_runtime.jsx)("div",{id:"section3"}),"\n",(0,jsx_runtime.jsx)(_components.h4,{children:"3. Brush Change Listener"}),"\n",(0,jsx_runtime.jsxs)(_components.p,{children:[(0,jsx_runtime.jsx)(_components.code,{children:"addBrushChangeListener"}),", ",(0,jsx_runtime.jsx)(_components.code,{children:"removeBrushChangeListener"})]}),"\n",(0,jsx_runtime.jsx)(_components.p,{children:"Brush change listeners allows you to observe the changes when the user changes the brush tool or the brush color.\nThe parameter you should pass to the listener is defiend as below"}),"\n",(0,jsx_runtime.jsx)(_components.pre,{children:(0,jsx_runtime.jsx)(_components.code,{className:"language-ts",children:"export type CanvasBrushChangeParams = {\n  brushColor: string;\n  brushTool: BrushTool;\n};\n\nexport type CanvasBrushChangeHandler = (\n  params: CanvasBrushChangeParams,\n) => void;\n"})}),"\n",(0,jsx_runtime.jsx)(_components.p,{children:"The brush tool is an enum that you can import from the library.\nCurrently we have four tools"}),"\n",(0,jsx_runtime.jsx)(_components.pre,{children:(0,jsx_runtime.jsx)(_components.code,{className:"language-ts",children:'export enum BrushTool {\n  DOT = "DOT",\n  ERASER = "ERASER",\n  PAINT_BUCKET = "PAINT_BUCKET",\n  SELECT = "SELECT",\n}\n'})}),"\n",(0,jsx_runtime.jsx)("br",{}),"\n",(0,jsx_runtime.jsx)("div",{id:"section4"}),"\n",(0,jsx_runtime.jsxs)(_components.h4,{children:["4. Stroke end listener"," "]}),"\n",(0,jsx_runtime.jsxs)(_components.p,{children:[(0,jsx_runtime.jsx)(_components.code,{children:"addStrokeEndListener"}),", ",(0,jsx_runtime.jsx)(_components.code,{children:"removeStrokeEndListener"})]}),"\n",(0,jsx_runtime.jsx)(_components.p,{children:"With stroke end related listeners, you can observe the changes when the user ends the stroke."}),"\n",(0,jsx_runtime.jsxs)(_components.p,{children:["The stroke end listener tells you whate pixels were stroked and what tool was used for stroking them\nAdditionally you can get the ",(0,jsx_runtime.jsx)(_components.code,{children:"DottingData"})," which is a map of ",(0,jsx_runtime.jsx)(_components.code,{children:"rowIndex"})," to ",(0,jsx_runtime.jsx)(_components.code,{children:"columnIndex"})," to ",(0,jsx_runtime.jsx)(_components.code,{children:"PixelData"})]}),"\n",(0,jsx_runtime.jsxs)(_components.p,{children:["The params you should pass to the listener is ",(0,jsx_runtime.jsx)(_components.code,{children:"CanvasStrokeEndParams"}),":"]}),"\n",(0,jsx_runtime.jsx)(_components.pre,{children:(0,jsx_runtime.jsx)(_components.code,{className:"language-ts",children:"export type CanvasStrokeEndParams = {\n  strokedPixels: Array<ColorChangeItem>;\n  strokeTool: BrushTool;\n};\n\nexport type CanvasStrokeEndHandler = (params: CanvasStrokeEndParams) => void;\n"})}),"\n",(0,jsx_runtime.jsxs)(_components.p,{children:["The ",(0,jsx_runtime.jsx)(_components.code,{children:"ColorChangeItem"})," is defined as below.\nYou are able to get the previous color and the current color of the pixel."]}),"\n",(0,jsx_runtime.jsx)(_components.pre,{children:(0,jsx_runtime.jsx)(_components.code,{className:"language-ts",children:"export interface ColorChangeItem {\n  rowIndex: number;\n  columnIndex: number;\n  color: string;\n  previousColor: string;\n}\n"})}),"\n",(0,jsx_runtime.jsx)(useHandlersComponents_StrokeListener,{}),"\n",(0,jsx_runtime.jsx)("div",{id:"section5"}),"\n",(0,jsx_runtime.jsxs)(_components.h4,{children:["5. Hover Pixel Change Listener"," "]}),"\n",(0,jsx_runtime.jsxs)(_components.p,{children:[(0,jsx_runtime.jsx)(_components.code,{children:"addHoverPixelChangeListener"}),", ",(0,jsx_runtime.jsx)(_components.code,{children:"removeHoverPixelChangeListener"})]}),"\n",(0,jsx_runtime.jsxs)(_components.p,{children:["With the hover pixel change listener, you can observe the changes when the user hovers over the canvas.\nWhen there is no hovered pixel, the return value will be ",(0,jsx_runtime.jsx)(_components.code,{children:"null"})]}),"\n",(0,jsx_runtime.jsxs)(_components.p,{children:["The params you should pass to the listener is ",(0,jsx_runtime.jsx)(_components.code,{children:"CanvasHoverPixelChangeHandler"}),":"]}),"\n",(0,jsx_runtime.jsx)(_components.pre,{children:(0,jsx_runtime.jsx)(_components.code,{className:"language-ts",children:"export type CanvasHoverPixelChangeHandler = ({\n  indices: {\n    rowIndex: number;\n    columnIndex: number;\n  } | null\n}) => void;\n"})}),"\n",(0,jsx_runtime.jsx)(useHandlersComponents_HoverPixelListener,{}),"\n",(0,jsx_runtime.jsx)("div",{id:"section6"}),"\n",(0,jsx_runtime.jsx)(_components.h4,{children:"6. Canvas Element Custom Event Listener"}),"\n",(0,jsx_runtime.jsxs)(_components.p,{children:[(0,jsx_runtime.jsx)(_components.code,{children:"addCanvasElementEventListener"}),", ",(0,jsx_runtime.jsx)(_components.code,{children:"removeCanvasElementEventListener"})]}),"\n",(0,jsx_runtime.jsx)(_components.p,{children:"You can also directly add event listeners to the canvas element.\nThis is useful when you want to listen to events that are not provided by the library."}),"\n",(0,jsx_runtime.jsxs)(_components.p,{children:["The parameter you should pass to the listener is ",(0,jsx_runtime.jsx)(_components.code,{children:"CanvasElementEventParams"}),":"]}),"\n",(0,jsx_runtime.jsx)(_components.pre,{children:(0,jsx_runtime.jsx)(_components.code,{className:"language-ts",children:"export type CanvasElementEventParams = {\n  eventName: string;\n  listener: EventListenerOrEventListenerObject;\n};\n"})}),"\n",(0,jsx_runtime.jsx)(useHandlersComponents_CanvasElementEvents,{}),"\n",(0,jsx_runtime.jsx)("div",{id:"section7"}),"\n",(0,jsx_runtime.jsx)(_components.h4,{children:"7. Canvas Info Change Event Listener"}),"\n",(0,jsx_runtime.jsxs)(_components.p,{children:[(0,jsx_runtime.jsx)(_components.code,{children:"addCanvasElementEventListener"}),",",(0,jsx_runtime.jsx)(_components.code,{children:"removeCanvasElementEventListener"})]}),"\n",(0,jsx_runtime.jsxs)(_components.p,{children:["You can listen to canvas info change events with ",(0,jsx_runtime.jsx)(_components.code,{children:"addCanvasInfoChangeListener"}),".\nThe info you can get from the event is:"]}),"\n",(0,jsx_runtime.jsx)(_components.pre,{children:(0,jsx_runtime.jsx)(_components.code,{className:"language-ts",children:"export type CanvasInfoChangeParams = {\n  panZoom: PanZoom;\n  topLeftCornerOffset: Coord;\n  topRightCornerOffset: Coord;\n  bottomLeftCornerOffset: Coord;\n  bottomRightCornerOffset: Coord;\n  gridSquareSize: number;\n};\n"})}),"\n",(0,jsx_runtime.jsx)(_components.p,{children:"The PanZoom object is:"}),"\n",(0,jsx_runtime.jsx)(_components.pre,{children:(0,jsx_runtime.jsx)(_components.code,{className:"language-ts",children:"export type PanZoom = {\n  scale: number;\n  offset: Coord;\n};\n"})}),"\n",(0,jsx_runtime.jsx)(_components.p,{children:"and the Coord object is:"}),"\n",(0,jsx_runtime.jsx)(_components.pre,{children:(0,jsx_runtime.jsx)(_components.code,{className:"language-ts",children:"export interface Coord {\n  x: number;\n  y: number;\n}\n"})}),"\n",(0,jsx_runtime.jsx)(useHandlersComponents_CanvasInfoChangeListener,{}),"\n",(0,jsx_runtime.jsx)("div",{className:"subheading",children:"Example Source Codes"}),"\n",(0,jsx_runtime.jsx)("div",{className:"link-list",children:(0,jsx_runtime.jsxs)("a",{className:"link-item",href:"https://github.com/hunkim98/dotting/tree/main/stories/useHandlersComponent",target:"_blank",children:[(0,jsx_runtime.jsx)("img",{src:stackalt,alt:"Build"}),(0,jsx_runtime.jsx)("span",{children:(0,jsx_runtime.jsxs)(_components.p,{children:[(0,jsx_runtime.jsx)("strong",{children:"Github Source Code"}),"\nView the source code and contribute to the project!"]})})]})}),"\n",(0,jsx_runtime.jsx)("div",{className:"tip-wrapper"}),"\n",(0,jsx_runtime.jsx)(_components.pre,{children:(0,jsx_runtime.jsx)(_components.code,{})})]})}function MDXContent(){var props=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},MDXLayout=Object.assign({},(0,dist_esm.ah)(),props.components).wrapper;return MDXLayout?(0,jsx_runtime.jsx)(MDXLayout,Object.assign({},props,{children:(0,jsx_runtime.jsx)(_createMdxContent,props)})):_createMdxContent(props)}var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Hooks/useHandlers",includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return react.createElement(esm.aT,{mdxStoryNameToKey,mdxComponentAnnotations:componentMeta},react.createElement(MDXContent,null))}});const useHandlers_stories=componentMeta;var __namedExportsOrder=["__page"]},"./stories/useLayers.stories.mdx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{__namedExportsOrder:()=>__namedExportsOrder,__page:()=>__page,default:()=>useLayers_stories});__webpack_require__("./node_modules/core-js/modules/es.object.assign.js");var react=__webpack_require__("./node_modules/react/index.js"),esm=__webpack_require__("./node_modules/@storybook/addon-docs/dist/esm/index.js"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),dist_esm=__webpack_require__("./node_modules/@mdx-js/react/dist/esm.js"),stackalt=(__webpack_require__("./stories/assets/code-brackets.svg"),__webpack_require__("./stories/assets/colors.svg"),__webpack_require__("./stories/assets/comments.svg"),__webpack_require__("./stories/assets/direction.svg"),__webpack_require__("./stories/assets/flow.svg"),__webpack_require__("./stories/assets/plugin.svg"),__webpack_require__("./stories/assets/repo.svg"),__webpack_require__("./stories/assets/stackalt.svg")),Dotting=__webpack_require__("./src/components/Dotting.tsx"),toConsumableArray=(__webpack_require__("./node_modules/core-js/modules/es.array.splice.js"),__webpack_require__("./node_modules/core-js/modules/es.array.map.js"),__webpack_require__("./node_modules/core-js/modules/es.function.bind.js"),__webpack_require__("./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js")),slicedToArray=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),src=__webpack_require__("./src/index.ts"),useLayers=__webpack_require__("./src/hooks/useLayers.ts"),dataCreator=__webpack_require__("./stories/utils/dataCreator.ts");const useLayersComponents_CreateLayers=function CreateLayers(){var ref=(0,react.useRef)(null),changeBrushColor=(0,src.DX)(ref).changeBrushColor,_useLayers=(0,useLayers.Z)(ref),layers=_useLayers.layers,addLayer=_useLayers.addLayer,removeLayer=_useLayers.removeLayer,changeLayerPosition=_useLayers.changeLayerPosition,currentLayer=_useLayers.currentLayer,setCurrentLayer=_useLayers.setCurrentLayer,reorderLayersByIds=_useLayers.reorderLayersByIds,_useState=(0,react.useState)(null),_useState2=(0,slicedToArray.Z)(_useState,2),draggingSectionId=_useState2[0],setDraggingSectionId=_useState2[1],_useState3=(0,react.useState)(3),_useState4=(0,slicedToArray.Z)(_useState3,2),createdLayerCount=_useState4[0],setCreatedLayerCount=_useState4[1],draggingItemIndex=(0,react.useRef)(null),draggingOverItemIndex=(0,react.useRef)(null),onDragEnd=function onDragEnd(e){reorderLayersByIds(layers.map((function(layer){return layer.id}))),setDraggingSectionId(null)},onDragOver=function onDragOver(e){e.preventDefault()};return react.createElement("div",{style:{marginTop:20,width:"100%",display:"flex",fontFamily:"'Nunito Sans', 'Helvetica Neue', Helvetica, Arial, sans-serif",marginBottom:50}},react.createElement("div",{style:{display:"flex",flexDirection:"column",paddingRight:10,maxWidth:150}},react.createElement("div",{style:{fontSize:18,marginBottom:5}},"Layers"),react.createElement("div",{style:{fontSize:12,marginBottom:5}},"Drag and Drop the layers to move their positions"),react.createElement("ul",{style:{width:"100%",height:440,overflowY:"scroll",overflow:"auto",display:"flex",gap:5,flexDirection:"column",listStyleType:"none",padding:0,margin:0}},layers.map((function(layer,index){return react.createElement("li",{style:{display:"flex",flexDirection:"column",listStyle:"none",textAlign:"center",border:"1px solid black",padding:5,gap:5,backgroundColor:currentLayer.id===layer.id?"grey":"white",color:currentLayer.id===layer.id?"white":"black",cursor:"pointer",opacity:draggingSectionId===layer.id?.5:1},key:layer.id,onClick:function onClick(e){return function onClickHandler(e,id){e.stopPropagation(),setCurrentLayer(id)}(e,layer.id)},onDragStart:function onDragStart(e){return function onDragStart(e,index,id){draggingItemIndex.current=index,setDraggingSectionId(id)}(0,index,layer.id)},onDragEnter:function onDragEnter(e){return function onAvailableItemDragEnter(e,index){draggingOverItemIndex.current=index;var copyListItems=(0,toConsumableArray.Z)(layers),draggingItemContent=copyListItems[draggingItemIndex.current];copyListItems.splice(draggingItemIndex.current,1),copyListItems.splice(draggingOverItemIndex.current,0,draggingItemContent),draggingItemIndex.current=draggingOverItemIndex.current,draggingOverItemIndex.current=null,changeLayerPosition(draggingItemContent.id,index)}(0,index)},onDragEnd,onDragOver,draggable:!0},react.createElement("div",null,layer.id),react.createElement("div",null,react.createElement("button",{onClick:function onClick(e){e.stopPropagation(),removeLayer(layer.id)}},"remove")))})),react.createElement("button",{onClick:function onClick(){addLayer("layer"+(createdLayerCount+1),layers.length),setCreatedLayerCount(createdLayerCount+1)}},"Add Layer"))),react.createElement("div",{style:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center"}},react.createElement(Dotting.Z,{ref,width:"100%",height:500,initLayers:[{id:"layer1",data:(0,dataCreator.n)(15)},{id:"layer2",data:(0,dataCreator.n)(15)},{id:"layer3",data:(0,dataCreator.n)(15)}]}),react.createElement("div",null,["#FF0000","#0000FF","#00FF00","#FF00FF","#00FFFF","#FFFF00","#000000","#FFFFFF"].map((function(color){return react.createElement("div",{key:color,onClick:changeBrushColor.bind(null,color),style:{width:25,height:25,margin:10,border:"1px solid black",backgroundColor:color,display:"inline-block"}})})))))};const useLayersComponents_ReorderLayers=function ReorderLayers(){var ref=(0,react.useRef)(null),changeBrushColor=(0,src.DX)(ref).changeBrushColor,_useLayers=(0,useLayers.Z)(ref),layers=_useLayers.layers,addLayer=_useLayers.addLayer,removeLayer=_useLayers.removeLayer,changeLayerPosition=_useLayers.changeLayerPosition,currentLayer=_useLayers.currentLayer,setCurrentLayer=_useLayers.setCurrentLayer,reorderLayersByIds=_useLayers.reorderLayersByIds,_useState=(0,react.useState)(null),_useState2=(0,slicedToArray.Z)(_useState,2),draggingSectionId=_useState2[0],setDraggingSectionId=_useState2[1],draggingItemIndex=(0,react.useRef)(null),draggingOverItemIndex=(0,react.useRef)(null),_useState3=(0,react.useState)(3),_useState4=(0,slicedToArray.Z)(_useState3,2),createdLayerCount=_useState4[0],setCreatedLayerCount=_useState4[1],onDragEnd=function onDragEnd(e){reorderLayersByIds(layers.map((function(layer){return layer.id}))),setDraggingSectionId(null)},onDragOver=function onDragOver(e){e.preventDefault()};return react.createElement("div",{style:{marginTop:20,width:"100%",display:"flex",fontFamily:"'Nunito Sans', 'Helvetica Neue', Helvetica, Arial, sans-serif",marginBottom:50}},react.createElement("div",{style:{display:"flex",flexDirection:"column",paddingRight:10,maxWidth:150}},react.createElement("div",{style:{fontSize:18,marginBottom:5}},"Layers"),react.createElement("div",{style:{fontSize:12,marginBottom:5}},"Drag and Drop the layers to move their positions"),react.createElement("ul",{style:{width:"100%",height:440,overflowY:"scroll",overflow:"auto",display:"flex",gap:5,flexDirection:"column",listStyleType:"none",padding:0,margin:0}},layers.map((function(layer,index){return react.createElement("li",{style:{display:"flex",flexDirection:"column",listStyle:"none",textAlign:"center",border:"1px solid black",padding:5,gap:5,backgroundColor:currentLayer.id===layer.id?"grey":"white",color:currentLayer.id===layer.id?"white":"black",cursor:"pointer",opacity:draggingSectionId===layer.id?.5:1},key:layer.id,onClick:function onClick(e){return function onClickHandler(e,id){e.stopPropagation(),setCurrentLayer(id)}(e,layer.id)},onDragStart:function onDragStart(e){return function onDragStart(e,index,id){draggingItemIndex.current=index,setDraggingSectionId(id)}(0,index,layer.id)},onDragEnter:function onDragEnter(e){return function onAvailableItemDragEnter(e,index){draggingOverItemIndex.current=index;var copyListItems=(0,toConsumableArray.Z)(layers),draggingItemContent=copyListItems[draggingItemIndex.current];copyListItems.splice(draggingItemIndex.current,1),copyListItems.splice(draggingOverItemIndex.current,0,draggingItemContent),draggingItemIndex.current=draggingOverItemIndex.current,draggingOverItemIndex.current=null,changeLayerPosition(draggingItemContent.id,index)}(0,index)},onDragEnd,onDragOver,draggable:!0},react.createElement("div",null,layer.id),react.createElement("div",null,react.createElement("button",{onClick:function onClick(e){e.stopPropagation(),removeLayer(layer.id)}},"remove")))})),react.createElement("button",{onClick:function onClick(){addLayer("layer"+(createdLayerCount+1),layers.length),setCreatedLayerCount(createdLayerCount+1)}},"Add Layer"))),react.createElement("div",{style:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center"}},react.createElement(Dotting.Z,{ref,width:"100%",height:500,initLayers:[{id:"layer1",data:(0,dataCreator.n)(15)},{id:"layer2",data:(0,dataCreator.n)(15)},{id:"layer3",data:(0,dataCreator.n)(15)}]}),react.createElement("div",null,["#FF0000","#0000FF","#00FF00","#FF00FF","#00FFFF","#FFFF00","#000000","#FFFFFF"].map((function(color){return react.createElement("div",{key:color,onClick:changeBrushColor.bind(null,color),style:{width:25,height:25,margin:10,border:"1px solid black",backgroundColor:color,display:"inline-block"}})})))))};const useLayersComponents_SwitchLayers=function SwitchLayers(){var ref=(0,react.useRef)(null),changeBrushColor=(0,src.DX)(ref).changeBrushColor,_useLayers=(0,useLayers.Z)(ref),layers=_useLayers.layers,changeLayerPosition=_useLayers.changeLayerPosition,currentLayer=_useLayers.currentLayer,setCurrentLayer=_useLayers.setCurrentLayer,reorderLayersByIds=_useLayers.reorderLayersByIds,_useState=(0,react.useState)(null),_useState2=(0,slicedToArray.Z)(_useState,2),draggingSectionId=_useState2[0],setDraggingSectionId=_useState2[1],draggingItemIndex=(0,react.useRef)(null),draggingOverItemIndex=(0,react.useRef)(null),onDragEnd=function onDragEnd(e){reorderLayersByIds(layers.map((function(layer){return layer.id}))),setDraggingSectionId(null)},onDragOver=function onDragOver(e){e.preventDefault()};return react.createElement("div",{style:{marginTop:20,width:"100%",display:"flex",fontFamily:"'Nunito Sans', 'Helvetica Neue', Helvetica, Arial, sans-serif",marginBottom:50}},react.createElement("div",{style:{display:"flex",flexDirection:"column",paddingRight:10,maxWidth:150}},react.createElement("div",{style:{fontSize:18,marginBottom:5}},"Layers"),react.createElement("div",{style:{fontSize:12,marginBottom:5}},"Drag and Drop the layers to move their positions"),react.createElement("ul",{style:{width:"100%",height:440,overflowY:"scroll",overflow:"auto",display:"flex",gap:5,flexDirection:"column",listStyleType:"none",padding:0,margin:0}},layers.map((function(layer,index){return react.createElement("li",{style:{display:"flex",flexDirection:"column",listStyle:"none",textAlign:"center",border:"1px solid black",padding:5,gap:5,backgroundColor:currentLayer.id===layer.id?"grey":"white",color:currentLayer.id===layer.id?"white":"black",cursor:"pointer",opacity:draggingSectionId===layer.id?.5:1},key:layer.id,onClick:function onClick(e){return function onClickHandler(e,id){e.stopPropagation(),setCurrentLayer(id)}(e,layer.id)},onDragStart:function onDragStart(e){return function onDragStart(e,index,id){draggingItemIndex.current=index,setDraggingSectionId(id)}(0,index,layer.id)},onDragEnter:function onDragEnter(e){return function onAvailableItemDragEnter(e,index){draggingOverItemIndex.current=index;var copyListItems=(0,toConsumableArray.Z)(layers),draggingItemContent=copyListItems[draggingItemIndex.current];copyListItems.splice(draggingItemIndex.current,1),copyListItems.splice(draggingOverItemIndex.current,0,draggingItemContent),draggingItemIndex.current=draggingOverItemIndex.current,draggingOverItemIndex.current=null,changeLayerPosition(draggingItemContent.id,index)}(0,index)},onDragEnd,onDragOver,draggable:!0},react.createElement("div",null,layer.id))})))),react.createElement("div",{style:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center"}},react.createElement(Dotting.Z,{ref,width:"100%",height:500,initLayers:[{id:"layer1",data:(0,dataCreator.n)(15)},{id:"layer2",data:(0,dataCreator.n)(15)},{id:"layer3",data:(0,dataCreator.n)(15)}]}),react.createElement("div",null,["#FF0000","#0000FF","#00FF00","#FF00FF","#00FFFF","#FFFF00","#000000","#FFFFFF"].map((function(color){return react.createElement("div",{key:color,onClick:changeBrushColor.bind(null,color),style:{width:25,height:25,margin:10,border:"1px solid black",backgroundColor:color,display:"inline-block"}})})))))};const VisibleLayers=function VisbleLayers(){var ref=(0,react.useRef)(null),changeBrushColor=(0,src.DX)(ref).changeBrushColor,_useLayers=(0,useLayers.Z)(ref),layers=_useLayers.layers,changeLayerPosition=_useLayers.changeLayerPosition,currentLayer=_useLayers.currentLayer,setCurrentLayer=_useLayers.setCurrentLayer,isolateLayer=_useLayers.isolateLayer,showLayer=_useLayers.showLayer,hideLayer=_useLayers.hideLayer,reorderLayersByIds=_useLayers.reorderLayersByIds,_useState=(0,react.useState)(null),_useState2=(0,slicedToArray.Z)(_useState,2),draggingSectionId=_useState2[0],setDraggingSectionId=_useState2[1],draggingItemIndex=(0,react.useRef)(null),draggingOverItemIndex=(0,react.useRef)(null),onDragEnd=function onDragEnd(e){reorderLayersByIds(layers.map((function(layer){return layer.id}))),setDraggingSectionId(null)},onDragOver=function onDragOver(e){e.preventDefault()};return react.createElement("div",{style:{width:"100%",display:"flex",fontFamily:"'Nunito Sans', 'Helvetica Neue', Helvetica, Arial, sans-serif",marginBottom:50}},react.createElement("div",{style:{display:"flex",flexDirection:"column",paddingRight:10,maxWidth:150}},react.createElement("div",{style:{fontSize:18,marginBottom:5}},"Layers"),react.createElement("div",{style:{fontSize:12,marginBottom:5}},"Drag and Drop the layers to move their positions"),react.createElement("ul",{style:{width:"100%",height:440,overflowY:"scroll",overflow:"auto",display:"flex",gap:5,flexDirection:"column",listStyleType:"none",padding:0,margin:0}},layers.map((function(layer,index){return react.createElement("li",{style:{display:"flex",flexDirection:"column",listStyle:"none",textAlign:"center",border:"1px solid black",padding:5,gap:5,backgroundColor:currentLayer.id===layer.id?"grey":"white",color:currentLayer.id===layer.id?"white":"black",cursor:"pointer",opacity:draggingSectionId===layer.id?.5:1},key:layer.id,onClick:function onClick(e){return function onClickHandler(e,id){e.stopPropagation(),setCurrentLayer(id)}(e,layer.id)},onDragStart:function onDragStart(e){return function onDragStart(e,index,id){draggingItemIndex.current=index,setDraggingSectionId(id)}(0,index,layer.id)},onDragEnter:function onDragEnter(e){return function onAvailableItemDragEnter(e,index){draggingOverItemIndex.current=index;var copyListItems=(0,toConsumableArray.Z)(layers),draggingItemContent=copyListItems[draggingItemIndex.current];copyListItems.splice(draggingItemIndex.current,1),copyListItems.splice(draggingOverItemIndex.current,0,draggingItemContent),draggingItemIndex.current=draggingOverItemIndex.current,draggingOverItemIndex.current=null,changeLayerPosition(draggingItemContent.id,index)}(0,index)},onDragEnd,onDragOver,draggable:!0},react.createElement("div",null,layer.id),react.createElement("div",null,react.createElement("button",{style:{fontSize:12,opacity:layer.isVisible?1:.5},onClick:function onClick(e){e.stopPropagation(),layer.isVisible?hideLayer(layer.id):showLayer(layer.id)}},layer.isVisible?"hide":"show"),react.createElement("button",{onClick:function onClick(){isolateLayer(layer.id)}},"isolate")))})))),react.createElement("div",{style:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center"}},react.createElement(Dotting.Z,{ref,width:"100%",height:500,initLayers:[{id:"layer1",data:(0,dataCreator.n)(15)},{id:"layer2",data:(0,dataCreator.n)(15)},{id:"layer3",data:(0,dataCreator.n)(15)}]}),react.createElement("div",null,["#FF0000","#0000FF","#00FF00","#FF00FF","#00FFFF","#FFFF00","#000000","#FFFFFF"].map((function(color){return react.createElement("div",{key:color,onClick:changeBrushColor.bind(null,color),style:{width:25,height:25,margin:10,border:"1px solid black",backgroundColor:color,display:"inline-block"}})})))))};function _createMdxContent(props){var _components=Object.assign({h1:"h1",code:"code",p:"p",ul:"ul",li:"li",h4:"h4",pre:"pre",h3:"h3"},(0,dist_esm.ah)(),props.components);return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(esm.h_,{title:"Hooks/useLayers"}),"\n",(0,jsx_runtime.jsx)("style",{children:'\n  .subheading {\n    --mediumdark: \'#999999\';\n    font-weight: 900;\n    font-size: 13px;\n    color: #999;\n    letter-spacing: 6px;\n    line-height: 24px;\n    text-transform: uppercase;\n    margin-bottom: 12px;\n    margin-top: 40px;\n    font-family: \'Nunito Sans\', \'Helvetica Neue\', Helvetica, Arial, sans-serif;\n  }\n\n  .link-list {\n    display: grid;\n    grid-template-columns: 1fr;\n    grid-template-rows: 1fr 1fr;\n    row-gap: 10px;\n  }\n\n  @media (min-width: 620px) {\n    .link-list {\n      row-gap: 20px;\n      column-gap: 20px;\n      grid-template-columns: 1fr 1fr;\n    }\n  }\n\n  @media all and (-ms-high-contrast:none) {\n  .link-list {\n      display: -ms-grid;\n      -ms-grid-columns: 1fr 1fr;\n      -ms-grid-rows: 1fr 1fr;\n    }\n  }\n\n  .link-item {\n    display: block;\n    padding: 20px 30px 20px 15px;\n    border: 1px solid #00000010;\n    border-radius: 5px;\n    transition: background 150ms ease-out, border 150ms ease-out, transform 150ms ease-out;\n    color: #333333;\n    display: flex;\n    align-items: flex-start;\n  }\n\n  .link-item:hover {\n    border-color: #1EA7FD50;\n    transform: translate3d(0, -3px, 0);\n    box-shadow: rgba(0, 0, 0, 0.08) 0 3px 10px 0;\n  }\n\n  .link-item:active {\n    border-color: #1EA7FD;\n    transform: translate3d(0, 0, 0);\n  }\n\n  .link-item strong {\n    font-weight: 700;\n    display: block;\n    margin-bottom: 2px;\n  }\n  \n  .link-item img {\n    height: 40px;\n    width: 40px;\n    margin-right: 15px;\n    flex: none;\n  }\n\n  .link-item span {\n    font-size: 14px;\n    line-height: 20px;\n  }\n\n  .tip {\n    display: inline-block;\n    border-radius: 1em;\n    font-size: 11px;\n    line-height: 12px;\n    font-weight: 700;\n    background: #E7FDD8;\n    color: #66BF3C;\n    padding: 4px 12px;\n    margin-right: 10px;\n    vertical-align: top;\n  }\n\n  .tip-wrapper {\n    font-size: 13px;\n    line-height: 20px;\n    margin-top: 40px;\n    margin-bottom: 40px;\n  }\n\n  .tip-wrapper code {\n    font-size: 12px;\n    display: inline-block;\n  }\n  \ntable {\n  width: 100%;\n  border-collapse: collapse;\n  border: 1px solid #cccccc;\n  margin: 15px auto;\n  margin-bottom: 80px;\n  background: white;\n  color: #333333;\n  font-family: "Nunito Sans",-apple-system,".SFNSText-Regular","San Francisco",BlinkMacSystemFont,"Segoe UI","Helvetica Neue",Helvetica,Arial,sans-serif;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);\n}\n\nthead {\n  border-bottom: 1px solid #cccccc;\n}\n\ntable .css-1p8ieni {\n  margin: 0;\n}\n\nh4 {\n  margin-top: 15px;\n}\n\nth {\n  background: steelblue;\n  height: 54px;\n  width: 25%;\n  font-weight: lighter;\n  text-shadow: 0 1px 0 #38678f;\n  color: white;\n  border: 1px solid black;\n  box-shadow: inset 0px 1px 2px #cccccc;\n  transition: all 0.2s;\n}\ntr {\n  border-bottom: 1px solid #cccccc;\n}\ntr:last-child {\n  border-bottom: 0px;\n}\ntd {\n  border-right: 1px solid #cccccc;\n  padding: 10px;\n  transition: all 0.2s;\n  font-size: 14px;\n}\ntd:first-child {\n  font-size: 12px;\n  font-family: monospace\n\n}\ntd:last-child {\n  border-right: 0px;\n}\ntd.selected {\n  background: #d7e4ef;\n  z-index: ;\n}\ntd input {\n  font-size: 14px;\n  background: none;\n  outline: none;\n  border: 0;\n  display: table-cell;\n  height: 100%;\n  width: 100%;\n}\ntd input:focus {\n  box-shadow: 0 1px 0 steelblue;\n  color: steelblue;\n}\n::-moz-selection {\n  background: steelblue;\n  color: white;\n}\n::selection {\n  background: steelblue;\n  color: white;\n}\n'}),"\n",(0,jsx_runtime.jsx)(_components.h1,{children:(0,jsx_runtime.jsx)(_components.code,{children:"useLayers"})}),"\n",(0,jsx_runtime.jsxs)(_components.p,{children:["With ",(0,jsx_runtime.jsx)(_components.code,{children:"useLayers"}),", you can manipulate the layers in the canvas.\nWhat you can do with ",(0,jsx_runtime.jsx)(_components.code,{children:"useLayers"})," is as follows."]}),"\n",(0,jsx_runtime.jsxs)(_components.ul,{children:["\n",(0,jsx_runtime.jsx)(_components.li,{children:(0,jsx_runtime.jsx)(_components.code,{children:"add/remove layer"})}),"\n",(0,jsx_runtime.jsx)(_components.li,{children:(0,jsx_runtime.jsx)(_components.code,{children:"change current alyer"})}),"\n",(0,jsx_runtime.jsx)(_components.li,{children:(0,jsx_runtime.jsx)(_components.code,{children:"show/hide layer"})}),"\n",(0,jsx_runtime.jsx)(_components.li,{children:(0,jsx_runtime.jsx)(_components.code,{children:"reorder layers"})}),"\n"]}),"\n",(0,jsx_runtime.jsxs)(_components.h4,{children:["Features provided by ",(0,jsx_runtime.jsx)(_components.code,{children:"useHandlers"})]}),"\n",(0,jsx_runtime.jsxs)("table",{children:[(0,jsx_runtime.jsx)("thead",{children:(0,jsx_runtime.jsxs)("tr",{children:[(0,jsx_runtime.jsx)("td",{}),(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsx)("strong",{children:"Description"})}),(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsx)("strong",{children:"Parameters"})})]})}),(0,jsx_runtime.jsxs)("tbody",{children:[(0,jsx_runtime.jsxs)("tr",{children:[(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsx)(_components.code,{children:"currentLayer"})}),(0,jsx_runtime.jsxs)("td",{children:[(0,jsx_runtime.jsxs)(_components.p,{children:["State variable that notifies the user's current layer.\n",(0,jsx_runtime.jsx)(_components.code,{children:"LayerDataForHook"})]}),(0,jsx_runtime.jsx)(_components.pre,{children:(0,jsx_runtime.jsx)(_components.code,{className:"language-tsx",children:"type LayerDataForHook = {\n  id: string;\n  isVisible: boolean;\n  data: Array<Array<PixelModifyItem>>;\n};\n"})})]}),(0,jsx_runtime.jsx)("td",{})]}),(0,jsx_runtime.jsxs)("tr",{children:[(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsx)(_components.code,{children:"layers"})}),(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsxs)(_components.p,{children:["State variable that notifies all layers.\n",(0,jsx_runtime.jsx)(_components.code,{children:"Array<LayerDataForHook>"})]})}),(0,jsx_runtime.jsx)("td",{})]}),(0,jsx_runtime.jsxs)("tr",{children:[(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsx)(_components.code,{children:"addLayer"})}),(0,jsx_runtime.jsxs)("td",{children:[(0,jsx_runtime.jsxs)(_components.p,{children:["Allows you to add a layer to the canvas. You have to pass three arguments.\n",(0,jsx_runtime.jsx)(_components.code,{children:"layerId"}),", ",(0,jsx_runtime.jsx)(_components.code,{children:"insertPosition"}),", and ",(0,jsx_runtime.jsx)(_components.code,{children:"data"}),"."]}),(0,jsx_runtime.jsx)("br",{}),(0,jsx_runtime.jsxs)(_components.p,{children:["The ",(0,jsx_runtime.jsx)(_components.code,{children:"layerId"})," (type: ",(0,jsx_runtime.jsx)(_components.code,{children:"string"}),") must not be duplicated."]}),(0,jsx_runtime.jsx)("br",{}),(0,jsx_runtime.jsxs)(_components.p,{children:[(0,jsx_runtime.jsx)(_components.code,{children:"insertPosition"})," (type: ",(0,jsx_runtime.jsx)(_components.code,{children:"number"}),") is the position where the layer is inserted. If you pass ",(0,jsx_runtime.jsx)(_components.code,{children:"0"}),", the layer will be inserted at the top."]}),(0,jsx_runtime.jsx)("br",{}),(0,jsx_runtime.jsxs)(_components.p,{children:[(0,jsx_runtime.jsx)(_components.code,{children:"data"})," (type: ",(0,jsx_runtime.jsx)(_components.code,{children:"Array<Array<PixelModifyItem>>"}),")is the data of the layer. It is not necessary, but if you want to add a layer with data, you can pass it.\nMind that the passed data should have the same size of the current layer"]})]}),(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsxs)(_components.p,{children:[(0,jsx_runtime.jsx)(_components.code,{children:"layerId"}),", ",(0,jsx_runtime.jsx)(_components.code,{children:"insertPosition"}),", ",(0,jsx_runtime.jsx)(_components.code,{children:"data"})]})})]}),(0,jsx_runtime.jsxs)("tr",{children:[(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsx)(_components.code,{children:"removeLayer"})}),(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsx)(_components.p,{children:"Allows you to remove a layer of a specific layerId"})}),(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsx)(_components.code,{children:"string"})})]}),(0,jsx_runtime.jsxs)("tr",{children:[(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsx)(_components.code,{children:"changeLayerPosition"})}),(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsxs)(_components.p,{children:["Allows you to change the position of a single layer.\nYou must provide a ",(0,jsx_runtime.jsx)(_components.code,{children:"layerId"})," (type: ",(0,jsx_runtime.jsx)(_components.code,{children:"string"}),") and a ",(0,jsx_runtime.jsx)(_components.code,{children:"newPosition"})," (type: ",(0,jsx_runtime.jsx)(_components.code,{children:"number"}),").\nThe layer position change caused by this callback will not be recorded in the history.\nIf you want to change the layer position and record it in the history, use ",(0,jsx_runtime.jsx)(_components.code,{children:"reorderlayersByIds"}),"."]})}),(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsxs)(_components.p,{children:[(0,jsx_runtime.jsx)(_components.code,{children:"string"}),", ",(0,jsx_runtime.jsx)(_components.code,{children:"number"})]})})]}),(0,jsx_runtime.jsxs)("tr",{children:[(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsx)(_components.code,{children:"showLayer"})}),(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsx)(_components.p,{children:"Makes the layer of a specific layerId visible."})}),(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsx)(_components.code,{children:"string"})})]}),(0,jsx_runtime.jsxs)("tr",{children:[(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsx)(_components.code,{children:"hideLayer"})}),(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsx)(_components.p,{children:"Makes the layer of a specific layerId invisible."})}),(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsx)(_components.p,{children:(0,jsx_runtime.jsx)(_components.code,{children:"string"})})})]}),(0,jsx_runtime.jsxs)("tr",{children:[(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsx)(_components.code,{children:"isolateLayer"})}),(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsx)(_components.p,{children:"Makes the layer of a specific layerId visible and makes all other layers invisible."})}),(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsx)(_components.code,{children:"string"})})]}),(0,jsx_runtime.jsxs)("tr",{children:[(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsx)(_components.code,{children:"showAllLayers"})}),(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsx)(_components.p,{children:"Makes all layers visible."})}),(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsx)(_components.p,{children:(0,jsx_runtime.jsx)(_components.code,{children:"undefined"})})})]}),(0,jsx_runtime.jsxs)("tr",{children:[(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsx)(_components.code,{children:"setCurrentLayer"})}),(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsx)(_components.p,{children:"Allows you to change the current working layer."})}),(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsx)(_components.code,{children:"string"})})]}),(0,jsx_runtime.jsxs)("tr",{children:[(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsx)(_components.code,{children:"reorderLayersByIds"})}),(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsx)(_components.p,{children:"Allows you to reorder all layers by passing an array of layerIds.\nThis callback will record the layer position change in the history."})}),(0,jsx_runtime.jsx)("td",{children:(0,jsx_runtime.jsx)(_components.code,{children:"Array<string>"})})]})]})]}),"\n",(0,jsx_runtime.jsx)(_components.h3,{children:"Examples"}),"\n",(0,jsx_runtime.jsx)(_components.h4,{children:"1. Create a new layer"}),"\n",(0,jsx_runtime.jsxs)(_components.p,{children:["You can create a new layer by clicking the ",(0,jsx_runtime.jsx)(_components.code,{children:"Add Layer"})," button.\nThis uses ",(0,jsx_runtime.jsx)(_components.code,{children:"useLayers"}),"'s ",(0,jsx_runtime.jsx)(_components.code,{children:"addLayer"})," callback.\nYou can also remove the layer by clicking the ",(0,jsx_runtime.jsx)(_components.code,{children:"remove"})," button.\nThis uses ",(0,jsx_runtime.jsx)(_components.code,{children:"useLayers"}),"'s ",(0,jsx_runtime.jsx)(_components.code,{children:"removeLayer"})," callback."]}),"\n",(0,jsx_runtime.jsx)(useLayersComponents_CreateLayers,{}),"\n",(0,jsx_runtime.jsx)(_components.h4,{children:"2. Switch working layer"}),"\n",(0,jsx_runtime.jsxs)(_components.p,{children:["With ",(0,jsx_runtime.jsx)(_components.code,{children:"setCurrentLayer"})," callback you can switch to another layer.\nYou can test the callback of ",(0,jsx_runtime.jsx)(_components.code,{children:"setCurrentLayer"})," by clicking one of the layers.\nThe current layer is highlighted with a grey background"]}),"\n",(0,jsx_runtime.jsx)(useLayersComponents_SwitchLayers,{}),"\n",(0,jsx_runtime.jsx)(_components.h4,{children:"3. Show/Hide layer"}),"\n",(0,jsx_runtime.jsxs)(_components.p,{children:["You can decide which layer to show or hide.\nThis uses ",(0,jsx_runtime.jsx)(_components.code,{children:"useLayers"}),"'s ",(0,jsx_runtime.jsx)(_components.code,{children:"showLayer"})," and ",(0,jsx_runtime.jsx)(_components.code,{children:"hideLayer"})," callbacks.\nBy clicking 'hide' button, you can hide the layer.\nAlso, if you want to only see a specific layer, you can use ",(0,jsx_runtime.jsx)(_components.code,{children:"isolateLayer"})," callback."]}),"\n",(0,jsx_runtime.jsx)(VisibleLayers,{}),"\n",(0,jsx_runtime.jsx)(_components.h4,{children:"4. Reorder layers"}),"\n",(0,jsx_runtime.jsxs)(_components.p,{children:["You can reorder layers by using ",(0,jsx_runtime.jsx)(_components.code,{children:"changeLayerPosition"})," callback and ",(0,jsx_runtime.jsx)(_components.code,{children:"reorderLayersByIds"})," callback.\nThe difference is that ",(0,jsx_runtime.jsx)(_components.code,{children:"changeLayerPosition"})," callback reorders only one layer, while ",(0,jsx_runtime.jsx)(_components.code,{children:"reorderLayersByIds"})," callback reorders all layers."]}),"\n",(0,jsx_runtime.jsx)("br",{}),"\n",(0,jsx_runtime.jsxs)(_components.p,{children:["Also, the order adjusted by ",(0,jsx_runtime.jsx)(_components.code,{children:"changeLayerPosition"})," callback is not recorded in the\nhistory, thus, one cannot ",(0,jsx_runtime.jsx)(_components.code,{children:"undo"})," or ",(0,jsx_runtime.jsx)(_components.code,{children:"redo"})," the reorder action committed by ",(0,jsx_runtime.jsx)(_components.code,{children:"changeLayerPosition"}),".\nOn the other hand, the order adjusted by ",(0,jsx_runtime.jsx)(_components.code,{children:"reorderLayersByIds"})," callback is recorded\nin the history, thus, one can ",(0,jsx_runtime.jsx)(_components.code,{children:"undo"})," or ",(0,jsx_runtime.jsx)(_components.code,{children:"redo"})," the reorder action committed by ",(0,jsx_runtime.jsx)(_components.code,{children:"reorderLayersByIds"}),"."]}),"\n",(0,jsx_runtime.jsx)("br",{}),"\n",(0,jsx_runtime.jsxs)(_components.p,{children:["To successfully allow reordering while recording the reorder status into the history,\nthis example used both ",(0,jsx_runtime.jsx)(_components.code,{children:"changeLayerPosition"})," and ",(0,jsx_runtime.jsx)(_components.code,{children:"reorderLayersByIds"})," callbacks.\nWhile using is dragging the layer, the ",(0,jsx_runtime.jsx)(_components.code,{children:"changeLayerPosition"})," callback is used.\nWhen the user releases the layer, the ",(0,jsx_runtime.jsx)(_components.code,{children:"reorderLayersByIds"})," callback is used."]}),"\n",(0,jsx_runtime.jsx)(useLayersComponents_ReorderLayers,{}),"\n",(0,jsx_runtime.jsx)("div",{className:"subheading",children:"Example Source Codes"}),"\n",(0,jsx_runtime.jsx)("div",{className:"link-list",children:(0,jsx_runtime.jsxs)("a",{className:"link-item",href:"https://github.com/hunkim98/dotting/tree/main/stories/useLayersComponents",target:"_blank",children:[(0,jsx_runtime.jsx)("img",{src:stackalt,alt:"Build"}),(0,jsx_runtime.jsx)("span",{children:(0,jsx_runtime.jsxs)(_components.p,{children:[(0,jsx_runtime.jsx)("strong",{children:"Github Source Code"}),"\nView the source code and contribute to the project!"]})})]})}),"\n",(0,jsx_runtime.jsx)("div",{className:"tip-wrapper"}),"\n",(0,jsx_runtime.jsx)(_components.pre,{children:(0,jsx_runtime.jsx)(_components.code,{})})]})}function MDXContent(){var props=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},MDXLayout=Object.assign({},(0,dist_esm.ah)(),props.components).wrapper;return MDXLayout?(0,jsx_runtime.jsx)(MDXLayout,Object.assign({},props,{children:(0,jsx_runtime.jsx)(_createMdxContent,props)})):_createMdxContent(props)}var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Hooks/useLayers",includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return react.createElement(esm.aT,{mdxStoryNameToKey,mdxComponentAnnotations:componentMeta},react.createElement(MDXContent,null))}});const useLayers_stories=componentMeta;var __namedExportsOrder=["__page"]},"./stories sync recursive ^\\.(?:(?:^%7C\\/%7C(?:(?:(?%21(?:^%7C\\/)\\.).)*?)\\/)(?%21\\.)(?=.)[^/]*?\\.stories\\.(js%7Ctsx%7Cmdx%7Cjsx))$":(module,__unused_webpack_exports,__webpack_require__)=>{var map={"./CustomRender.stories.mdx":"./stories/CustomRender.stories.mdx","./Dotting.stories.tsx":"./stories/Dotting.stories.tsx","./Hooks.stories.mdx":"./stories/Hooks.stories.mdx","./Introduction.stories.mdx":"./stories/Introduction.stories.mdx","./Layers.stories.mdx":"./stories/Layers.stories.mdx","./useBrush.stories.mdx":"./stories/useBrush.stories.mdx","./useData.stories.mdx":"./stories/useData.stories.mdx","./useDotting.stories.mdx":"./stories/useDotting.stories.mdx","./useGrids.stories.mdx":"./stories/useGrids.stories.mdx","./useHandlers.stories.mdx":"./stories/useHandlers.stories.mdx","./useLayers.stories.mdx":"./stories/useLayers.stories.mdx"};function webpackContext(req){var id=webpackContextResolve(req);return __webpack_require__(id)}function webpackContextResolve(req){if(!__webpack_require__.o(map,req)){var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e}return map[req]}webpackContext.keys=function webpackContextKeys(){return Object.keys(map)},webpackContext.resolve=webpackContextResolve,module.exports=webpackContext,webpackContext.id="./stories sync recursive ^\\.(?:(?:^%7C\\/%7C(?:(?:(?%21(?:^%7C\\/)\\.).)*?)\\/)(?%21\\.)(?=.)[^/]*?\\.stories\\.(js%7Ctsx%7Cmdx%7Cjsx))$"},"./stories sync recursive ^\\.(?:(?:^%7C\\/%7C(?:(?:(?%21(?:^%7C\\/)\\.).)*?)\\/)(?%21\\.)(?=.)[^/]*?\\.stories\\.mdx\\))$":module=>{function webpackEmptyContext(req){var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e}webpackEmptyContext.keys=()=>[],webpackEmptyContext.resolve=webpackEmptyContext,webpackEmptyContext.id="./stories sync recursive ^\\.(?:(?:^%7C\\/%7C(?:(?:(?%21(?:^%7C\\/)\\.).)*?)\\/)(?%21\\.)(?=.)[^/]*?\\.stories\\.mdx\\))$",module.exports=webpackEmptyContext},"./stories/assets/code-brackets.svg":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";module.exports=__webpack_require__.p+"static/media/code-brackets.2e1112d7.svg"},"./stories/assets/colors.svg":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";module.exports=__webpack_require__.p+"static/media/colors.a4bd0486.svg"},"./stories/assets/comments.svg":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";module.exports=__webpack_require__.p+"static/media/comments.a3859089.svg"},"./stories/assets/direction.svg":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";module.exports=__webpack_require__.p+"static/media/direction.b770f9af.svg"},"./stories/assets/flow.svg":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";module.exports=__webpack_require__.p+"static/media/flow.edad2ac1.svg"},"./stories/assets/plugin.svg":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";module.exports=__webpack_require__.p+"static/media/plugin.d494b228.svg"},"./stories/assets/repo.svg":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";module.exports=__webpack_require__.p+"static/media/repo.6d496322.svg"},"./stories/assets/stackalt.svg":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";module.exports=__webpack_require__.p+"static/media/stackalt.dba9fbb3.svg"},"?4f7e":()=>{},"./generated-stories-entry.cjs":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";module=__webpack_require__.nmd(module),(0,__webpack_require__("./node_modules/@storybook/react/dist/esm/client/index.js").configure)([__webpack_require__("./stories sync recursive ^\\.(?:(?:^%7C\\/%7C(?:(?:(?%21(?:^%7C\\/)\\.).)*?)\\/)(?%21\\.)(?=.)[^/]*?\\.stories\\.(js%7Ctsx%7Cmdx%7Cjsx))$"),__webpack_require__("./stories sync recursive ^\\.(?:(?:^%7C\\/%7C(?:(?:(?%21(?:^%7C\\/)\\.).)*?)\\/)(?%21\\.)(?=.)[^/]*?\\.stories\\.mdx\\))$")],module,!1)}},__webpack_require__=>{var __webpack_exec__=moduleId=>__webpack_require__(__webpack_require__.s=moduleId);__webpack_require__.O(0,[546],(()=>(__webpack_exec__("./node_modules/@storybook/core-client/dist/esm/globals/polyfills.js"),__webpack_exec__("./node_modules/@storybook/core-client/dist/esm/globals/globals.js"),__webpack_exec__("./storybook-init-framework-entry.js"),__webpack_exec__("./node_modules/@storybook/react/dist/esm/client/docs/config-generated-config-entry.js"),__webpack_exec__("./node_modules/@storybook/react/dist/esm/client/preview/config-generated-config-entry.js"),__webpack_exec__("./node_modules/@storybook/addon-docs/preview.js-generated-config-entry.js"),__webpack_exec__("./node_modules/@storybook/addon-actions/preview.js-generated-config-entry.js"),__webpack_exec__("./node_modules/@storybook/addon-backgrounds/preview.js-generated-config-entry.js"),__webpack_exec__("./node_modules/@storybook/addon-measure/preview.js-generated-config-entry.js"),__webpack_exec__("./node_modules/@storybook/addon-outline/preview.js-generated-config-entry.js"),__webpack_exec__("./.storybook/preview.js-generated-config-entry.js"),__webpack_exec__("./generated-stories-entry.cjs"))));__webpack_require__.O()}]);